<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>CHANGELOG</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/github.css" type="text/css" media="screen" />
<script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            CHANGELOG
        </h1>
        <ul class="files">
            <li>rails/activerecord/CHANGELOG</li>
            <li>Last modified: 2012-05-10 14:51:07 +0200</li>
        </ul>
    </div>

    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p><strong>1.15.6</strong> (November 24th, 2007)</p>
<ul><li>
<p>Allow association redefinition in subclasses.  #9346 [wildchild]</p>
</li><li>
<p>Fix has_many :through delete with custom foreign keys.  #6466 [naffis]</p>
</li><li>
<p>Fix regression where the association would not construct new finder SQL on
save causing bogus queries for “WHERE owner_id = NULL” even after owner was
saved.  #8713 [Bryan Helmkamp]</p>
</li></ul>

<p><strong>1.15.5</strong> (October 12th, 2007)</p>
<ul><li>
<p>Depend on Action Pack 1.4.4</p>
</li></ul>

<p><strong>1.15.4</strong> (October 4th, 2007)</p>
<ul><li>
<p>Fix count on a has_many :through association so that it recognizes the
:uniq option. Closes #8801 [lifofifo]</p>
</li><li>
<p>Don’t clobber includes passed to has_many.count [danger]</p>
</li><li>
<p>Make sure has_many uses :include when counting [danger]</p>
</li><li>
<p>Save associated records only if the association is already loaded.  #8713
[blaine]</p>
</li><li>
<p>Changing the :default Date format doesn’t break date quoting.  #6312
[bshand, Elias]</p>
</li><li>
<p>Allow nil serialized attributes with a set class constraint. #7293
[sandofsky]</p>
</li><li>
<p>belongs_to assignment creates a new proxy rather than modifying its target
in-place.  #8412 [mmangino@elevatedrails.com]</p>
</li><li>
<p>Fix column type detection while loading fixtures.  Closes #7987
[roderickvd]</p>
</li><li>
<p>Document deep eager includes.  #6267 [Josh Susser, Dan Manges]</p>
</li><li>
<p>Oracle: extract column length for CHAR also.  #7866 [ymendel]</p>
</li><li>
<p>Small additions and fixes for <a
href="../../../classes/ActiveRecord.html">ActiveRecord</a> documentation. 
Closes #7342 [jeremymcanally]</p>
</li><li>
<p>SQLite: binary escaping works with $KCODE=‘u’.  #7862 [tsuka]</p>
</li><li>
<p>Improved cloning performance by relying less on exception raising #8159
[Blaine]</p>
</li></ul>

<p><strong>1.15.3</strong> (March 12th, 2007)</p>
<ul><li>
<p>Allow a polymorphic :source for has_many :through associations. Closes
#7143 [protocool]</p>
</li><li>
<p>Consistently quote primary key column names.  #7763 [toolmantim]</p>
</li><li>
<p>Fixtures: fix YAML ordered map support.  #2665 [Manuel Holtgrewe,
nfbuckley]</p>
</li><li>
<p>Fix has_many :through &lt;&lt; with custom foreign keys.  #6466, #7153
[naffis, Rich Collins]</p>
</li></ul>

<p><strong>1.15.2</strong> (February 5th, 2007)</p>
<ul><li>
<p>Pass a range in :conditions to use the SQL BETWEEN operator.  #6974
[dcmanges]</p>

<pre class="ruby"><span class="ruby-constant">Student</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-identifier">grade</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">9</span><span class="ruby-operator">..</span><span class="ruby-value">12</span> })
</pre>
</li><li>
<p>Don’t create instance writer methods for class attributes. [Rick]</p>
</li><li>
<p>When dealing with SQLite3, use the table_info pragma helper, so that the
bindings can do some translation for when sqlite3 breaks incompatibly
between point releases. [Jamis Buck]</p>
</li><li>
<p>SQLServer: don’t choke on strings containing ‘null’.  #7083 [Jakob S]</p>
</li><li>
<p>Consistently use LOWER() for uniqueness validations (rather than mixing
with UPPER()) so the database can always use a functional index on the
lowercased column.  #6495 [Si]</p>
</li><li>
<p>MySQL: SET SQL_AUTO_IS_NULL=0 so ‘where id is null’ doesn’t select the last
inserted id.  #6778 [Jonathan Viney, timc]</p>
</li><li>
<p><a href="../../../classes/Fixtures.html">Fixtures</a> use the table name
and connection from set_fixture_class.  #7330 [Anthony Eden]</p>
</li><li>
<p>SQLServer: quote table name in indexes query.  #2928 [keithm@infused.org]</p>
</li></ul>

<p><strong>1.15.1</strong> (January 17th, 2007)</p>
<ul><li>
<p>Fix nodoc breaking of adapters</p>
</li></ul>

<p><strong>1.15.0</strong> (January 16th, 2007)</p>
<ul><li><dl class="rdoc-list label-list"><dt>DOC
<dd>
<p>clear up some ambiguity with the way has_and_belongs_to_many creates the
default join table name.  #7072 [jeremymcanally]</p>
</dd></dl>
</li><li>
<p>change_column accepts :default =&gt; nil. Skip column options for primary
keys.  #6956, #7048 [dcmanges, Jeremy Kemper]</p>
</li><li>
<p>MySQL, PostgreSQL: change_column_default quotes the default value and
doesn’t lose column type information.  #3987, #6664 [Jonathan Viney,
manfred, altano@bigfoot.com]</p>
</li><li>
<p>Oracle: create_table takes a :sequence_name option to override the
‘tablename_seq’ default.  #7000 [Michael Schoen]</p>
</li><li>
<p>MySQL: retain SSL settings on reconnect.  #6976 [randyv2]</p>
</li><li>
<p>SQLServer: handle [quoted] table names.  #6635 [rrich]</p>
</li><li>
<p>acts_as_nested_set works with single-table inheritance.  #6030 [Josh
Susser]</p>
</li><li>
<p>PostgreSQL, Oracle: correctly perform eager finds with :limit and :order. 
#4668, #7021 [eventualbuddha, Michael Schoen]</p>
</li><li>
<p>Fix the Oracle adapter for serialized attributes stored in CLOBs.  Closes
#6825 [mschoen, tdfowler]</p>
</li><li><dl class="rdoc-list label-list"><dt>DOCS
<dd>
<p>Apply more documentation for <a
href="../../../classes/ActiveRecord.html">ActiveRecord</a> Reflection. 
Closes #4055 [Robby Russell]</p>
</dd></dl>
</li><li><dl class="rdoc-list label-list"><dt>DOCS
<dd>
<p>Document :allow_nil option of validate_uniqueness_of. Closes #3143 [Caio
Chassot]</p>
</dd></dl>
</li><li>
<p>Bring the sybase adapter up to scratch for 1.2 release. [jsheets]</p>
</li><li>
<p>Oracle: fix connection reset failure.  #6846 [leonlleslie]</p>
</li><li>
<p>Subclass instantiation doesn’t try to explicitly require the corresponding
subclass.  #6840 [leei, Jeremy Kemper]</p>
</li><li>
<p>fix faulty inheritance tests and that eager loading grabs the wrong
inheritance column when the class of your association is an STI subclass.
Closes #6859 [protocool]</p>
</li><li>
<p>find supports :lock with :include. Check whether your database allows
SELECT … FOR UPDATE with outer joins before using.  #6764 [vitaly, Jeremy
Kemper]</p>
</li><li>
<p>Support nil and Array in :conditions =&gt; { attr =&gt; value } hashes. 
#6548 [Assaf, Jeremy Kemper]</p>

<pre class="ruby"><span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-identifier">topic_id</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value">1</span>, <span class="ruby-value">2</span>, <span class="ruby-value">3</span>], :<span class="ruby-identifier">last_read</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span> }
</pre>
</li><li>
<p>Quote <a
href="../../../classes/ActiveSupport/Multibyte/Chars.html">ActiveSupport::Multibyte::Chars</a>.
#6653 [Julian Tarkhanov]</p>
</li><li>
<p>MySQL: detect when a NOT NULL column without a default value is misreported
as default ”.  Can’t detect for string, text, and binary columns since ” is
a legitimate default.  #6156 [simon@redhillconsulting.com.au, obrie,
Jonathan Viney, Jeremy Kemper]</p>
</li><li>
<p>validates_numericality_of uses A Z to ensure the entire string matches
rather than ^ $ which may match one valid line of a multiline string. 
#5716 [Andreas Schwarz]</p>
</li><li>
<p>Oracle: automatically detect the primary key.  #6594 [vesaria, Michael
Schoen]</p>
</li><li>
<p>Oracle: to increase performance, prefetch 100 rows and enable similar
cursor sharing. Both are configurable in database.yml.  #6607
[philbogle@gmail.com, jobster at ray.fortna.com, Michael Schoen]</p>
</li><li>
<p>Firebird: decimal/numeric support.  #6408 [macrnic]</p>
</li><li>
<p>Find with :include respects scoped :order.  #5850</p>
</li><li>
<p>Dynamically generate reader methods for serialized attributes.  #6362
[Stefan Kaes]</p>
</li><li>
<p>Deprecation: object transactions warning.  [Jeremy Kemper]</p>
</li><li>
<p>has_one :dependent =&gt; :nullify ignores nil associates.  #6528 [janovetz,
Jeremy Kemper]</p>
</li><li>
<p>Oracle: resolve test failures, use prefetched primary key for inserts,
check for null defaults, fix limited id selection for eager loading. Factor
out some common methods from all adapters.  #6515 [Michael Schoen]</p>
</li><li>
<p>Make add_column use the options hash with the Sqlite Adapter. Closes #6464
[obrie]</p>
</li><li>
<p>Document other options available to migration’s add_column. #6419 [grg]</p>
</li><li>
<p>MySQL: all_hashes compatibility with old <a
href="../../../classes/Mysql/Result.html">MysqlRes</a> class.  #6429, #6601
[Jeremy Kemper]</p>
</li><li>
<p>Fix has_many :through to add the appropriate conditions when going through
an association using STI. Closes #5783. [Jonathan Viney]</p>
</li><li>
<p>fix select_limited_ids_list issues in postgresql, retain current behavior
in other adapters [Rick]</p>
</li><li>
<p>Restore eager condition interpolation, document it’s differences [Rick]</p>
</li><li>
<p>Don’t rollback in teardown unless a transaction was started. Don’t start a
transaction in create_fixtures if a transaction is started.  #6282 [Jacob
Fugal, Jeremy Kemper]</p>
</li><li>
<p>Add delete support to has_many :through associations.  Closes #6049 [Martin
Landers]</p>
</li><li>
<p>Reverted old select_limited_ids_list postgresql fix that caused issues in
mysql.  Closes #5851 [Rick]</p>
</li><li>
<p>Removes the ability for eager loaded conditions to be interpolated, since
there is no model instance to use as a context for interpolation. #5553
[turnip@turnipspatch.com]</p>
</li><li>
<p>Added timeout option to SQLite3 configurations to deal more gracefully with
SQLite3::BusyException, now the connection can instead retry for x seconds
to see if the db clears up before throwing that exception #6126
[wreese@gmail.com]</p>
</li><li>
<p>Added update_attributes! which uses save! to raise an exception if a
validation error prevents saving #6192 [jonathan]</p>
</li><li>
<p>Deprecated add_on_boundary_breaking (use validates_length_of instead) #6292
[BobSilva]</p>
</li><li>
<p>The has_many create method works with polymorphic associations.  #6361 [Dan
Peterson]</p>
</li><li>
<p>MySQL: introduce Mysql::Result#all_hashes to support further optimization. 
#5581 [Stefan Kaes]</p>
</li><li>
<p>save! shouldn’t validate twice.  #6324 [maiha, Bob Silva]</p>
</li><li>
<p>Association collections have an _ids reader method to match the existing
writer for collection_select convenience (e.g. employee.task_ids). The
writer method skips blank ids so you can safely do @employee.task_ids = <a
href="http://:tasks">params</a> without checking every time for an empty
list or blank values.  #1887, #5780 [Michael Schuerig]</p>
</li><li>
<p>Add an attribute reader method for ActiveRecord::Base.observers [Rick
Olson]</p>
</li><li>
<p>Deprecation: count class method should be called with an options hash
rather than two args for conditions and joins.  #6287 [Bob Silva]</p>
</li><li>
<p>has_one associations with a nil target may be safely marshaled.  #6279
[norbauer, Jeremy Kemper]</p>
</li><li>
<p>Duplicate the hash provided to AR::Base#to_xml to prevent unexpected side
effects [Koz]</p>
</li><li>
<p>Add a :namespace option to  AR::Base#to_xml [Koz]</p>
</li><li>
<p>Deprecation tests. Remove warnings for dynamic finders and for the
foo_count method if it’s also an attribute. [Jeremy Kemper]</p>
</li><li>
<p>Mock Time.now for more accurate Touch mixin tests.  #6213 [Dan Peterson]</p>
</li><li>
<p>Improve yaml fixtures error reporting.  #6205 [Bruce Williams]</p>
</li><li>
<p>Rename AR::Base#quote so people can use that name in their models. #3628
[Koz]</p>
</li><li>
<p>Add deprecation warning for inferred foreign key. #6029 [Josh Susser]</p>
</li><li>
<p>Fixed the Ruby/MySQL adapter we ship with Active Record to work with the
new authentication handshake that was introduced in MySQL 4.1, along with
the other protocol changes made at that time #5723 [jimw@mysql.com]</p>
</li><li>
<p>Deprecation: use :dependent =&gt; :delete_all rather than
:exclusively_dependent =&gt; true.  #6024 [Josh Susser]</p>
</li><li>
<p>Optimistic locking: gracefully handle nil versions, treat as zero.  #5908
[Tom Ward]</p>
</li><li>
<p>to_xml: the :methods option works on arrays of records.  #5845 [Josh
Starcher]</p>
</li><li>
<p>has_many :through conditions are sanitized by the associating class.  #5971
[gmail at martin.emde.com]</p>
</li><li>
<p>Fix spurious newlines and spaces in AR::Base#to_xml output [Jamis Buck]</p>
</li><li>
<p>has_one supports the :dependent =&gt; :delete option which skips the
typical callback chain and deletes the associated object directly from the
database.  #5927 [Chris Mear, Jonathan Viney]</p>
</li><li>
<p><a href="../../../classes/Nested.html">Nested</a> subclasses are not
prefixed with the parent class' table_name since they should always use the
base class' table_name.  #5911 [Jonathan Viney]</p>
</li><li>
<p>SQLServer: work around bug where some unambiguous date formats are not
correctly identified if the session language is set to german.  #5894 [Tom
Ward, kruth@bfpi]</p>
</li><li>
<p>Clashing type columns due to a sloppy join shouldn’t wreck single-table
inheritance.  #5838 [Kevin Clark]</p>
</li><li>
<p>Fixtures: correct escaping of n and r.  #5859 [gmail at evgeny.zislis.com]</p>
</li><li>
<p>Migrations: gracefully handle missing migration files.  #5857 [gmail at
eli.gordon.com]</p>
</li><li>
<p>MySQL: update test schema for MySQL 5 strict mode.  #5861 [Tom Ward]</p>
</li><li>
<p>to_xml: correct naming of included associations.  #5831 [gmail at
josh.starcher.com]</p>
</li><li>
<p>Pushing a record onto a has_many :through sets the association’s foreign
key to the associate’s primary key and adds it to the correct association. 
#5815, #5829 [josh@hasmanythrough.com]</p>
</li><li>
<p>Add records to has_many :through using &lt;&lt;, push, and concat by
creating the association record. Raise if base or associate are new records
since both ids are required to create the association. build raises since
you can’t associate an unsaved record. create! takes an attributes hash and
creates the associated record and its association in a transaction. [Jeremy
Kemper]</p>

<pre class="ruby"><span class="ruby-comment"># Create a tagging to associate the post and tag.</span>
<span class="ruby-identifier">post</span>.<span class="ruby-identifier">tags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">find_by_name</span>(<span class="ruby-string">'old'</span>)
<span class="ruby-identifier">post</span>.<span class="ruby-identifier">tags</span>.<span class="ruby-identifier">create!</span> :<span class="ruby-identifier">name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'general'</span>

<span class="ruby-comment"># Would have been:</span>
<span class="ruby-identifier">post</span>.<span class="ruby-identifier">taggings</span>.<span class="ruby-identifier">create!</span>(:<span class="ruby-identifier">tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">find_by_name</span>(<span class="ruby-string">'finally'</span>)
<span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">taggings</span>.<span class="ruby-identifier">create!</span>(:<span class="ruby-identifier">tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">create!</span>(:<span class="ruby-identifier">name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'general'</span>))
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Cache nil results for :included has_one associations also.  #5787 [Michael
Schoen]</p>
</li><li>
<p>Fixed a bug which would cause .save to fail after trying to access a empty
has_one association on a unsaved record. [Tobias Luetke]</p>
</li><li>
<p><a href="../../../classes/Nested.html">Nested</a> classes are given table
names prefixed by the singular form of the parent's table name. [Jeremy
Kemper]</p>

<pre>Example: Invoice::Lineitem is given table name invoice_lineitems</pre>
</li><li>
<p>Migrations: uniquely name multicolumn indexes so you don’t have to. [Jeremy
Kemper]</p>

<pre># people_active_last_name_index, people_active_deactivated_at_index
add_index    :people, [:active, :last_name]
add_index    :people, [:active, :deactivated_at]
remove_index :people, [:active, :last_name]
remove_index :people, [:active, :deactivated_at]</pre>

<p>WARNING: backward-incompatibility. Multicolumn indexes created before this
revision were named using the first column name only. Now they’re uniquely
named using all indexed columns.</p>

<p>To remove an old multicolumn index, remove_index :table_name, :first_column</p>
</li><li>
<p>Fix for deep includes on the same association. [richcollins@gmail.com]</p>
</li><li>
<p>Tweak fixtures so they don’t try to use a non-<a
href="../../../classes/ActiveRecord.html">ActiveRecord</a> class.  [Kevin
Clark]</p>
</li><li>
<p>Remove ActiveRecord::Base.reset since <a
href="../../../classes/Dispatcher.html">Dispatcher</a> doesn’t use it
anymore.  [Rick Olson]</p>
</li><li>
<p>PostgreSQL: autodetected sequences work correctly with multiple schemas.
Rely on the schema search_path instead of explicitly qualifying the
sequence name with its schema.  #5280 [famundo at guy.naor.com]</p>
</li><li>
<p>Replace Reloadable with Reloadable::Deprecated. [Nicholas Seckar]</p>
</li><li>
<p>Cache nil results for has_one associations so multiple calls don’t call the
database.  Closes #5757. [Michael <a href="../../../classes/A.html">A</a>.
Schoen]</p>
</li><li>
<p>Don’t save has_one associations unnecessarily.  #5735 [Jonathan Viney]</p>
</li><li>
<p>Refactor ActiveRecord::Base.reset_subclasses to reset, and add global
observer resetting.  [Rick Olson]</p>
</li><li>
<p>Formally deprecate the deprecated finders. [Koz]</p>
</li><li>
<p>Formally deprecate rich associations.  [Koz]</p>
</li><li>
<p>Fixed that default timezones for new / initialize should uphold utc setting
#5709 [daniluk@yahoo.com]</p>
</li><li>
<p>Fix announcement of very long migration names.  #5722 [blake@near-time.com]</p>
</li><li>
<p>The exists? class method should treat a string argument as an id rather
than as conditions.  #5698 [jeremy@planetargon.com]</p>
</li><li>
<p>Fixed to_xml with :include misbehaviors when invoked on array of model
instances #5690 [alexkwolfe@gmail.com]</p>
</li><li>
<p>Added support for conditions on Base.exists? #5689 [josh@joshpeek.com].
Examples:</p>

<pre class="ruby"><span class="ruby-identifier">assert</span> (<span class="ruby-constant">Topic</span>.<span class="ruby-identifier">exists?</span>(:<span class="ruby-identifier">author_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;David&quot;</span>)) 
      <span class="ruby-identifier">assert</span> (<span class="ruby-constant">Topic</span>.<span class="ruby-identifier">exists?</span>(:<span class="ruby-identifier">author_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Mary&quot;</span>, :<span class="ruby-identifier">approved</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)) 
      <span class="ruby-identifier">assert</span> (<span class="ruby-constant">Topic</span>.<span class="ruby-identifier">exists?</span>([<span class="ruby-string">&quot;parent_id = ?&quot;</span>, <span class="ruby-value">1</span>]))
</pre>
</li><li>
<p>Schema dumper quotes date :default values. [Dave Thomas]</p>
</li><li>
<p>Calculate sum with SQL, not <a
href="../../../classes/Enumerable.html">Enumerable</a> on HasManyThrough
Associations. [Dan Peterson]</p>
</li><li>
<p>Factor the attribute#{suffix} methods out of method_missing for easier
extension. [Jeremy Kemper]</p>
</li><li>
<p>Patch sql injection vulnerability when using integer or float columns.
[Jamis Buck]</p>
</li><li>
<p>Allow count through a has_many association to accept :include.  [Dan
Peterson]</p>
</li><li>
<p>create_table rdoc: suggest :id =&gt; false for habtm join tables. [Zed
Shaw]</p>
</li><li>
<p>PostgreSQL: return array fields as strings. #4664 [Robby Russell]</p>
</li><li>
<p>SQLServer: added tests to ensure all database statements are closed,
refactored identity_insert management code to use blocks, removed
update/delete rowcount code out of execute and into update/delete, changed
insert to go through execute method, removed unused quoting methods,
disabled pessimistic locking tests as feature is currently unsupported,
fixed RakeFile to load sqlserver specific tests whether running in ado or
odbc mode, fixed support for recently added decimal types, added support
for limits on integer types. #5670 [Tom Ward]</p>
</li><li>
<p>SQLServer: fix db:schema:dump case-sensitivity. #4684 [Will Rogers]</p>
</li><li>
<p>Oracle: BigDecimal support. #5667 [schoenm@earthlink.net]</p>
</li><li>
<p>Numeric and decimal columns map to BigDecimal instead of Float. Those with
scale 0 map to Integer. #5454 [robbat2@gentoo.org, work@ashleymoran.me.uk]</p>
</li><li>
<p>Firebird migrations support. #5337 [Ken Kunz &lt;kennethkunz@gmail.com&gt;]</p>
</li><li>
<p>PostgreSQL: create/drop as postgres user. #4790 [mail@matthewpainter.co.uk,
mlaster@metavillage.com]</p>
</li><li>
<p>PostgreSQL: correctly quote the ‘ in pk_and_sequence_for. #5462
[tietew@tietew.net]</p>
</li><li>
<p>PostgreSQL: correctly quote microseconds in timestamps. #5641
[rick@rickbradley.com]</p>
</li><li>
<p>Clearer has_one/belongs_to model names (account has_one :user). #5632
[matt@mattmargolis.net]</p>
</li><li>
<p>Oracle: use nonblocking queries if allow_concurrency is set, fix
pessimistic locking, don’t guess date vs. time by default (set
OracleAdapter.emulate_dates = true for the old behavior), adapter cleanup.
#5635 [schoenm@earthlink.net]</p>
</li><li>
<p>Fixed a few Oracle issues: Allows Oracle’s odd date handling to still work
consistently within to_xml, Passes test that hardcode insert statement by
dropping the :id column, Updated <a
href="../actionpack/RUNNING_UNIT_TESTS.html">RUNNING_UNIT_TESTS</a> with
Oracle instructions, Corrects method signature for exec #5294
[schoenm@earthlink.net]</p>
</li><li>
<p>Added :group to available options for finds done on associations #5516
[mike@michaeldewey.org]</p>
</li><li>
<p>Observers also watch subclasses created after they are declared. #5535
[daniels@pronto.com.au]</p>
</li><li>
<p>Removed deprecated timestamps_gmt class methods. [Jeremy Kemper]</p>
</li><li>
<p>rake build_mysql_database grants permissions to rails@localhost. #5501
[brianegge@yahoo.com]</p>
</li><li>
<p>PostgreSQL: support microsecond time resolution. #5492 [alex@msgpad.com]</p>
</li><li>
<p>Add AssociationCollection#sum since the method_missing invokation has been
shadowed by <a
href="../../../classes/Enumerable.html#method-i-sum">Enumerable#sum</a>.</p>
</li><li>
<p>Added find_or_initialize_by_X which works like find_or_create_by_X but
doesn’t save the newly instantiated record. [Sam Stephenson]</p>
</li><li>
<p>Row locking. Provide a locking clause with the :lock finder option or true
for the default “FOR UPDATE”. Use the lock! method to obtain a row lock on
a single record (reloads the record with :lock =&gt; true). [Shugo Maeda]</p>

<pre class="ruby"><span class="ruby-comment"># Obtain an exclusive lock on person 1 so we can safely increment visits.</span>
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
  <span class="ruby-comment"># select * from people where id=1 for update</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>, :<span class="ruby-identifier">lock</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">person</span>.<span class="ruby-identifier">visits</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
  <span class="ruby-identifier">person</span>.<span class="ruby-identifier">save!</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>PostgreSQL: introduce allow_concurrency option which determines whether to
use blocking or asynchronous execute. Adapters with blocking execute will
deadlock Ruby threads. The default value is
ActiveRecord::Base.allow_concurrency. [Jeremy Kemper]</p>
</li><li>
<p>Use a per-thread (rather than global) transaction mutex so you may execute
concurrent transactions on separate connections. [Jeremy Kemper]</p>
</li><li>
<p>Change AR::Base#to_param to return a <a
href="../../../classes/String.html">String</a> instead of a Fixnum. Closes
#5320. [Nicholas Seckar]</p>
</li><li>
<p>Use explicit delegation instead of method aliasing for AR::Base.to_param
-&gt; AR::Base.id. #5299 (skaes@web.de)</p>
</li><li>
<p>Refactored ActiveRecord::Base.to_xml to become a delegate for
XmlSerializer, which restores sanity to the mega method. This refactoring
also reinstates the opinions that type=“string” is redundant and ugly and
nil-differentiation is not a concern of serialization [DHH]</p>
</li><li>
<p>Added simple hash conditions to find that’ll just convert hash to an
AND-based condition string #5143 [hcatlin@gmail.com]. Example:</p>

<pre class="ruby"><span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-identifier">last_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Catlin&quot;</span>, :<span class="ruby-identifier">status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> }, :<span class="ruby-identifier">limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>)
</pre>
</li></ul>

<p>…is the same as:</p>

<pre class="ruby">  <span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> [ <span class="ruby-string">&quot;last_name = ? and status = ?&quot;</span>, <span class="ruby-string">&quot;Catlin&quot;</span>, <span class="ruby-value">1</span> ], :<span class="ruby-identifier">limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>)

<span class="ruby-constant">This</span> <span class="ruby-identifier">makes</span> <span class="ruby-identifier">it</span> <span class="ruby-identifier">easier</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">pass</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">options</span> <span class="ruby-identifier">from</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">form</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">otherwise</span> <span class="ruby-identifier">outside</span>.
</pre>
<ul><li>
<p>Fixed issues with BLOB limits, charsets, and booleans for Firebird #5194,
#5191, #5189 [kennethkunz@gmail.com]</p>
</li><li>
<p>Fixed usage of :limit and with_scope when the association in scope is a 1:m
#5208 [alex@purefiction.net]</p>
</li><li>
<p>Fixed migration trouble with SQLite when NOT NULL is used in the new
definition #5215 [greg@lapcominc.com]</p>
</li><li>
<p>Fixed problems with eager loading and counting on SQL Server #5212
[kajism@yahoo.com]</p>
</li><li>
<p>Fixed that count distinct should use the selected column even when using
:include #5251 [anna@wota.jp]</p>
</li><li>
<p>Fixed that :includes merged from with_scope won’t cause the same
association to be loaded more than once if repetition occurs in the clauses
#5253 [alex@purefiction.net]</p>
</li><li>
<p>Allow models to override to_xml.  #4989 [Blair Zajac
&lt;blair@orcaware.com&gt;]</p>
</li><li>
<p>PostgreSQL: don’t ignore port when host is nil since it’s often used to
label the domain socket.  #5247 [shimbo@is.naist.jp]</p>
</li><li>
<p>Records and arrays of records are bound as quoted ids. [Jeremy Kemper]</p>

<pre class="ruby"><span class="ruby-constant">Foo</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-string">'bar_id IN (?)'</span>, <span class="ruby-identifier">bars</span>])
<span class="ruby-constant">Foo</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">first</span>, :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-string">'bar_id = ?'</span>, <span class="ruby-identifier">bar</span>])
</pre>
</li><li>
<p>Fixed that Base.find :all, :conditions =&gt; [ “id IN (?)”, collection ]
would fail if collection was empty [DHH]</p>
</li><li>
<p>Add a list of regexes assert_queries skips in the <a
href="../../../classes/ActiveRecord.html">ActiveRecord</a> test suite. 
[Rick]</p>
</li><li>
<p>Fix the has_and_belongs_to_many create doesn’t populate the join for new
records.  Closes #3692 [josh@hasmanythrough.com]</p>
</li><li>
<p>Provide Association Extensions access to the instance that the association
is being accessed from.</p>

<p>Closes #4433 [josh@hasmanythrough.com]</p>
</li><li>
<p>Update OpenBase adaterp’s maintainer’s email address. Closes #5176.
[Derrick Spell]</p>
</li><li>
<p>Add a quick note about :select and eagerly included associations. [Rick]</p>
</li><li>
<p>Add docs for the :as option in has_one associations.  Closes #5144
[cdcarter@gmail.com]</p>
</li><li>
<p>Fixed that has_many collections shouldn’t load the entire association to do
build or create [DHH]</p>
</li><li>
<p>Added :allow_nil option for aggregations #5091 [gmail at ian.w.white.com]</p>
</li><li>
<p>Fix Oracle boolean support and tests. Closes #5139. [schoenm@earthlink.net]</p>
</li><li>
<p>create! no longer blows up when no attributes are passed and a :create
scope is in effect (e.g. foo.bars.create! failed whereas
foo.bars.create!({}) didn’t.) [Jeremy Kemper]</p>
</li><li>
<p>Call <a
href="../../../classes/Inflector.html#method-i-demodulize">Inflector#demodulize</a>
on the class name when eagerly including an STI model.  Closes #5077
[info@loobmedia.com]</p>
</li><li>
<p>Preserve MySQL boolean column defaults when changing a column in a
migration. Closes #5015. [pdcawley@bofh.org.uk]</p>
</li><li>
<p>PostgreSQL: migrations support :limit with :integer columns by mapping
limit &lt; 4 to smallint, &gt; 4 to bigint, and anything else to integer.
#2900 [keegan@thebasement.org]</p>
</li><li>
<p>Dates and times interpret empty strings as nil rather than 2000-01-01.
#4830 [kajism@yahoo.com]</p>
</li><li>
<p>Allow :uniq =&gt; true with has_many :through associations. [Jeremy Kemper]</p>
</li><li>
<p>Ensure that StringIO is always available for the Schema dumper. [Marcel
Molina Jr.]</p>
</li><li>
<p>Allow AR::Base#to_xml to include methods too. Closes #4921.
[johan@textdrive.com]</p>
</li><li>
<p>Remove duplicate fixture entry in comments.yml. Closes #4923. [Blair Zajac
&lt;blair@orcaware.com&gt;]</p>
</li><li>
<p>When grouping, use the appropriate option key. [Marcel Molina Jr.]</p>
</li><li>
<p>Add support for FrontBase (<a
href="http://www.frontbase.com/">www.frontbase.com/</a>) with a new adapter
thanks to the hard work of one Mike Laster. Closes #4093.
[mlaster@metavillage.com]</p>
</li><li>
<p>Add warning about the proper way to validate the presence of a foreign key.
Closes #4147. [Francois Beausoleil &lt;gmail at
francois.beausoleil.com&gt;]</p>
</li><li>
<p>Fix syntax error in documentation. Closes #4679. [mislav@nippur.irb.hr]</p>
</li><li>
<p>Add Oracle support for CLOB inserts. Closes #4748. [schoenm@earthlink.net
duke at sandra.metz.edu]</p>
</li><li>
<p>Various fixes for sqlserver_adapter (odbc statement finishing, ado schema
dumper, drop index). Closes #4831. [kajism@yahoo.com]</p>
</li><li>
<p>Add support for :order option to with_scope. Closes #3887. [survol at
eric.daspet.net]</p>
</li><li>
<p>Prettify output of schema_dumper by making things line up. Closes #4241
[Caio  Chassot &lt;caio@v2studio.com&gt;]</p>
</li><li>
<p>Make build_postgresql_databases task make databases owned by the postgres
user. Closes #4790. [mlaster@metavillage.com]</p>
</li><li>
<p>Sybase Adapter type conversion cleanup. Closes #4736. [dev@metacasa.net]</p>
</li><li>
<p>Fix bug where calculations with long alias names return null. [Rick]</p>
</li><li>
<p>Raise error when trying to add to a has_many :through association.  Use the
Join Model instead. [Rick]</p>

<pre class="ruby"><span class="ruby-ivar">@post</span>.<span class="ruby-identifier">tags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@tag</span>                  <span class="ruby-comment"># BAD</span>
<span class="ruby-ivar">@post</span>.<span class="ruby-identifier">taggings</span>.<span class="ruby-identifier">create</span>(:<span class="ruby-identifier">tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@tag</span>) <span class="ruby-comment"># GOOD</span>
</pre>
</li><li>
<p>Allow all calculations to take the :include option, not just COUNT (closes
#4840) [Rick]</p>
</li><li>
<p>Add <a
href="../../../classes/ActiveRecord/Errors.html#method-i-to_xml">ActiveRecord::Errors#to_xml</a>
[Jamis Buck]</p>
</li><li>
<p>Properly quote index names in migrations (closes #4764) [John Long]</p>
</li><li>
<p>Fix the HasManyAssociation#count method so it uses the new
ActiveRecord::Base#count syntax, while maintaining backwards compatibility.
[Rick]</p>
</li><li>
<p>Ensure that Associations#include_eager_conditions? checks both scoped and
explicit conditions [Rick]</p>
</li><li>
<p>Associations#select_limited_ids_list adds the ORDER BY columns to the
SELECT DISTINCT List for postgresql. [Rick]</p>
</li><li>
<p>Add :case_sensitive option to validates_uniqueness_of (closes #3090) [Rick]</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Account</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_uniqueness_of</span> :<span class="ruby-identifier">email</span>, :<span class="ruby-identifier">case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Allow multiple association extensions with :extend option (closes #4666)
[Josh Susser]</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Account</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">people</span>, :<span class="ruby-identifier">extend</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-constant">FindOrCreateByNameExtension</span>, <span class="ruby-constant">FindRecentExtension</span>]
<span class="ruby-keyword">end</span>
</pre>
</li></ul>

<p><strong>1.14.4</strong> (August 8th, 2006)</p>
<ul><li>
<p>Add warning about the proper way to validate the presence of a foreign key.
#4147 [Francois Beausoleil &lt;gmail at francois.beausoleil.com&gt;]</p>
</li><li>
<p>Fix syntax error in documentation. #4679 [mislav@nippur.irb.hr]</p>
</li><li>
<p>Update inconsistent migrations documentation. #4683 [machomagna@gmail.com]</p>
</li></ul>

<p><strong>1.14.3</strong> (June 27th, 2006)</p>
<ul><li>
<p>Fix announcement of very long migration names.  #5722 [blake@near-time.com]</p>
</li><li>
<p>Update callbacks documentation. #3970 [Robby Russell
&lt;robby@planetargon.com&gt;]</p>
</li><li>
<p>Properly quote index names in migrations (closes #4764) [John Long]</p>
</li><li>
<p>Ensure that Associations#include_eager_conditions? checks both scoped and
explicit conditions [Rick]</p>
</li><li>
<p>Associations#select_limited_ids_list adds the ORDER BY columns to the
SELECT DISTINCT List for postgresql. [Rick]</p>
</li></ul>

<p><strong>1.14.2</strong> (April 9th, 2006)</p>
<ul><li>
<p>Fixed calculations for the Oracle Adapter (closes #4626) [Michael Schoen]</p>
</li></ul>

<p><strong>1.14.1</strong> (April 6th, 2006)</p>
<ul><li>
<p>Fix type_name_with_module to handle type names that begin with ‘::’. Closes
#4614. [Nicholas Seckar]</p>
</li><li>
<p>Fixed that that multiparameter assignment doesn’t work with aggregations
(closes #4620) [Lars Pind]</p>
</li><li>
<p>Enable Limit/Offset in Calculations (closes #4558) [lmarlow@yahoo.com]</p>
</li><li>
<p>Fixed that loading including associations returns all results if Load IDs
For Limited Eager Loading returns none (closes #4528) [Rick]</p>
</li><li>
<p>Fixed HasManyAssociation#find bugs when :finder_sql is set #4600
[lagroue@free.fr]</p>
</li><li>
<p>Allow AR::Base#respond_to? to behave when @attributes is nil [zenspider]</p>
</li><li>
<p>Support eager includes when going through a polymorphic has_many
association. [Rick]</p>
</li><li>
<p>Added support for eagerly including polymorphic has_one associations.
(closes #4525) [Rick]</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Post</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_one</span> :<span class="ruby-identifier">tagging</span>, :<span class="ruby-identifier">as</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">taggable</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">Post</span>.<span class="ruby-identifier">find</span> :<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">include</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">tagging</span>
</pre>
</li><li>
<p>Added descriptive error messages for invalid has_many :through
associations: going through :has_one or :has_and_belongs_to_many [Rick]</p>
</li><li>
<p>Added support for going through a polymorphic has_many association: (closes
#4401) [Rick]</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">PhotoCollection</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">photos</span>, :<span class="ruby-identifier">as</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">photographic</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">firm</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">Firm</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">photo_collections</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">photos</span>, :<span class="ruby-identifier">through</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">photo_collections</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Multiple fixes and optimizations in PostgreSQL adapter, allowing
ruby-postgres gem to work properly. [gmail at ruben.nine.com]</p>
</li><li>
<p>Fixed that AssociationCollection#delete_all should work even if the records
of the association are not loaded yet. [Florian Weber]</p>
</li><li>
<p>Changed those private <a
href="../../../classes/ActiveRecord.html">ActiveRecord</a> methods to take
optional third argument :auto instead of nil for performance optimizations.
(closes #4456) [Stefan]</p>
</li><li>
<p>Private <a href="../../../classes/ActiveRecord.html">ActiveRecord</a>
methods add_limit!, add_joins!, and add_conditions! take an OPTIONAL third
argument ‘scope’ (closes #4456) [Rick]</p>
</li><li>
<p>DEPRECATED: Using additional attributes on has_and_belongs_to_many
associations. Instead upgrade your association to be a real join model
[DHH]</p>
</li><li>
<p>Fixed that records returned from has_and_belongs_to_many associations with
additional attributes should be marked as read only (fixes #4512) [DHH]</p>
</li><li>
<p>Do not implicitly mark recordss of has_many :through as readonly but do
mark habtm records as readonly (eventually only on join tables without rich
attributes). [Marcel Mollina Jr.]</p>
</li><li>
<p>Fixed broken OCIAdapter #4457 [schoenm@earthlink.net]</p>
</li></ul>

<p><strong>1.14.0</strong> (March 27th, 2006)</p>
<ul><li>
<p>Replace ‘rescue Object’ with a finer grained rescue. Closes #4431.
[Nicholas Seckar]</p>
</li><li>
<p>Fixed eager loading so that an aliased table cannot clash with a
has_and_belongs_to_many join table [Rick]</p>
</li><li>
<p>Add support for :include to with_scope [andrew@redlinesoftware.com]</p>
</li><li>
<p>Support the use of public synonyms with the Oracle adapter; required
ruby-oci8 v0.1.14 #4390 [schoenm@earthlink.net]</p>
</li><li>
<p>Change periods (.) in table aliases to _’s.  Closes #4251
[jeff@ministrycentered.com]</p>
</li><li>
<p>Changed has_and_belongs_to_many join to INNER JOIN for <a
href="../../../classes/Mysql.html">Mysql</a> 3.23.x.  Closes #4348 [Rick]</p>
</li><li>
<p>Fixed issue that kept :select options from being scoped [Rick]</p>
</li><li>
<p>Fixed db_schema_import when binary types are present #3101 [DHH]</p>
</li><li>
<p>Fixed that MySQL enums should always be returned as strings #3501 [DHH]</p>
</li><li>
<p>Change has_many :through to use the :source option to specify the source
association.  :class_name is now ignored. [Rick Olson]</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Connection</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">user</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">channel</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">Channel</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">connections</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">contacts</span>, :<span class="ruby-identifier">through</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">connections</span>, :<span class="ruby-identifier">class_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'User'</span> <span class="ruby-comment"># OLD</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">contacts</span>, :<span class="ruby-identifier">through</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">connections</span>, :<span class="ruby-identifier">source</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">user</span>      <span class="ruby-comment"># NEW</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Fixed <a href="../../../classes/DB2.html">DB2</a> adapter so nullable
columns will be determines correctly now and quotes from column default
values will be removed #4350 [contact@maik-schmidt.de]</p>
</li><li>
<p>Allow overriding of find parameters in scoped has_many :through calls [Rick
Olson]</p>

<p>In this example, :include =&gt; false disables the default eager
association from loading.  :select changes the standard select clause. 
:joins specifies a join that is added to the end of the has_many :through
query.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Post</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">tags</span>, :<span class="ruby-identifier">through</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">taggings</span>, :<span class="ruby-identifier">include</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">tagging</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier">add_joins_and_select</span>
      <span class="ruby-identifier">find</span> :<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'tags.*, authors.id as author_id'</span>, :<span class="ruby-identifier">include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>,
        :<span class="ruby-identifier">joins</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'left outer join posts on taggings.taggable_id = posts.id left outer join authors on posts.author_id = authors.id'</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Fixed that schema changes while the database was open would break any
connections to a SQLite database (now we reconnect if that error is throw)
[DHH]</p>
</li><li>
<p>Don’t classify the has_one class when eager loading, it is already
singular. Add tests. (closes #4117) [jonathan@bluewire.net.nz]</p>
</li><li>
<p>Quit ignoring default :include options in has_many :through calls [Mark
James]</p>
</li><li>
<p>Allow has_many :through associations to find the source association by
setting a custom class (closes #4307) [jonathan@bluewire.net.nz]</p>
</li><li>
<p>Eager Loading support added for has_many :through =&gt; :has_many
associations (see below).  [Rick Olson]</p>
</li><li>
<p>Allow has_many :through to work on has_many associations (closes #3864)
[sco@scottraymond.net]  Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Firm</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">clients</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">invoices</span>, :<span class="ruby-identifier">through</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">clients</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">Client</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">firm</span>
  <span class="ruby-identifier">has_many</span>   :<span class="ruby-identifier">invoices</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">Invoice</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">client</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Raise error when trying to select many polymorphic objects with has_many
:through or :include (closes #4226) [josh@hasmanythrough.com]</p>
</li><li>
<p>Fixed has_many :through to include :conditions set on the :through
association. closes #4020 [jonathan@bluewire.net.nz]</p>
</li><li>
<p>Fix that has_many :through honors the foreign key set by the belongs_to
association in the join model (closes #4259) [andylien@gmail.com / Rick]</p>
</li><li>
<p>SQL Server adapter gets some love #4298 [rtomayko@gmail.com]</p>
</li><li>
<p>Added OpenBase database adapter that builds on top of the <a
href="http://www.spice-of-life.net/ruby-openbase/">www.spice-of-life.net/ruby-openbase/</a>
driver. All functionality except LIMIT/OFFSET is supported #3528
[derrickspell@cdmplus.com]</p>
</li><li>
<p>Rework table aliasing to account for truncated table aliases.  Add smarter
table aliasing when doing eager loading of STI associations. This allows
you to use the association name in the order/where clause. [Jonathan Viney
/ Rick Olson] #4108 Example (<a
href="../../../classes/SpecialComment.html">SpecialComment</a> is using
STI):</p>

<pre class="ruby"><span class="ruby-constant">Author</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">include</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-identifier">posts</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">special_comments</span> }, :<span class="ruby-identifier">order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'special_comments.body'</span>)
</pre>
</li><li>
<p>Add AbstractAdapter#table_alias_for to create table aliases according to
the rules of the current adapter. [Rick]</p>
</li><li>
<p>Provide access to the underlying database connection through
Adapter#raw_connection. Enables the use of db-specific methods without
complicating the adapters. #2090 [Koz]</p>
</li><li>
<p>Remove broken attempts at handling columns with a default of ‘now()’ in the
postgresql adapter. #2257 [Koz]</p>
</li><li>
<p>Added connectioncurrent_database that’ll return of the current database
(only works in MySQL, SQL Server, and Oracle so far – please help implement
for the rest of the adapters) #3663 [Tom ward]</p>
</li><li>
<p>Fixed that Migration#execute would have the table name prefix appended to
its query #4110 [pobox at mark.imbriaco.com]</p>
</li><li>
<p>Make all tinyint(1) variants act like boolean in mysql (tinyint(1)
unsigned, etc.) [Jamis Buck]</p>
</li><li>
<p>Use association’s :conditions when eager loading. [jeremyevans0@gmail.com]
#4144</p>
</li><li>
<p>Alias the has_and_belongs_to_many join table on eager includes. #4106
[jeremyevans0@gmail.com]</p>

<p>This statement would normally error because the projects_developers table
is joined twice, and therefore joined_on would be ambiguous.</p>

<pre class="ruby"><span class="ruby-constant">Developer</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">include</span> =<span class="ruby-operator">&gt;</span> {:<span class="ruby-identifier">projects</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">developers</span>}, :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'join_project_developers.joined_on IS NOT NULL'</span>)
</pre>
</li><li>
<p>Oracle adapter gets some love #4230 [schoenm@earthlink.net]</p>

<pre>* Changes :text to CLOB rather than BLOB [Moses Hohman]
* Fixes an issue with nil numeric length/scales (several)
* Implements support for XMLTYPE columns [wilig / Kubo Takehiro]
* Tweaks a unit test to get it all green again
* Adds support for #current_database</pre>
</li><li>
<p>Added Base.abstract_class? that marks which classes are not part of the
Active Record hierarchy #3704 [Rick Olson]</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">CachedModel</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">abstract_class</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">Post</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">CachedModel</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">CachedModel</span>.<span class="ruby-identifier">abstract_class?</span>
=<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>

<span class="ruby-constant">Post</span>.<span class="ruby-identifier">abstract_class?</span>
=<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>

<span class="ruby-constant">Post</span>.<span class="ruby-identifier">base_class</span>
=<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Post</span>

<span class="ruby-constant">Post</span>.<span class="ruby-identifier">table_name</span>
=<span class="ruby-operator">&gt;</span> <span class="ruby-string">'posts'</span>
</pre>
</li><li>
<p>Allow :dependent options to be used with polymorphic joins. #3820 [Rick
Olson]</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Foo</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">attachments</span>, :<span class="ruby-identifier">as</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">attachable</span>, :<span class="ruby-identifier">dependent</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">delete_all</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Nicer error message on has_many :through when :through reflection can not
be found. #4042 [court3nay@gmail.com]</p>
</li><li>
<p>Upgrade to Transaction::Simple 1.3 [Jamis Buck]</p>
</li><li>
<p>Catch FixtureClassNotFound when using instantiated fixtures on a fixture
that has no <a href="../../../classes/ActiveRecord.html">ActiveRecord</a>
model [Rick Olson]</p>
</li><li>
<p>Allow ordering of calculated results and/or grouped fields in calculations
[solo@gatelys.com]</p>
</li><li>
<p>Make <a
href="../../../classes/ActiveRecord/Base.html#method-i-save-21">ActiveRecord::Base#save!</a>
return true instead of nil on success.  #4173 [johan@johansorensen.com]</p>
</li><li>
<p>Dynamically set allow_concurrency.  #4044 [Stefan Kaes]</p>
</li><li>
<p>Added Base#to_xml that’ll turn the current record into a XML representation
[DHH]. Example:</p>

<pre>topic.to_xml</pre>

<p>…returns:</p>

<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;topic&gt;
  &lt;title&gt;The First Topic&lt;/title&gt;
  &lt;author-name&gt;David&lt;/author-name&gt;
  &lt;id type=&quot;integer&quot;&gt;1&lt;/id&gt;
  &lt;approved type=&quot;boolean&quot;&gt;false&lt;/approved&gt;
  &lt;replies-count type=&quot;integer&quot;&gt;0&lt;/replies-count&gt;
  &lt;bonus-time type=&quot;datetime&quot;&gt;2000-01-01 08:28:00&lt;/bonus-time&gt;
  &lt;written-on type=&quot;datetime&quot;&gt;2003-07-16 09:28:00&lt;/written-on&gt;
  &lt;content&gt;Have a nice day&lt;/content&gt;
  &lt;author-email-address&gt;david@loudthinking.com&lt;/author-email-address&gt;
  &lt;parent-id&gt;&lt;/parent-id&gt;
  &lt;last-read type=&quot;date&quot;&gt;2004-04-15&lt;/last-read&gt;
&lt;/topic&gt;</pre>

<p>…and you can configure with:</p>

<pre class="ruby"><span class="ruby-identifier">topic</span>.<span class="ruby-identifier">to_xml</span>(:<span class="ruby-identifier">skip_instruct</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>, :<span class="ruby-identifier">except</span> =<span class="ruby-operator">&gt;</span> [ :<span class="ruby-identifier">id</span>, <span class="ruby-identifier">bonus_time</span>, :<span class="ruby-identifier">written_on</span>, <span class="ruby-identifier">replies_count</span> ])
</pre>

<p>…that’ll return:</p>

<pre>&lt;topic&gt;
  &lt;title&gt;The First Topic&lt;/title&gt;
  &lt;author-name&gt;David&lt;/author-name&gt;
  &lt;approved type=&quot;boolean&quot;&gt;false&lt;/approved&gt;
  &lt;content&gt;Have a nice day&lt;/content&gt;
  &lt;author-email-address&gt;david@loudthinking.com&lt;/author-email-address&gt;
  &lt;parent-id&gt;&lt;/parent-id&gt;
  &lt;last-read type=&quot;date&quot;&gt;2004-04-15&lt;/last-read&gt;
&lt;/topic&gt;</pre>

<p>You can even do load first-level associations as part of the document:</p>

<pre class="ruby"><span class="ruby-identifier">firm</span>.<span class="ruby-identifier">to_xml</span> :<span class="ruby-identifier">include</span> =<span class="ruby-operator">&gt;</span> [ :<span class="ruby-identifier">account</span>, :<span class="ruby-identifier">clients</span> ]
</pre>

<p>…that’ll return something like:</p>

<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;firm&gt;
  &lt;id type=&quot;integer&quot;&gt;1&lt;/id&gt;
  &lt;rating type=&quot;integer&quot;&gt;1&lt;/rating&gt;
  &lt;name&gt;37signals&lt;/name&gt;
  &lt;clients&gt;
    &lt;client&gt;
      &lt;rating type=&quot;integer&quot;&gt;1&lt;/rating&gt;
      &lt;name&gt;Summit&lt;/name&gt;
    &lt;/client&gt;
    &lt;client&gt;
      &lt;rating type=&quot;integer&quot;&gt;1&lt;/rating&gt;
      &lt;name&gt;Microsoft&lt;/name&gt;
    &lt;/client&gt;
  &lt;/clients&gt;
  &lt;account&gt;
    &lt;id type=&quot;integer&quot;&gt;1&lt;/id&gt;
    &lt;credit-limit type=&quot;integer&quot;&gt;50&lt;/credit-limit&gt;
  &lt;/account&gt;
&lt;/firm&gt;</pre>
</li><li>
<p>Allow :counter_cache to take a column name for custom counter cache columns
[Jamis Buck]</p>
</li><li>
<p>Documentation fixes for :dependent [robby@planetargon.com]</p>
</li><li>
<p>Stop the MySQL adapter crashing when views are present. #3782 [Jonathan
Viney]</p>
</li><li>
<p>Don’t classify the belongs_to class, it is already singular #4117
[keithm@infused.org]</p>
</li><li>
<p>Allow set_fixture_class to take Classes instead of strings for a class in a
module.  Raise FixtureClassNotFound if a fixture can’t load.  [Rick Olson]</p>
</li><li>
<p>Fix quoting of inheritance column for STI eager loading #4098 [Jonathan
Viney &lt;jonathan@bluewire.net.nz&gt;]</p>
</li><li>
<p>Added smarter table aliasing for eager associations for multiple self joins
#3580 [Rick Olson]</p>

<pre class="ruby">* <span class="ruby-constant">The</span> <span class="ruby-identifier">first</span> <span class="ruby-identifier">time</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">table</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">referenced</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">join</span>, <span class="ruby-identifier">no</span> <span class="ruby-keyword">alias</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">used</span>.
* <span class="ruby-constant">After</span> <span class="ruby-identifier">that</span>, <span class="ruby-identifier">the</span> <span class="ruby-identifier">parent</span> <span class="ruby-keyword">class</span> <span class="ruby-identifier">name</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">reflection</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">are</span> <span class="ruby-identifier">used</span>.

    <span class="ruby-constant">Tree</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">include</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">children</span>) <span class="ruby-comment"># LEFT OUTER JOIN trees AS tree_children ...</span>

* <span class="ruby-constant">Any</span> <span class="ruby-identifier">additional</span> <span class="ruby-identifier">join</span> <span class="ruby-identifier">references</span> <span class="ruby-identifier">get</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">numerical</span> <span class="ruby-identifier">suffix</span> <span class="ruby-identifier">like</span> <span class="ruby-string">'_2'</span>, <span class="ruby-string">'_3'</span>, <span class="ruby-identifier">etc</span>.
</pre>
</li><li>
<p>Fixed eager loading problems with single-table inheritance #3580 [Rick
Olson]. <a
href="../../../classes/ActiveRecord/Base.html#method-c-find">ActiveRecord::Base.find</a>(:all,
:include =&gt; :special_comments) now returns all posts, and any special
comments that the posts may have. And made STI work with has_many :through
and polymorphic belongs_to.</p>
</li><li>
<p>Added cascading eager loading that allows for queries like <a
href="../../../classes/ActiveRecord/Base.html#method-c-find">ActiveRecord::Base.find</a>(:all,
:include=&gt; { :posts=&gt; :comments }), which will fetch all authors,
their posts, and the comments belonging to those posts in a single query
(using LEFT OUTER JOIN) #3913 [anna@wota.jp]. Examples:</p>

<pre class="ruby"><span class="ruby-comment"># cascaded in two levels</span>
<span class="ruby-operator">&gt;&gt;</span> <span class="ruby-constant">Author</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">include=</span><span class="ruby-operator">&gt;</span>{:<span class="ruby-identifier">posts=</span><span class="ruby-operator">&gt;</span>:<span class="ruby-identifier">comments</span>})
=<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">authors</span>
     <span class="ruby-operator">+</span><span class="ruby-operator">-</span> <span class="ruby-identifier">posts</span>
          <span class="ruby-operator">+</span><span class="ruby-operator">-</span> <span class="ruby-identifier">comments</span>

<span class="ruby-comment"># cascaded in two levels and normal association</span>
<span class="ruby-operator">&gt;&gt;</span> <span class="ruby-constant">Author</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">include=</span><span class="ruby-operator">&gt;</span>[{:<span class="ruby-identifier">posts=</span><span class="ruby-operator">&gt;</span>:<span class="ruby-identifier">comments</span>}, :<span class="ruby-identifier">categorizations</span>])
=<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">authors</span>
     <span class="ruby-operator">+</span><span class="ruby-operator">-</span> <span class="ruby-identifier">posts</span>
          <span class="ruby-operator">+</span><span class="ruby-operator">-</span> <span class="ruby-identifier">comments</span>
     <span class="ruby-operator">+</span><span class="ruby-operator">-</span> <span class="ruby-identifier">categorizations</span>

<span class="ruby-comment"># cascaded in two levels with two has_many associations</span>
<span class="ruby-operator">&gt;&gt;</span> <span class="ruby-constant">Author</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">include=</span><span class="ruby-operator">&gt;</span>{:<span class="ruby-identifier">posts=</span><span class="ruby-operator">&gt;</span>[:<span class="ruby-identifier">comments</span>, :<span class="ruby-identifier">categorizations</span>]})
=<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">authors</span>
     <span class="ruby-operator">+</span><span class="ruby-operator">-</span> <span class="ruby-identifier">posts</span>
          <span class="ruby-operator">+</span><span class="ruby-operator">-</span> <span class="ruby-identifier">comments</span>
          <span class="ruby-operator">+</span><span class="ruby-operator">-</span> <span class="ruby-identifier">categorizations</span>

<span class="ruby-comment"># cascaded in three levels</span>
<span class="ruby-operator">&gt;&gt;</span> <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">include=</span><span class="ruby-operator">&gt;</span>{:<span class="ruby-identifier">groups=</span><span class="ruby-operator">&gt;</span>{:<span class="ruby-identifier">members=</span><span class="ruby-operator">&gt;</span>{:<span class="ruby-identifier">favorites</span>}}})
=<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">companies</span>
     <span class="ruby-operator">+</span><span class="ruby-operator">-</span> <span class="ruby-identifier">groups</span>
          <span class="ruby-operator">+</span><span class="ruby-operator">-</span> <span class="ruby-identifier">members</span>
               <span class="ruby-operator">+</span><span class="ruby-operator">-</span> <span class="ruby-identifier">favorites</span>
</pre>
</li><li>
<p>Make counter cache work when replacing an association #3245
[eugenol@gmail.com]</p>
</li><li>
<p>Make migrations verbose [Jamis Buck]</p>
</li><li>
<p>Make counter_cache work with polymorphic belongs_to [Jamis Buck]</p>
</li><li>
<p>Fixed that calling HasOneProxy#build_model repeatedly would cause saving to
happen #4058 [anna@wota.jp]</p>
</li><li>
<p>Added Sybase database adapter that relies on the Sybase Open <a
href="../../../classes/Client.html">Client</a> bindings (see <a
href="http://raa.ruby-lang.org/project/sybase-ctlib">raa.ruby-lang.org/project/sybase-ctlib</a>)
#3765 [John Sheets]. It’s almost completely Active Record compliant
(including migrations), but has the following caveats:</p>

<pre>* Does not support DATE SQL column types; use DATETIME instead.
* Date columns on HABTM join tables are returned as String, not Time.
* Insertions are potentially broken for :polymorphic join tables
* BLOB column access not yet fully supported</pre>
</li><li>
<p>Clear stale, cached connections left behind by defunct threads. [Jeremy
Kemper]</p>
</li><li>
<p>CHANGED DEFAULT: set ActiveRecord::Base.allow_concurrency to false.  Most
AR usage is in single-threaded applications. [Jeremy Kemper]</p>
</li><li>
<p>Renamed the “oci” adapter to “oracle”, but kept the old name as an alias
#4017 [schoenm@earthlink.net]</p>
</li><li>
<p>Fixed that Base.save should always return false if the save didn’t succeed,
including if it has halted by before_save’s #1861, #2477 [DHH]</p>
</li><li>
<p>Speed up class -&gt; connection caching and stale connection verification. 
#3979 [Stefan Kaes]</p>
</li><li>
<p>Add set_fixture_class to allow the use of table name accessors with models
which use set_table_name. [Kevin Clark]</p>
</li><li>
<p>Added that fixtures to placed in subdirectories of the main fixture files
are also loaded #3937 [dblack@wobblini.net]</p>
</li><li>
<p>Define attribute query methods to avoid method_missing calls. #3677
[jonathan@bluewire.net.nz]</p>
</li><li>
<p><a
href="../../../classes/ActiveRecord/Base.html#method-c-remove_connection">ActiveRecord::Base.remove_connection</a>
explicitly closes database connections and doesn't corrupt the connection
cache. Introducing the disconnect! instance method for the PostgreSQL,
MySQL, and SQL Server adapters; implementations for the others are welcome.
#3591 [Simon Stapleton, Tom Ward]</p>
</li><li>
<p>Added support for nested scopes #3407 [anna@wota.jp]. Examples:</p>

<pre class="ruby"><span class="ruby-constant">Developer</span>.<span class="ruby-identifier">with_scope</span>(:<span class="ruby-identifier">find</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;salary &gt; 10000&quot;</span>, :<span class="ruby-identifier">limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span> }) <span class="ruby-keyword">do</span>
  <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>)     <span class="ruby-comment"># =&gt; SELECT * FROM developers WHERE (salary &gt; 10000) LIMIT 10</span>

  <span class="ruby-comment"># inner rule is used. (all previous parameters are ignored)</span>
  <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">with_exclusive_scope</span>(:<span class="ruby-identifier">find</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;name = 'Jamis'&quot;</span> }) <span class="ruby-keyword">do</span>
    <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>)   <span class="ruby-comment"># =&gt; SELECT * FROM developers WHERE (name = 'Jamis')</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># parameters are merged</span>
  <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">with_scope</span>(:<span class="ruby-identifier">find</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;name = 'Jamis'&quot;</span> }) <span class="ruby-keyword">do</span>
    <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>)   <span class="ruby-comment"># =&gt; SELECT * FROM developers WHERE (( salary &gt; 10000 ) AND ( name = 'Jamis' )) LIMIT 10</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Fixed db2 connection with empty user_name and auth options #3622
[phurley@gmail.com]</p>
</li><li>
<p>Fixed validates_length_of to work on UTF-8 strings by using characters
instead of bytes #3699 [Masao Mutoh]</p>
</li><li>
<p>Fixed that reflections would bleed across class boundaries in single-table
inheritance setups #3796 [lars@pind.com]</p>
</li><li>
<p>Added calculations: Base.count, Base.average, Base.sum, Base.minimum,
Base.maxmium, and the generic Base.calculate. All can be used with :group
and :having. Calculations and statitics need no longer require custom SQL.
#3958 [Rick Olson]. Examples:</p>

<pre class="ruby"><span class="ruby-constant">Person</span>.<span class="ruby-identifier">average</span> :<span class="ruby-identifier">age</span>
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">minimum</span> :<span class="ruby-identifier">age</span>
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">maximum</span> :<span class="ruby-identifier">age</span>
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">sum</span> :<span class="ruby-identifier">salary</span>, :<span class="ruby-identifier">group</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">last_name</span>
</pre>
</li><li>
<p>Renamed Errors#count to Errors#size but kept an alias for the old name (and
included an alias for length too) #3920 [contact@lukeredpath.co.uk]</p>
</li><li>
<p>Reflections don’t attempt to resolve module nesting of association classes.
Simplify type computation. [Jeremy Kemper]</p>
</li><li>
<p>Improved the Oracle OCI Adapter with better performance for column
reflection (from #3210), fixes to migrations (from #3476 and #3742), tweaks
to unit tests (from #3610), and improved documentation (from #2446) #3879
[Aggregated by schoenm@earthlink.net]</p>
</li><li>
<p>Fixed that the schema_info table used by <a
href="../../../classes/ActiveRecord/Schema.html#method-c-define">ActiveRecord::Schema.define</a>
should respect table pre- and suffixes #3834 [rubyonrails@atyp.de]</p>
</li><li>
<p>Added :select option to Base.count that’ll allow you to select something
else than * to be counted on. Especially important for count queries using
DISTINCT #3839 [skaes]</p>
</li><li>
<p>Correct syntax error in mysql DDL,  and make <a
href="../../../classes/AAACreateTablesTest.html">AAACreateTablesTest</a>
run first [Bob Silva]</p>
</li><li>
<p>Allow :include to be used with has_many :through associations #3611
[Michael Schoen]</p>
</li><li>
<p>PostgreSQL: smarter schema dumps using pk_and_sequence_for(table).  #2920
[Blair Zajac]</p>
</li><li>
<p>SQLServer: more compatible limit/offset emulation.  #3779 [Tom Ward]</p>
</li><li>
<p>Polymorphic join support for has_one associations (has_one :foo, :as =&gt;
:bar)  #3785 [Rick Olson]</p>
</li><li>
<p>PostgreSQL: correctly parse negative integer column defaults.  #3776
[bellis@deepthought.org]</p>
</li><li>
<p>Fix problems with count when used with :include [Jeremy Hopple and Kevin
Clark]</p>
</li><li>
<p>ActiveRecord::RecordInvalid now states which validations failed in its
default error message [Tobias Luetke]</p>
</li><li>
<p>Using AssociationCollection#build with arrays of hashes should call build,
not create [DHH]</p>
</li><li>
<p>Remove definition of reloadable? from <a
href="../../../classes/ActiveRecord/Base.html">ActiveRecord::Base</a> to
make way for new Reloadable code. [Nicholas Seckar]</p>
</li><li>
<p>Fixed schema handling for <a href="../../../classes/DB2.html">DB2</a>
adapter that didn’t work: an initial schema could be set, but it wasn’t
used when getting tables and indexes #3678 [Maik Schmidt]</p>
</li><li>
<p>Support the :column option for remove_index with the PostgreSQL adapter.
#3661 [shugo@ruby-lang.org]</p>
</li><li>
<p>Add documentation for add_index and remove_index. #3600 [Manfred Stienstra
&lt;fngtps at m.stienstra.com&gt;]</p>
</li><li>
<p>If the OCI library is not available, raise an exception indicating as much.
#3593 [schoenm@earthlink.net]</p>
</li><li>
<p>Add explicit :order in finder tests as postgresql orders results
differently by default. #3577. [Rick Olson]</p>
</li><li>
<p>Make dynamic finders honor additional passed in :conditions. #3569 [Oleg
Pudeyev &lt;pudeyo@rpi.edu&gt;, Marcel Molina Jr.]</p>
</li><li>
<p>Show a meaningful error when the <a
href="../../../classes/DB2.html">DB2</a> adapter cannot be loaded due to
missing dependencies. [Nicholas Seckar]</p>
</li><li>
<p>Make .count work for has_many associations with multi line finder sql
[schoenm@earthlink.net]</p>
</li><li>
<p>Add AR::Base.base_class for querying the ancestor AR::Base subclass [Jamis
Buck]</p>
</li><li>
<p>Allow configuration of the column used for optimistic locking
[wilsonb@gmail.com]</p>
</li><li>
<p>Don’t hardcode ‘id’ in acts as list.  [ror@philippeapril.com]</p>
</li><li>
<p>Fix date errors for SQLServer in association tests. #3406 [gmal at
kevin.clark.com]</p>
</li><li>
<p>Escape database name in MySQL adapter when creating and dropping databases.
#3409 [anna@wota.jp]</p>
</li><li>
<p>Disambiguate table names for columns in validates_uniquness_of’s WHERE
clause. #3423 [gmail at alex.borovsky.com]</p>
</li><li>
<p>.with_scope imposed create parameters now bypass attr_protected [Tobias
Luetke]</p>
</li><li>
<p>Don’t raise an exception when there are more keys than there are named bind
variables when sanitizing conditions. [Marcel Molina Jr.]</p>
</li><li>
<p>Multiple enhancements and adjustments to <a
href="../../../classes/DB2.html">DB2</a> adaptor. #3377
[contact@maik-schmidt.de]</p>
</li><li>
<p>Sanitize scoped conditions. [Marcel Molina Jr.]</p>
</li><li>
<p>Added option to Base.reflection_of_all_associations to specify a specific
association to scope the call. For example
Base.reflection_of_all_associations(:has_many) [DHH]</p>
</li><li>
<p>Added ActiveRecord::SchemaDumper.ignore_tables which tells SchemaDumper
which tables to ignore. Useful for tables with funky column like the ones
required for tsearch2. [TobiasLuetke]</p>
</li><li>
<p>SchemaDumper now doesn’t fail anymore when there are unknown column types
in the schema. Instead the table is ignored and a <a
href="../../../classes/Comment.html">Comment</a> is left in the schema.rb.
[TobiasLuetke]</p>
</li><li>
<p>Fixed that saving a model with multiple habtm associations would only save
the first one.  #3244 [yanowitz-rubyonrails@quantumfoam.org, Florian Weber]</p>
</li><li>
<p>Fix change_column to work with PostgreSQL 7.x and 8.x.  #3141 [wejn@box.cz,
Rick Olson, Scott Barron]</p>
</li><li>
<p>removed :piggyback in favor of just allowing :select on :through
associations. [Tobias Luetke]</p>
</li><li>
<p>made method missing delegation to class methods on relation target work on
:through associations. [Tobias Luetke]</p>
</li><li>
<p>made .find() work on :through relations. [Tobias Luetke]</p>
</li><li>
<p>Fix typo in association docs. #3296. [Blair Zajac]</p>
</li><li>
<p>Fixed :through relations when using STI inherited classes would use the
inherited class’s name as foreign key on the join model [Tobias Luetke]</p>
</li></ul>

<p><strong>1.13.2</strong> (December 13th, 2005)</p>
<ul><li>
<p>Become part of <a href="../../../classes/Rails.html">Rails</a> 1.0</p>
</li><li>
<p>MySQL: allow encoding option for mysql.rb driver.  [Jeremy Kemper]</p>
</li><li>
<p>Added option inheritance for find calls on has_and_belongs_to_many and
has_many assosociations [DHH]. Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Post</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">recent_comments</span>, :<span class="ruby-identifier">class_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Comment&quot;</span>, :<span class="ruby-identifier">limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>, :<span class="ruby-identifier">include</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">author</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">post</span>.<span class="ruby-identifier">recent_comments</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>) <span class="ruby-comment"># Uses LIMIT 10 and includes authors</span>
<span class="ruby-identifier">post</span>.<span class="ruby-identifier">recent_comments</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>) <span class="ruby-comment"># Uses no limit but include authors</span>
<span class="ruby-identifier">post</span>.<span class="ruby-identifier">recent_comments</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, :<span class="ruby-identifier">include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>) <span class="ruby-comment"># Uses no limit and doesn't include authors</span>
</pre>
</li><li>
<p>Added option to specify :group, :limit, :offset, and :select options from
find on has_and_belongs_to_many and has_many assosociations [DHH]</p>
</li><li>
<p>MySQL: fixes for the bundled mysql.rb driver.  #3160 [Justin Forder]</p>
</li><li>
<p>SQLServer: fix obscure optimistic locking bug.  #3068 [kajism@yahoo.com]</p>
</li><li>
<p>SQLServer: support uniqueidentifier columns.  #2930 [keithm@infused.org]</p>
</li><li>
<p>SQLServer: cope with tables names qualified by owner.  #3067
[jeff@ministrycentered.com]</p>
</li><li>
<p>SQLServer: cope with columns with “desc” in the name.  #1950 [Ron Lusk,
Ryan Tomayko]</p>
</li><li>
<p>SQLServer: cope with primary keys with “select” in the name.  #3057
[rdifrango@captechventures.com]</p>
</li><li>
<p>Oracle: active? performs a select instead of a commit.  #3133 [Michael
Schoen]</p>
</li><li>
<p>MySQL: more robust test for nullified result hashes.  #3124 [Stefan Kaes]</p>
</li><li>
<p>Reloading an instance refreshes its aggregations as well as its
associations.  #3024 [FranÃ§ois Beausolei]</p>
</li><li>
<p>Fixed that using :include together with :conditions array in Base.find
would cause NoMethodError #2887 [Paul Hammmond]</p>
</li><li>
<p>PostgreSQL: more robust sequence name discovery.  #3087 [Rick Olson]</p>
</li><li>
<p>Oracle: use syntax compatible with Oracle 8.  #3131 [Michael Schoen]</p>
</li><li>
<p>MySQL: work around ruby-mysql/mysql-ruby inconsistency with mysql.stat. 
Eliminate usage of mysql.ping because it doesn’t guarantee reconnect. 
Explicitly close and reopen the connection instead.  [Jeremy Kemper]</p>
</li><li>
<p>Added preliminary support for polymorphic associations [DHH]</p>
</li><li>
<p>Added preliminary support for join models [DHH]</p>
</li><li>
<p>Allow validate_uniqueness_of to be scoped by more than just one column. 
#1559. [jeremy@jthopple.com, Marcel Molina Jr.]</p>
</li><li>
<p>Firebird: active? and reconnect! methods for handling stale connections. 
#428 [Ken Kunz &lt;kennethkunz@gmail.com&gt;]</p>
</li><li>
<p>Firebird: updated for <a href="../../../classes/FireRuby.html">FireRuby</a>
0.4.0.  #3009 [Ken Kunz &lt;kennethkunz@gmail.com&gt;]</p>
</li><li>
<p>MySQL and PostgreSQL: active? compatibility with the pure-Ruby driver. 
#428 [Jeremy Kemper]</p>
</li><li>
<p>Oracle: active? check pings the database rather than testing the last
command status.  #428 [Michael Schoen]</p>
</li><li>
<p>SQLServer: resolve column aliasing/quoting collision when using limit or
offset in an eager find.  #2974 [kajism@yahoo.com]</p>
</li><li>
<p>Reloading a model doesn’t lose track of its connection.  #2996
[junk@miriamtech.com, Jeremy Kemper]</p>
</li><li>
<p>Fixed bug where using update_attribute after pushing a record to a habtm
association of the object caused duplicate rows in the join table. #2888
[colman@rominato.com, Florian Weber, Michael Schoen]</p>
</li><li>
<p>MySQL, PostgreSQL: reconnect! also reconfigures the connection.  Otherwise,
the connection ‘loses’ its settings if it times out and is reconnected. 
#2978 [Shugo Maeda]</p>
</li><li>
<p>has_and_belongs_to_many: use JOIN instead of LEFT JOIN.  [Jeremy Kemper]</p>
</li><li>
<p>MySQL: introduce :encoding option to specify the character set for client,
connection, and results.  Only available for MySQL 4.1 and later with the
mysql-ruby driver.  Do SHOW CHARACTER SET in mysql client to see available
encodings.  #2975 [Shugo Maeda]</p>
</li><li>
<p>Add tasks to create, drop and rebuild the MySQL and PostgreSQL test 
databases. [Marcel Molina Jr.]</p>
</li><li>
<p>Correct boolean handling in generated reader methods.  #2945 [gmail at
don.park.com, Stefan Kaes]</p>
</li><li>
<p>Don’t generate read methods for columns whose names are not valid ruby
method names.  #2946 [Stefan Kaes]</p>
</li><li>
<p>Document :force option to create_table.  #2921 [Blair Zajac
&lt;blair@orcaware.com&gt;]</p>
</li><li>
<p>Don’t add the same conditions twice in has_one finder sql.  #2916 [Jeremy
Evans]</p>
</li><li>
<p>Rename Version constant to VERSION. #2802 [Marcel Molina Jr.]</p>
</li><li>
<p>Introducing the Firebird adapter.  Quote columns and use
attribute_condition more consistently.  Setup guide: <a
href="http://wiki.rubyonrails.com/rails/pages/Firebird+Adapter">wiki.rubyonrails.com/rails/pages/Firebird+Adapter</a>
#1874 [Ken Kunz &lt;kennethkunz@gmail.com&gt;]</p>
</li><li>
<p>SQLServer: active? and reconnect! methods for handling stale connections. 
#428 [kajism@yahoo.com, Tom Ward &lt;tom@popdog.net&gt;]</p>
</li><li>
<p>Associations handle case-equality more consistently:
item.parts.is_a?(Array) and item.parts === Array.  #1345 [reality at
MarkusQ.com]</p>
</li><li>
<p>SQLServer: insert uses given primary key value if not nil rather than
SELECT @@IDENTITY.  #2866 [kajism@yahoo.com, Tom Ward
&lt;tom@popdog.net&gt;]</p>
</li><li>
<p>Oracle: active? and reconnect! methods for handling stale connections. 
Optionally retry queries after reconnect.  #428 [Michael Schoen
&lt;schoenm@earthlink.net&gt;]</p>
</li><li>
<p>Correct documentation for Base.delete_all.  #1568 [Newhydra]</p>
</li><li>
<p>Oracle: test case for column default parsing.  #2788 [Michael Schoen
&lt;schoenm@earthlink.net&gt;]</p>
</li><li>
<p>Update documentation for Migrations.  #2861 [Tom Werner
&lt;tom@cube6media.com&gt;]</p>
</li><li>
<p>When AbstractAdapter#log rescues an exception, attempt to detect and
reconnect to an inactive database connection.  Connection adapter must
respond to the active? and reconnect! instance methods.  Initial support
for PostgreSQL, MySQL, and SQLite.  Make certain that all statements which
may need reconnection are performed within a logged block: for example,
this means no avoiding log(sql, name) { } if @logger.nil?  #428 [Jeremy
Kemper]</p>
</li><li>
<p>Oracle: Much faster column reflection.  #2848 [Michael Schoen
&lt;schoenm@earthlink.net&gt;]</p>
</li><li>
<p>Base.reset_sequence_name analogous to reset_table_name (mostly useful for
testing).  Base.define_attr_method allows nil values.  [Jeremy Kemper]</p>
</li><li>
<p>PostgreSQL: smarter sequence name defaults, stricter last_insert_id, warn
on pk without sequence.  [Jeremy Kemper]</p>
</li><li>
<p>PostgreSQL: correctly discover custom primary key sequences.  #2594 [Blair
Zajac &lt;blair@orcaware.com&gt;, gmail at meadow.nnick.com, Jeremy Kemper]</p>
</li><li>
<p>SQLServer: don’t report limits for unsupported field types.  #2835 [Ryan
Tomayko]</p>
</li><li>
<p>Include the <a href="../../../classes/Enumerable.html">Enumerable</a>
module in <a
href="../../../classes/ActiveRecord/Errors.html">ActiveRecord::Errors</a>. 
[Rick Bradley &lt;rick@rickbradley.com&gt;]</p>
</li><li>
<p>Add :group option, correspond to GROUP BY, to the find method and to the
has_many association.  #2818 [rubyonrails@atyp.de]</p>
</li><li>
<p>Don’t cast nil or empty strings to a dummy date.  #2789 [Rick Bradley
&lt;rick@rickbradley.com&gt;]</p>
</li><li>
<p>acts_as_list plays nicely with inheritance by remembering the class which
declared it.  #2811 [rephorm@rephorm.com]</p>
</li><li>
<p>Fix sqlite adaptor’s detection of missing dbfile or database declaration.
[Nicholas Seckar]</p>
</li><li>
<p>Fixed acts_as_list for definitions without an explicit :order #2803
[jonathan@bluewire.net.nz]</p>
</li><li>
<p>Upgrade bundled ruby-mysql 0.2.4 with mysql411 shim (see #440) to
ruby-mysql 0.2.6 with a patchset for 4.1 protocol support.  Local change
[301] is now a part of the main driver; reapplied local change [2182]. 
Removed GC.start from Result.free.  [tommy@tmtm.org, akuroda@gmail.com,
Doug Fales &lt;gmail at doug.fales.com&gt;, Jeremy Kemper]</p>
</li><li>
<p>Correct handling of complex order clauses with SQL Server limit emulation. 
#2770 [Tom Ward &lt;tom@popdog.net&gt;, Matt <a
href="../../../classes/B.html">B</a>.]</p>
</li><li>
<p>Correct whitespace problem in Oracle default column value parsing.  #2788
[rick@rickbradley.com]</p>
</li><li>
<p>Destroy associated has_and_belongs_to_many records after all before_destroy
callbacks but before destroy.  This allows you to act on the habtm
association as you please while preserving referential integrity.  #2065
[larrywilliams1@gmail.com, gmail at sam.kirchmeier.com, elliot@townx.org,
Jeremy Kemper]</p>
</li><li>
<p>Deprecate the old, confusing :exclusively_dependent option in favor of
:dependent =&gt; :delete_all.  [Jeremy Kemper]</p>
</li><li>
<p>More compatible Oracle column reflection.  #2771 [Ryan Davis
&lt;ryand-ruby@zenspider.com&gt;, Michael Schoen
&lt;schoenm@earthlink.net&gt;]</p>
</li></ul>

<p><strong>1.13.0</strong> (November 7th, 2005)</p>
<ul><li>
<p>Fixed faulty regex in get_table_name method (SQLServerAdapter) #2639 [Ryan
Tomayko]</p>
</li><li>
<p>Added :include as an option for association declarations [DHH]. Example:</p>

<pre class="ruby"><span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">posts</span>, :<span class="ruby-identifier">include</span> =<span class="ruby-operator">&gt;</span> [ :<span class="ruby-identifier">author</span>, :<span class="ruby-identifier">comments</span> ]
</pre>
</li><li>
<p>Rename Base.constrain to Base.with_scope so it doesn’t conflict with
existing concept of database constraints.  Make scoping more robust:
uniform method =&gt; parameters, validated method names and supported
finder parameters, raise exception on nested scopes.  [Jeremy Kemper] 
Example:</p>

<pre class="ruby"><span class="ruby-constant">Comment</span>.<span class="ruby-identifier">with_scope</span>(:<span class="ruby-identifier">find</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'active=true'</span> }, :<span class="ruby-identifier">create</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-identifier">post_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span> }) <span class="ruby-keyword">do</span>
  <span class="ruby-comment"># Find where name = ? and active=true</span>
  <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span> :<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-string">'name = ?'</span>, <span class="ruby-identifier">name</span>]
  <span class="ruby-comment"># Create comment associated with :post_id</span>
  <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">create</span> :<span class="ruby-identifier">body</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Hello world&quot;</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Fixed that SQL Server should ignore :size declarations on anything but
integer and string in the agnostic schema representation #2756 [Ryan
Tomayko]</p>
</li><li>
<p>Added constrain scoping for creates using a hash of attributes bound to the
:creation key [DHH]. Example:</p>

<pre class="ruby"><span class="ruby-constant">Comment</span>.<span class="ruby-identifier">constrain</span>(:<span class="ruby-identifier">creation</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-identifier">post_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span> }) <span class="ruby-keyword">do</span>
  <span class="ruby-comment"># Associated with :post_id</span>
  <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">create</span> :<span class="ruby-identifier">body</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Hello world&quot;</span>
<span class="ruby-keyword">end</span>
</pre>

<p>This is rarely used directly, but allows for find_or_create on
associations. So you can do:</p>

<pre># If the tag doesn't exist, a new one is created that's associated with the person
person.tags.find_or_create_by_name(&quot;Summer&quot;)</pre>
</li><li>
<p>Added find_or_create_by_X as a second type of dynamic finder that’ll create
the record if it doesn’t already exist [DHH]. Example:</p>

<pre class="ruby"><span class="ruby-comment"># No 'Summer' tag exists</span>
<span class="ruby-constant">Tag</span>.<span class="ruby-identifier">find_or_create_by_name</span>(<span class="ruby-string">&quot;Summer&quot;</span>) <span class="ruby-comment"># equal to Tag.create(:name =&gt; &quot;Summer&quot;)</span>

<span class="ruby-comment"># Now the 'Summer' tag does exist</span>
<span class="ruby-constant">Tag</span>.<span class="ruby-identifier">find_or_create_by_name</span>(<span class="ruby-string">&quot;Summer&quot;</span>) <span class="ruby-comment"># equal to Tag.find_by_name(&quot;Summer&quot;)</span>
</pre>
</li><li>
<p>Added extension capabilities to has_many and has_and_belongs_to_many
proxies [DHH]. Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Account</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">people</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier">find_or_create_by_name</span>(<span class="ruby-identifier">name</span>)
      <span class="ruby-identifier">first_name</span>, *<span class="ruby-identifier">last_name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">split</span>
      <span class="ruby-identifier">last_name</span> = <span class="ruby-identifier">last_name</span>.<span class="ruby-identifier">join</span> <span class="ruby-string">&quot; &quot;</span>

      <span class="ruby-identifier">find_or_create_by_first_name_and_last_name</span>(<span class="ruby-identifier">first_name</span>, <span class="ruby-identifier">last_name</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">person</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">first</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">find_or_create_by_name</span>(<span class="ruby-string">&quot;David Heinemeier Hansson&quot;</span>)
<span class="ruby-identifier">person</span>.<span class="ruby-identifier">first_name</span> <span class="ruby-comment"># =&gt; &quot;David&quot;</span>
<span class="ruby-identifier">person</span>.<span class="ruby-identifier">last_name</span>  <span class="ruby-comment"># =&gt; &quot;Heinemeier Hansson&quot;</span>
</pre>

<p>Note that the anoymous module must be declared using brackets, not do/end
(due to order of evaluation).</p>
</li><li>
<p>Omit internal dtproperties table from SQLServer table list.  #2729
[rtomayko@gmail.com]</p>
</li><li>
<p>Quote column names in generated SQL.  #2728 [rtomayko@gmail.com]</p>
</li><li>
<p>Correct the pure-Ruby MySQL 4.1.1 shim’s version test.  #2718 [Jeremy
Kemper]</p>
</li><li>
<p>Add Model.create! to match existing model.save! method.  When save! raises
RecordInvalid, you can catch the exception, retrieve the invalid record
(invalid_exception.record), and see its errors
(invalid_exception.record.errors).  [Jeremy Kemper]</p>
</li><li>
<p>Correct fixture behavior when table name pluralization is off.  #2719 [Rick
Bradley &lt;rick@rickbradley.com&gt;]</p>
</li><li>
<p>Changed :dbfile to :database for SQLite adapter for consistency (old key
still works as an alias) #2644 [Dan Peterson]</p>
</li><li>
<p>Added migration support for Oracle #2647 [Michael Schoen]</p>
</li><li>
<p>Worked around that connection can’t be reset if allow_concurrency is off. 
#2648 [Michael Schoen &lt;schoenm@earthlink.net&gt;]</p>
</li><li>
<p>Fixed SQL Server adapter to pass even more tests and do even better #2634
[rtomayko@gmail.com]</p>
</li><li>
<p>Fixed SQL Server adapter so it honors <a
href="http://:conditions">options</a> when applying :limits #1978 [Tom
Ward]</p>
</li><li>
<p>Added migration support to SQL Server adapter (please someone do the same
for Oracle and <a href="../../../classes/DB2.html">DB2</a>) #2625 [Tom
Ward]</p>
</li><li>
<p>Use AR::Base.silence rather than AR::Base.logger.silence in fixtures to
preserve Log4r compatibility.  #2618 [dansketcher@gmail.com]</p>
</li><li>
<p>Constraints are cloned so they can’t be inadvertently modified while
they’re</p>
</li></ul>

<p>in effect.  Added :readonly finder constraint.  Calling an association
collection’s class method (Part.foobar via item.parts.foobar) constrains
:readonly =&gt; false since the collection’s :joins constraint would
otherwise force it to true.  [Jeremy Kemper &lt;rails@bitsweat.net&gt;]</p>
<ul><li>
<p>Added :offset and :limit to the kinds of options that Base.constrain can
use #2466 [gmail at duane.johnson.com]</p>
</li><li>
<p>Fixed handling of nil number columns on Oracle and cleaned up tests for
Oracle in general #2555 [schoenm@earthlink.net]</p>
</li><li>
<p>Added quoted_true and quoted_false methods and tables to db2_adapter and
cleaned up tests for <a href="../../../classes/DB2.html">DB2</a> #2493,
#2624 [maik schmidt]</p>
</li></ul>

<p><strong>1.12.2</strong> (October 26th, 2005)</p>
<ul><li>
<p>Allow symbols to rename columns when using SQLite adapter. #2531 [gmal at
kevin.clark.com]</p>
</li><li>
<p>Map Active Record time to SQL TIME.  #2575, #2576 [Robby Russell
&lt;robby@planetargon.com&gt;]</p>
</li><li>
<p>Clarify semantics of <a
href="../../../classes/ActiveRecord/Base.html#method-i-respond_to-3F">ActiveRecord::Base#respond_to?</a>
#2560 [skaes@web.de]</p>
</li><li>
<p>Fixed Association#clear for associations which have not yet been accessed.
#2524 [Patrick Lenz &lt;patrick@lenz.sh&gt;]</p>
</li><li>
<p>HABTM finders shouldn’t return readonly records.  #2525 [Patrick Lenz
&lt;patrick@lenz.sh&gt;]</p>
</li><li>
<p>Make all tests runnable on their own. #2521. [Blair Zajac
&lt;blair@orcaware.com&gt;]</p>
</li></ul>

<p><strong>1.12.1</strong> (October 19th, 2005)</p>
<ul><li>
<p>Always parenthesize :conditions options so they may be safely combined with
STI and constraints.</p>
</li><li>
<p>Correct PostgreSQL primary key sequence detection.  #2507
[tmornini@infomania.com]</p>
</li><li>
<p>Added support for using limits in eager loads that involve has_many and
has_and_belongs_to_many associations</p>
</li></ul>

<p><strong>1.12.0</strong> (October 16th, 2005)</p>
<ul><li>
<p>Update/clean up documentation (rdoc)</p>
</li><li>
<p>PostgreSQL sequence support.  Use set_sequence_name in your model class to
specify its primary key sequence.  #2292 [Rick Olson
&lt;technoweenie@gmail.com&gt;, Robby Russell
&lt;robby@planetargon.com&gt;]</p>
</li><li>
<p>Change default logging colors to work on both white and black backgrounds.
[Sam Stephenson]</p>
</li><li>
<p>YAML fixtures support ordered hashes for fixtures with foreign key
dependencies in the same table.  #1896 [purestorm@ggnore.net]</p>
</li><li>
<p>:dependent now accepts :nullify option. Sets the foreign key of the related
objects to NULL instead of deleting them. #2015 [Robby Russell
&lt;robby@planetargon.com&gt;]</p>
</li><li>
<p>Introduce read-only records.  If you call object.readonly! then it will
mark the object as read-only and raise ReadOnlyRecord if you call
object.save.  object.readonly? reports whether the object is read-only. 
Passing :readonly =&gt; true to any finder method will mark returned
records as read-only.  The :joins option now implies :readonly, so if you
use this option, saving the same record will now fail.  Use find_by_sql to
work around.</p>
</li><li>
<p>Avoid memleak in dev mode when using fcgi</p>
</li><li>
<p>Simplified .clear on active record associations by using the existing
delete_records method. #1906 [Caleb &lt;me@cpb.ca&gt;]</p>
</li><li>
<p>Delegate access to a customized primary key to the conventional id method.
#2444. [Blair Zajac &lt;blair@orcaware.com&gt;]</p>
</li><li>
<p>Fix errors caused by assigning a has-one or belongs-to property to itself</p>
</li><li>
<p>Add ActiveRecord::Base.schema_format setting which specifies how databases
should be dumped [Sam Stephenson]</p>
</li><li>
<p>Update <a href="../../../classes/DB2.html">DB2</a> adapter. #2206.
[contact@maik-schmidt.de]</p>
</li><li>
<p>Corrections to SQLServer native data types. #2267.  [spamgourmet at
rails.20.clarry.com]</p>
</li><li>
<p>Deprecated ActiveRecord::Base.threaded_connection in favor of
ActiveRecord::Base.allow_concurrency.</p>
</li><li>
<p>Protect id attribute from mass assigment even when the primary key is set
to something else. #2438. [Blair Zajac &lt;blair@orcaware.com&gt;]</p>
</li><li>
<p>Misc doc fixes (typos/grammar/etc.). #2430. [coffee2code]</p>
</li><li>
<p>Add test coverage for content_columns. #2432. [coffee2code]</p>
</li><li>
<p>Speed up for unthreaded environments. #2431. [skaes@web.de]</p>
</li><li>
<p>Optimization for <a href="../../../classes/Mysql.html">Mysql</a> selects
using mysql-ruby extension greater than 2.6.3.  #2426. [skaes@web.de]</p>
</li><li>
<p>Speed up the setting of table_name. #2428. [skaes@web.de]</p>
</li><li>
<p>Optimize instantiation of STI subclass records. In partial fullfilment of
#1236. [skaes@web.de]</p>
</li><li>
<p>Fix typo of ‘constrains’ to ‘contraints’. #2069. [Michael Schuerig
&lt;michael@schuerig.de&gt;]</p>
</li><li>
<p>Optimization refactoring for add_limit_offset!. In partial fullfilment of
#1236. [skaes@web.de]</p>
</li><li>
<p>Add ability to get all siblings, including the current child, with
acts_as_tree. Recloses #2140. [Michael Schuerig
&lt;michael@schuerig.de&gt;]</p>
</li><li>
<p>Add geometric type for postgresql adapter. #2233 [akaspick@gmail.com]</p>
</li><li>
<p>Add option (true by default) to generate reader methods for each attribute
of a record to avoid the overhead of calling method missing. In partial
fullfilment of #1236. [skaes@web.de]</p>
</li><li>
<p>Add convenience predicate methods on Column class. In partial fullfilment
of #1236. [skaes@web.de]</p>
</li><li>
<p>Raise errors when invalid hash keys are passed to <a
href="../../../classes/ActiveRecord/Base.html#method-c-find">ActiveRecord::Base.find</a>.
#2363  [Chad Fowler &lt;chad@chadfowler.com&gt;, Nicholas Seckar]</p>
</li><li>
<p>Added :force option to create_table that’ll try to drop the table if it
already exists before creating</p>
</li><li>
<p>Fix transactions so that calling return while inside a transaction will not
leave an open transaction on the connection. [Nicholas Seckar]</p>
</li><li>
<p>Use foreign_key inflection uniformly.  #2156 [Blair Zajac
&lt;blair@orcaware.com&gt;]</p>
</li><li>
<p>model.association.clear should destroy associated objects if :dependent
=&gt; true instead of nullifying their foreign keys.  #2221
[joergd@pobox.com, ObieFernandez &lt;obiefernandez@gmail.com&gt;]</p>
</li><li>
<p>Returning false from before_destroy should cancel the action.  #1829
[Jeremy Huffman]</p>
</li><li>
<p>Recognize PostgreSQL NOW() default as equivalent to CURRENT_TIMESTAMP or
CURRENT_DATE, depending on the column’s type.  #2256 [mat
&lt;mat@absolight.fr&gt;]</p>
</li><li>
<p>Extensive documentation for the abstract database adapter.  #2250 [François
Beausoleil &lt;fbeausoleil@ftml.net&gt;]</p>
</li><li>
<p>Clean up Fixtures.reset_sequences for PostgreSQL.  Handle tables with no
rows and models with custom primary keys.  #2174, #2183 [jay@jay.fm, Blair
Zajac &lt;blair@orcaware.com&gt;]</p>
</li><li>
<p>Improve error message when nil is assigned to an attr which
validates_size_of within a range.  #2022 [Manuel Holtgrewe
&lt;purestorm@ggnore.net&gt;]</p>
</li><li>
<p>Make update_attribute use the same writer method that update_attributes
uses.</p>
</li></ul>

<pre>#2237 [trevor@protocool.com]</pre>
<ul><li>
<p>Make migrations honor table name prefixes and suffixes. #2298 [Jakob S,
Marcel Molina]</p>
</li><li>
<p>Correct and optimize PostgreSQL bytea escaping.  #1745, #1837
[dave@cherryville.org, ken@miriamtech.com, bellis@deepthought.org]</p>
</li><li>
<p><a href="../../../classes/Fixtures.html">Fixtures</a> should only reset a
PostgreSQL sequence if it corresponds to an integer primary key named id. 
#1749 [chris@chrisbrinker.com]</p>
</li><li>
<p>Standardize the interpretation of boolean columns in the <a
href="../../../classes/Mysql.html">Mysql</a> and Sqlite adapters. (Use
MysqlAdapter.emulate_booleans = false to disable this behavior)</p>
</li><li>
<p>Added new symbol-driven approach to activating observers with
Base#observers= [DHH]. Example:</p>

<pre>ActiveRecord::Base.observers = :cacher, :garbage_collector</pre>
</li><li>
<p>Added AbstractAdapter#select_value and AbstractAdapter#select_values as
convenience methods for selecting single values, instead of hashes, of the
first column in a SELECT #2283 [solo@gatelys.com]</p>
</li><li>
<p>Wrap :conditions in parentheses to prevent problems with OR’s #1871 [Jamis
Buck]</p>
</li><li>
<p>Allow the postgresql adapter to work with the SchemaDumper. [Jamis Buck]</p>
</li><li>
<p>Add ActiveRecord::SchemaDumper for dumping a DB schema to a pure-ruby file,
making it easier to consolidate large migration lists and port database
schemas between databases. [Jamis Buck]</p>
</li><li>
<p>Fixed migrations for Windows when using more than 10 [David Naseby]</p>
</li><li>
<p>Fixed that the create_x method from belongs_to wouldn’t save the
association properly #2042 [Florian Weber]</p>
</li><li>
<p>Fixed saving a record with two unsaved belongs_to associations pointing to
the same object #2023 [Tobias Luetke]</p>
</li><li>
<p>Improved migrations’ behavior when the schema_info table is empty.
[Nicholas Seckar]</p>
</li><li>
<p>Fixed that Observers didn’t observe sub-classes #627 [Florian Weber]</p>
</li><li>
<p>Fix eager loading error messages, allow :include to specify tables using
strings or symbols. Closes #2222 [Marcel Molina]</p>
</li><li>
<p>Added check for RAILS_CONNECTION_ADAPTERS on startup and only load the
connection adapters specified within if its present (available in <a
href="../../../classes/Rails.html">Rails</a> through
config.connection_adapters using the new config) #1958 [skae]</p>
</li><li>
<p>Fixed various problems with has_and_belongs_to_many when using customer
finder_sql #2094 [Florian Weber]</p>
</li><li>
<p>Added better exception error when unknown column types are used with
migrations #1814 [fbeausoleil@ftml.net]</p>
</li><li>
<p>Fixed “connection lost” issue with the bundled Ruby/MySQL driver (would
kill the app after 8 hours of inactivity) #2163, #428 [kajism@yahoo.com]</p>
</li><li>
<p>Fixed comparison of Active Record objects so two new objects are not equal
#2099 [deberg]</p>
</li><li>
<p>Fixed that the SQL Server adapter would sometimes return DBI::Timestamp
objects instead of <a href="../../../classes/Time.html">Time</a> #2127 [Tom
Ward]</p>
</li><li>
<p>Added the instance methods root and ancestors on acts_as_tree and fixed
siblings to not include the current node #2142, #2140 [coffee2code]</p>
</li><li>
<p>Fixed that Active Record would call SHOW FIELDS twice (or more) for the
same model when the cached results were available #1947 [sd@notso.net]</p>
</li><li>
<p>Added log_level and use_silence parameter to <a
href="../../../classes/ActiveRecord/Base.html#method-c-benchmark">ActiveRecord::Base.benchmark</a>.
The first controls at what level the benchmark statement will be logged
(now as debug, instead of info) and the second that can be passed false to
include all logging statements during the benchmark block/</p>
</li><li>
<p>Make sure the schema_info table is created before querying the current
version #1903</p>
</li><li>
<p><a href="../../../classes/Fixtures.html">Fixtures</a> ignore table name
prefix and suffix #1987 [Jakob S]</p>
</li><li>
<p>Add documentation for index_type argument to add_index method for
migrations #2005 [blaine@odeo.com]</p>
</li><li>
<p>Modify read_attribute to allow a symbol argument #2024 [Ken Kunz]</p>
</li><li>
<p>Make destroy return self #1913 [muehlheim at sebastian.kanthak.de]</p>
</li><li>
<p>Fix typo in validations documentation #1938 [court3nay]</p>
</li><li>
<p>Make acts_as_list work for insert_at(1) #1966 [hensleyl@papermountain.org]</p>
</li><li>
<p>Fix typo in count_by_sql documentation #1969 [Alexey Verkhovsky]</p>
</li><li>
<p>Allow add_column and create_table to specify NOT NULL #1712
[emptysands@gmail.com]</p>
</li><li>
<p>Fix create_table so that id column is implicitly added [Rick Olson]</p>
</li><li>
<p><a href="../../../classes/Default.html">Default</a> sequence names for
Oracle changed to #{table_name}_seq, which is the most commonly used
standard. In addition, a new method ActiveRecord::Base#set_sequence_name
allows the developer to set the sequence name per model. This is a
non-backwards-compatible change -- anyone using the old-style
"rails_sequence" will need to either create new sequences, or set: <a
href="../../../classes/ActiveRecord/Base.html#method-c-set_sequence_name">ActiveRecord::Base.set_sequence_name</a>
= "rails_sequence" #1798</p>
</li><li>
<p>OCIAdapter now properly handles synonyms, which are commonly used to
separate out the schema owner from the application user #1798</p>
</li><li>
<p>Fixed the handling of camelCase columns names in Oracle #1798</p>
</li><li>
<p>Implemented for OCI the <a
href="../actionmailer/Rakefile.html">Rakefile</a> tasks of
:clone_structure_to_test, :db_structure_dump, and :purge_test_database,
which enable Oracle folks to enjoy all the agile goodness of <a
href="../../../classes/Rails.html">Rails</a> for testing. Note that the
current implementation is fairly limited – only tables and sequences are
cloned, not constraints or indexes. <a href="../../../classes/A.html">A</a>
full clone in Oracle generally requires some manual effort, and is
version-specific. <a href="../../../classes/Post.html">Post</a> 9i, Oracle
recommends the use of the DBMS_METADATA package, though that approach
requires editing of the physical characteristics generated #1798</p>
</li><li>
<p>Fixed the handling of multiple blob columns in Oracle if one or more of
them are null #1798</p>
</li><li>
<p>Added support for calling constrained class methods on has_many and
has_and_belongs_to_many collections #1764 [Tobias Luetke]</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Comment</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">AR</span>:<span class="ruby-constant">B</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">search</span>(<span class="ruby-identifier">q</span>)
    <span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-string">&quot;body = ?&quot;</span>, <span class="ruby-identifier">q</span>])
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span> 

<span class="ruby-keyword">class</span> <span class="ruby-constant">Post</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">AR</span>:<span class="ruby-constant">B</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">comments</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">Post</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">search</span>(<span class="ruby-string">'hi'</span>) <span class="ruby-comment"># =&gt; SELECT * from comments WHERE post_id = 1 AND body = 'hi'</span>
</pre>

<p>NOTICE: This patch changes the underlying SQL generated by
has_and_belongs_to_many queries. If your relying on that, such as by
explicitly referencing the old t and j aliases, you’ll need to update your
code. Of course, you _shouldn’t_ be relying on details like that no less
than you should be diving in to touch private variables. But just in case
you do, consider yourself noticed :)</p>
</li><li>
<p>Added migration support for SQLite (using temporary tables to simulate
ALTER TABLE) #1771 [Sam Stephenson]</p>
</li><li>
<p>Remove extra definition of supports_migrations? from abstract_adaptor.rb
[Nicholas Seckar]</p>
</li><li>
<p>Fix acts_as_list so that moving next-to-last item to the bottom does not
result in duplicate item positions</p>
</li><li>
<p>Fixed incompatibility in <a href="../../../classes/DB2.html">DB2</a>
adapter with the new limit/offset approach #1718 [Maik Schmidt]</p>
</li><li>
<p>Added :select option to find which can specify a different value than the
default *, like find(:all, :select =&gt; “first_name, last_name”), if you
either only want to select part of the columns or exclude columns otherwise
included from a join #1338 [Stefan Kaes]</p>
</li></ul>

<p><strong>1.11.1</strong> (11 July, 2005)</p>
<ul><li>
<p>Added support for limit and offset with eager loading of has_one and
belongs_to associations. Using the options with has_many and
has_and_belongs_to_many associations will now raise an
ActiveRecord::ConfigurationError #1692 [Rick Olsen]</p>
</li><li>
<p>Fixed that assume_bottom_position (in acts_as_list) could be called on
items already last in the list and they would move one position away from
the list #1648 [tyler@kianta.com]</p>
</li><li>
<p>Added ActiveRecord::Base.threaded_connections flag to turn off 1-connection
per thread (required for thread safety). By default it’s on, but WEBrick in
<a href="../../../classes/Rails.html">Rails</a> need it off #1685 [Sam
Stephenson]</p>
</li><li>
<p>Correct reflected table name for singular associations.  #1688
[court3nay@gmail.com]</p>
</li><li>
<p>Fixed optimistic locking with SQL Server #1660 [tom@popdog.net]</p>
</li><li>
<p>Added ActiveRecord::Migrator.migrate that can figure out whether to go up
or down based on the target version and the current</p>
</li><li>
<p>Added better error message for “packets out of order” #1630 [courtenay]</p>
</li><li>
<p>Fixed first run of “rake migrate” on PostgreSQL by not expecting a return
value on the id #1640</p>
</li></ul>

<p><strong>1.11.0</strong> (6 July, 2005)</p>
<ul><li>
<p>Fixed that Yaml error message in fixtures hid the real error #1623
[Nicholas Seckar]</p>
</li><li>
<p>Changed logging of SQL statements to use the DEBUG level instead of INFO</p>
</li><li>
<p>Added new Migrations framework for describing schema transformations in a
way that can be easily applied across multiple databases #1604 [Tobias
Luetke] See documentation under <a
href="../../../classes/ActiveRecord/Migration.html">ActiveRecord::Migration</a>
and the additional support in the <a
href="../../../classes/Rails.html">Rails</a> rakefile/generator.</p>
</li><li>
<p>Added callback hooks to association collections #1549 [Florian Weber].
Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Project</span>
  <span class="ruby-identifier">has_and_belongs_to_many</span> :<span class="ruby-identifier">developers</span>, :<span class="ruby-identifier">before_add</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">evaluate_velocity</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">evaluate_velocity</span>(<span class="ruby-identifier">developer</span>)
    <span class="ruby-operator">...</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>..raising an exception will cause the object not to be added (or removed,
with before_remove).</p>
</li><li>
<p>Fixed Base.content_columns call for SQL Server adapter #1450 [DeLynn Berry]</p>
</li><li>
<p>Fixed Base#write_attribute to work with both symbols and strings #1190
[Paul Legato]</p>
</li><li>
<p>Fixed that has_and_belongs_to_many didn’t respect single table inheritance
types #1081 [Florian Weber]</p>
</li><li>
<p>Speed up ActiveRecord#method_missing for the common case (read_attribute).</p>
</li><li>
<p>Only notify observers on after_find and after_initialize if these methods
are defined on the model.  #1235 [skaes@web.de]</p>
</li><li>
<p>Fixed that single-table inheritance sub-classes couldn’t be used to limit
the result set with eager loading #1215 [Chris McGrath]</p>
</li><li>
<p>Fixed validates_numericality_of to work with overrided getter-method when
:allow_nil is on #1316 [raidel@onemail.at]</p>
</li><li>
<p>Added roots, root, and siblings to the batch of methods added by
acts_as_tree #1541 [michael@schuerig.de]</p>
</li><li>
<p>Added support for limit/offset with the MS SQL Server driver so that
pagination will now work #1569 [DeLynn Berry]</p>
</li><li>
<p>Added support for ODBC connections to MS SQL Server so you can connect from
a non-Windows machine #1569 [Mark Imbriaco/DeLynn Berry]</p>
</li><li>
<p>Fixed that multiparameter posts ignored attr_protected #1532
[alec+rails@veryclever.net]</p>
</li><li>
<p>Fixed problem with eager loading when using a has_and_belongs_to_many
association using :association_foreign_key #1504
[flash@vanklinkenbergsoftware.nl]</p>
</li><li>
<p>Fixed Base#find to honor the documentation on how :joins work and make them
consistent with Base#count #1405 [pritchie@gmail.com]. What used to be:</p>

<pre class="ruby"><span class="ruby-constant">Developer</span>.<span class="ruby-identifier">find</span> :<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">joins</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'developers_projects'</span>, :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'id=developer_id AND project_id=1'</span>
</pre>

<p>…should instead be:</p>

<pre class="ruby"><span class="ruby-constant">Developer</span>.<span class="ruby-identifier">find</span>(
  :<span class="ruby-identifier">all</span>, 
  :<span class="ruby-identifier">joins</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'LEFT JOIN developers_projects ON developers.id = developers_projects.developer_id'</span>, 
  :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'project_id=1'</span>
)
</pre>
</li><li>
<p>Fixed that validations didn’t respecting custom setting for too_short,
too_long messages #1437 [Marcel Molina]</p>
</li><li>
<p>Fixed that clear_association_cache doesn’t delete new associations on new
records (so you can safely place new records in the session with Action
Pack without having new associations wiped) #1494 [cluon]</p>
</li><li>
<p>Fixed that calling Model.find([]) returns [] and doesn’t throw an exception
#1379</p>
</li><li>
<p>Fixed that adding a record to a has_and_belongs_to collection would always
save it – now it only saves if its a new record #1203 [Alisdair McDiarmid]</p>
</li><li>
<p>Fixed saving of in-memory association structures to happen as a
after_create/after_update callback instead of after_save – that way you can
add new associations in after_create/after_update callbacks without getting
them saved twice</p>
</li><li>
<p>Allow any <a href="../../../classes/Enumerable.html">Enumerable</a>, not
just Array, to work as bind variables #1344 [Jeremy Kemper]</p>
</li><li>
<p>Added actual database-changing behavior to collection assigment for
has_many and has_and_belongs_to_many #1425 [Sebastian Kanthak]. Example:</p>

<pre class="ruby"><span class="ruby-identifier">david</span>.<span class="ruby-identifier">projects</span> = [<span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>), <span class="ruby-constant">Project</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;ActionWebSearch&quot;</span>)]
<span class="ruby-identifier">david</span>.<span class="ruby-identifier">save</span>
</pre>

<p>If david.projects already contain the project with ID 1, this is left
unchanged. Any other projects are dropped. And the new project is saved
when david.save is called.</p>

<p>Also included is a way to do assignments through IDs, which is perfect for
checkbox updating, so you get to do:</p>

<pre>david.project_ids = [1, 5, 7]</pre>
</li><li>
<p>Corrected typo in find SQL for has_and_belongs_to_many.  #1312
[ben@bensinclair.com]</p>
</li><li>
<p>Fixed sanitized conditions for has_many finder method.  #1281
[jackc@hylesanderson.com, pragdave, Tobias Luetke]</p>
</li><li>
<p>Comprehensive PostgreSQL schema support.  Use the optional
schema_search_path directive in database.yml to give a comma-separated list
of schemas to search for your tables.  This allows you, for example, to
have tables in a shared schema without having to use a custom table name. 
See <a
href="http://www.postgresql.org/docs/8.0/interactive/ddl-schemas.html">www.postgresql.org/docs/8.0/interactive/ddl-schemas.html</a>
to learn more.  #827 [dave@cherryville.org]</p>
</li><li>
<p>Corrected @@configurations typo #1410 [david@ruppconsulting.com]</p>
</li><li>
<p>Return PostgreSQL columns in the order they were declared #1374
[perlguy@gmail.com]</p>
</li><li>
<p>Allow before/after update hooks to work on models using optimistic locking</p>
</li><li>
<p>Eager loading of dependent has_one associations won’t delete the
association #1212</p>
</li><li>
<p>Added a second parameter to the build and create method for has_one that
controls whether the existing association should be replaced (which means
nullifying its foreign key as well). By default this is true, but false can
be passed to prevent it.</p>
</li><li>
<p>Using transactional fixtures now causes the data to be loaded only once.</p>
</li><li>
<p>Added fixture accessor methods that can be used when instantiated fixtures
are disabled.</p>

<pre class="ruby"><span class="ruby-identifier">fixtures</span> :<span class="ruby-identifier">web_sites</span>

<span class="ruby-keyword">def</span> <span class="ruby-identifier">test_something</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-string">&quot;Ruby on Rails&quot;</span>, <span class="ruby-identifier">web_sites</span>(:<span class="ruby-identifier">rubyonrails</span>).<span class="ruby-identifier">name</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Added DoubleRenderError exception that’ll be raised if render* is called
twice #518 [Nicholas Seckar]</p>
</li><li>
<p>Fixed exceptions occuring after render has been called #1096 [Nicholas
Seckar]</p>
</li><li>
<p>CHANGED: validates_presence_of now uses Errors#add_on_blank, which will
make “  ” fail the validation where it didn’t before #1309</p>
</li><li>
<p>Added Errors#add_on_blank which works like Errors#add_on_empty, but uses <a
href="../../../classes/Object.html#method-i-blank-3F">Object#blank?</a>
instead</p>
</li><li>
<p>Added the :if option to all validations that can either use a block or a
method pointer to determine whether the validation should be run or not.
#1324 [Duane Johnson/jhosteny]. Examples:</p>

<p>Conditional validations such as the following are made possible:</p>

<pre class="ruby"><span class="ruby-identifier">validates_numericality_of</span> :<span class="ruby-identifier">income</span>, :<span class="ruby-keyword">if</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">employed?</span>
</pre>

<p>Conditional validations can also solve the salted login generator problem:</p>

<pre class="ruby"><span class="ruby-identifier">validates_confirmation_of</span> :<span class="ruby-identifier">password</span>, :<span class="ruby-keyword">if</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">new_password?</span>
</pre>

<p>Using blocks:</p>

<pre class="ruby"><span class="ruby-identifier">validates_presence_of</span> :<span class="ruby-identifier">username</span>, :<span class="ruby-keyword">if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">user</span><span class="ruby-operator">|</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">signup_step</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> }
</pre>
</li><li>
<p>Fixed use of construct_finder_sql when using :join #1288 [dwlt@dwlt.net]</p>
</li><li>
<p>Fixed that :delete_sql in has_and_belongs_to_many associations couldn’t
access record properties #1299 [Rick Olson]</p>
</li><li>
<p>Fixed that clone would break when an aggregate had the same name as one of
its attributes #1307 [Jeremy Kemper]</p>
</li><li>
<p>Changed that destroying an object will only freeze the attributes hash,
which keeps the object from having attributes changed (as that wouldn’t
make sense), but allows for the querying of associations after it has been
destroyed.</p>
</li><li>
<p>Changed the callbacks such that observers are notified before the in-object
callbacks are triggered. Without this change, it wasn’t possible to act on
the whole object in something like a before_destroy observer without having
the objects own callbacks (like deleting associations) called first.</p>
</li><li>
<p>Added option for passing an array to the find_all version of the dynamic
finders and have it evaluated as an IN fragment. Example:</p>

<pre># SELECT * FROM topics WHERE title IN ('First', 'Second')
Topic.find_all_by_title([&quot;First&quot;, &quot;Second&quot;])</pre>
</li><li>
<p>Added compatibility with camelCase column names for dynamic finders #533
[Dee.Zsombor]</p>
</li><li>
<p>Fixed extraneous comma in count() function that made it not work with joins
#1156 [jarkko/Dee.Zsombor]</p>
</li><li>
<p>Fixed incompatibility with Base#find with an array of ids that would fail
when using eager loading #1186 [Alisdair McDiarmid]</p>
</li><li>
<p>Fixed that validate_length_of lost :on option when :within was specified
#1195 [jhosteny@mac.com]</p>
</li><li>
<p>Added encoding and min_messages options for PostgreSQL #1205 [shugo].
Configuration example:</p>

<pre>development:
  adapter: postgresql
  database: rails_development
  host: localhost
  username: postgres
  password:
  encoding: UTF8
  min_messages: ERROR</pre>
</li><li>
<p>Fixed acts_as_list where deleting an item that was removed from the list
would ruin the positioning of other list items #1197 [Jamis Buck]</p>
</li><li>
<p>Added validates_exclusion_of as a negative of validates_inclusion_of</p>
</li><li>
<p>Optimized counting of has_many associations by setting the association to
empty if the count is 0 so repeated calls doesn’t trigger database calls</p>
</li></ul>

<p><strong>1.10.1</strong> (20th April, 2005)</p>
<ul><li>
<p>Fixed frivilous database queries being triggered with eager loading on
empty associations and other things</p>
</li><li>
<p>Fixed order of loading in eager associations</p>
</li><li>
<p>Fixed stray comma when using eager loading and ordering together from
has_many associations #1143</p>
</li></ul>

<p><strong>1.10.0</strong> (19th April, 2005)</p>
<ul><li>
<p>Added eager loading of associations as a way to solve the N+1 problem more
gracefully without piggy-back queries. Example:</p>

<pre class="ruby"><span class="ruby-keyword">for</span> <span class="ruby-identifier">post</span> <span class="ruby-keyword">in</span> <span class="ruby-constant">Post</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">100</span>)
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Post:            &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">title</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Written by:      &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author</span>.<span class="ruby-identifier">name</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Last comment on: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">created_on</span>
<span class="ruby-keyword">end</span>
</pre>

<p>This used to generate 301 database queries if all 100 posts had both author
and comments. It can now be written as:</p>

<pre class="ruby"><span class="ruby-keyword">for</span> <span class="ruby-identifier">post</span> <span class="ruby-keyword">in</span> <span class="ruby-constant">Post</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">100</span>, :<span class="ruby-identifier">include</span> =<span class="ruby-operator">&gt;</span> [ :<span class="ruby-identifier">author</span>, :<span class="ruby-identifier">comments</span> ])
</pre>

<p>…and the number of database queries needed is now 1.</p>
</li><li>
<p>Added new unified Base.find API and deprecated the use of find_first and
find_all. See the documentation for Base.find. Examples:</p>

<pre class="ruby"><span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>, :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;administrator = 1&quot;</span>, :<span class="ruby-identifier">order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;created_on DESC&quot;</span>)
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>, <span class="ruby-value">5</span>, <span class="ruby-value">6</span>, :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;administrator = 1&quot;</span>, :<span class="ruby-identifier">order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;created_on DESC&quot;</span>)
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">first</span>, :<span class="ruby-identifier">order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;created_on DESC&quot;</span>, :<span class="ruby-identifier">offset</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>)
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">conditions</span> =<span class="ruby-operator">&gt;</span> [ <span class="ruby-string">&quot;category IN (?)&quot;</span>, <span class="ruby-identifier">categories</span>], :<span class="ruby-identifier">limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">50</span>)
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(:<span class="ruby-identifier">all</span>, :<span class="ruby-identifier">offset</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>, :<span class="ruby-identifier">limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>)
</pre>
</li><li>
<p>Added acts_as_nested_set #1000 [wschenk]. Introduction:</p>

<pre>This acts provides Nested Set functionality.  Nested Set is similiar to Tree, but with
the added feature that you can select the children and all of it's descendants with
a single query.  A good use case for this is a threaded post system, where you want
to display every reply to a comment without multiple selects.</pre>
</li><li>
<p>Added Base.save! that attempts to save the record just like Base.save but
will raise a RecordInvalid exception instead of returning false if the
record is not valid [After much pestering from Dave Thomas]</p>
</li><li>
<p>Fixed PostgreSQL usage of fixtures with regards to public schemas and table
names with dots #962 [gnuman1@gmail.com]</p>
</li><li>
<p>Fixed that fixtures were being deleted in the same order as inserts causing
FK errors #890 [gmail at andrew.john.peters.com]</p>
</li><li>
<p>Fixed loading of fixtures in to be in the right order (or PostgreSQL would
bark) #1047 [stephenh@chase3000.com]</p>
</li><li>
<p>Fixed page caching for non-vhost applications living underneath the root
#1004 [Ben Schumacher]</p>
</li><li>
<p>Fixes a problem with the SQL Adapter which was resulting in IDENTITY_INSERT
not being set to ON when it should be #1104 [adelle]</p>
</li><li>
<p>Added the option to specify the acceptance string in
validates_acceptance_of #1106 [caleb@aei-tech.com]</p>
</li><li>
<p>Added insert_at(position) to acts_as_list #1083 [DeLynnB]</p>
</li><li>
<p>Removed the default order by id on has_and_belongs_to_many queries as it
could kill performance on large sets (you can still specify by hand with
:order)</p>
</li><li>
<p>Fixed that Base.silence should restore the old logger level when done, not
just set it to DEBUG #1084 [yon@milliped.com]</p>
</li><li>
<p>Fixed boolean saving on Oracle #1093 [mparrish@pearware.org]</p>
</li><li>
<p>Moved build_association and create_association for has_one and belongs_to
out of deprecation as they work when the association is nil unlike
association.build and association.create, which require the association to
be already in place #864</p>
</li><li>
<p>Added rollbacks of transactions if they’re active as the dispatcher is
killed gracefully (TERM signal) #1054 [Leon Bredt]</p>
</li><li>
<p>Added quoting of column names for fixtures #997 [jcfischer@gmail.com]</p>
</li><li>
<p>Fixed counter_sql when no records exist in database for PostgreSQL (would
give error, not 0) #1039 [Caleb Tennis]</p>
</li><li>
<p>Fixed that benchmarking times for rendering included db runtimes #987
[skaes@web.de]</p>
</li><li>
<p>Fixed boolean queries for t/f fields in PostgreSQL #995
[dave@cherryville.org]</p>
</li><li>
<p>Added that model.items.delete(child) will delete the child, not just set
the foreign key to nil, if the child is dependent on the model #978 [Jeremy
Kemper]</p>
</li><li>
<p>Fixed auto-stamping of dates (created_on/updated_on) for PostgreSQL #985
[dave@cherryville.org]</p>
</li><li>
<p>Fixed Base.silence/benchmark to only log if a logger has been configured
#986 [skaes@web.de]</p>
</li><li>
<p>Added a join parameter as the third argument to Base.find_first and as the
second to Base.count #426, #988 [skaes@web.de]</p>
</li><li>
<p>Fixed bug in Base#hash method that would treat records with the same
string-based id as different [Dave Thomas]</p>
</li><li>
<p>Renamed DateHelper#distance_of_time_in_words_to_now to
DateHelper#time_ago_in_words (old method name is still available as a
deprecated alias)</p>
</li></ul>

<p><strong>1.9.1</strong> (27th March, 2005)</p>
<ul><li>
<p>Fixed that Active Record objects with float attribute could not be cloned
#808</p>
</li><li>
<p>Fixed that MissingSourceFile’s wasn’t properly detected in production mode
#925 [Nicholas Seckar]</p>
</li><li>
<p>Fixed that :counter_cache option would look for a line_items_count column
for a LineItem object instead of lineitems_count</p>
</li><li>
<p>Fixed that AR exists?() would explode on postgresql if the passed id did
not match the PK type #900 [Scott Barron]</p>
</li><li>
<p>Fixed the MS SQL adapter to work with the new limit/offset approach and
with binary data (still suffering from 7KB limit, though) #901 [delynnb]</p>
</li></ul>

<p><strong>1.9.0</strong> (22th March, 2005)</p>
<ul><li>
<p>Added adapter independent limit clause as a two-element array with the
first being the limit, the second being the offset #795 [Sam Stephenson].
Example:</p>

<pre>Developer.find_all nil, 'id ASC', 5      # return the first five developers 
Developer.find_all nil, 'id ASC', [3, 8] # return three developers, starting from #8 and forward</pre>

<p>This doesn’t yet work with the <a href="../../../classes/DB2.html">DB2</a>
or MS SQL adapters. Patches to make that happen are encouraged.</p>
</li><li>
<p>Added alias_method :to_param, :id to Base, such that Active Record objects
to be used as URL parameters in Action Pack automatically #812 [Nicholas
Seckar/Sam Stephenson]</p>
</li><li>
<p>Improved the performance of the OCI8 adapter for Oracle #723
[pilx/gjenkins]</p>
</li><li>
<p>Added type conversion before saving a record, so string-based values like
“10.0” aren’t left for the database to convert #820 [dave@cherryville.org]</p>
</li><li>
<p>Added with additional settings for working with transactional fixtures and
pre-loaded test databases #865 [mindel]</p>
</li><li>
<p>Fixed acts_as_list to trigger remove_from_list on destroy after the fact,
not before, so a unique position can be maintained #871 [Alisdair
McDiarmid]</p>
</li><li>
<p>Added the possibility of specifying fixtures in multiple calls #816
[kim@tinker.com]</p>
</li><li>
<p>Added Base.exists?(id) that’ll return true if an object of the class with
the given id exists #854 [stian@grytoyr.net]</p>
</li><li>
<p>Added optionally allow for nil or empty strings with
validates_numericality_of #801 [Sebastian Kanthak]</p>
</li><li>
<p>Fixed problem with using slashes in validates_format_of regular expressions
#801 [Sebastian Kanthak]</p>
</li><li>
<p>Fixed that SQLite3 exceptions are caught and reported properly #823
[yerejm]</p>
</li><li>
<p>Added that all types of after_find/after_initialized callbacks are
triggered if the explicit implementation is present, not only the explicit
implementation itself</p>
</li><li>
<p>Fixed that symbols can be used on attribute assignment, like
page.emails.create(:subject =&gt; data.subject, :body =&gt; data.body)</p>
</li></ul>

<p><strong>1.8.0</strong> (7th March, 2005)</p>
<ul><li>
<p>Added ActiveRecord::Base.colorize_logging to control whether to use colors
in logs or not (on by default)</p>
</li><li>
<p>Added support for timestamp with time zone in PostgreSQL #560 [Scott
Barron]</p>
</li><li>
<p>Added MultiparameterAssignmentErrors and AttributeAssignmentError
exceptions #777 [demetrius]. Documentation:</p>

<pre>* +MultiparameterAssignmentErrors+ -- collection of errors that occurred during a mass assignment using the 
  +attributes=+ method. The +errors+ property of this exception contains an array of +AttributeAssignmentError+ 
  objects that should be inspected to determine which attributes triggered the errors.
* +AttributeAssignmentError+ -- an error occurred while doing a mass assignment through the +attributes=+ method.
  You can inspect the +attribute+ property of the exception object to determine which attribute triggered the error.</pre>
</li><li>
<p>Fixed that postgresql adapter would fails when reading bytea fields with
null value #771 [rodrigo k]</p>
</li><li>
<p>Added transactional fixtures that uses rollback to undo changes to fixtures
instead of DELETE/INSERT – it’s much faster. See documentation under <a
href="../../../classes/Fixtures.html">Fixtures</a> #760 [Jeremy Kemper]</p>
</li><li>
<p>Added destruction of dependent objects in has_one associations when a new
assignment happens #742 [mindel]. Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Account</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_one</span> :<span class="ruby-identifier">credit_card</span>, :<span class="ruby-identifier">dependent</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span>
<span class="ruby-keyword">class</span> <span class="ruby-constant">CreditCard</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">account</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">account</span>.<span class="ruby-identifier">credit_card</span> <span class="ruby-comment"># =&gt; returns existing credit card, lets say id = 12</span>
<span class="ruby-identifier">account</span>.<span class="ruby-identifier">credit_card</span> = <span class="ruby-constant">CreditCard</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;number&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;123&quot;</span>)
<span class="ruby-identifier">account</span>.<span class="ruby-identifier">save</span> <span class="ruby-comment"># =&gt; CC with id = 12 is destroyed</span>
</pre>
</li><li>
<p>Added validates_numericality_of #716 [skanthak/c.r.mcgrath]. Docuemntation:</p>

<pre class="ruby"><span class="ruby-constant">Validates</span> <span class="ruby-identifier">whether</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">value</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">specified</span> <span class="ruby-identifier">attribute</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">numeric</span> <span class="ruby-identifier">by</span> <span class="ruby-identifier">trying</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">convert</span> <span class="ruby-identifier">it</span> <span class="ruby-identifier">to</span>
<span class="ruby-identifier">a</span> <span class="ruby-identifier">float</span> <span class="ruby-identifier">with</span> <span class="ruby-constant">Kernel</span>.<span class="ruby-constant">Float</span> (<span class="ruby-keyword">if</span> <span class="ruby-operator">&lt;</span><span class="ruby-identifier">tt</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">integer</span><span class="ruby-operator">&lt;</span><span class="ruby-regexp">%rtt&gt; is false) or applying it to the regular expression
&lt;tt&gt;/</span><span class="ruby-operator">^</span>[\<span class="ruby-operator">+</span>\<span class="ruby-operator">-</span>]<span class="ruby-operator">?</span>\<span class="ruby-identifier">d</span><span class="ruby-operator">+</span><span class="ruby-identifier">$/</span><span class="ruby-operator">&lt;</span><span class="ruby-regexp">%rtt&gt; (if &lt;tt&gt;integer&lt;/</span><span class="ruby-identifier">tt</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">set</span> <span class="ruby-identifier">to</span> <span class="ruby-keyword">true</span>).

  <span class="ruby-identifier">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
    <span class="ruby-identifier">validates_numericality_of</span> :<span class="ruby-identifier">value</span>, :<span class="ruby-identifier">on</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">create</span>
  <span class="ruby-keyword">end</span>

<span class="ruby-constant">Configuration</span> <span class="ruby-identifier">options</span><span class="ruby-operator">:</span>
* <span class="ruby-operator">&lt;</span><span class="ruby-identifier">tt</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">message</span><span class="ruby-operator">&lt;</span><span class="ruby-regexp">%rtt&gt; - A custom error message (default is: &quot;is not a number&quot;)
* &lt;tt&gt;on&lt;/</span><span class="ruby-identifier">tt</span><span class="ruby-operator">&gt;</span> <span class="ruby-constant">Specifies</span> <span class="ruby-keyword">when</span> <span class="ruby-identifier">this</span> <span class="ruby-identifier">validation</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">active</span> (<span class="ruby-identifier">default</span> <span class="ruby-identifier">is</span> :<span class="ruby-identifier">save</span>, <span class="ruby-identifier">other</span> <span class="ruby-identifier">options</span> :<span class="ruby-identifier">create</span>, :<span class="ruby-identifier">update</span>)
* <span class="ruby-operator">&lt;</span><span class="ruby-identifier">tt</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">only_integer</span><span class="ruby-operator">&lt;</span><span class="ruby-regexp">%rtt&gt; Specifies whether the value has to be an integer, e.g. an integral value (default is false)
</span></pre>
</li><li>
<p>Fixed that HasManyAssociation#count was using :finder_sql rather than
:counter_sql if it was available #445 [Scott Barron]</p>
</li><li>
<p>Added better defaults for composed_of, so statements like composed_of
:time_zone, :mapping =&gt; %w( time_zone time_zone ) can be written without
the mapping part (it’s now assumed)</p>
</li><li>
<p>Added MacroReflection#macro which will return a symbol describing the macro
used (like :composed_of or :has_many) #718, #248 [james@slashetc.com]</p>
</li></ul>

<p><strong>1.7.0</strong> (24th February, 2005)</p>
<ul><li>
<p>Changed the auto-timestamping feature to use
ActiveRecord::Base.default_timezone instead of entertaining the parallel
ActiveRecord::Base.timestamps_gmt method. The latter is now deprecated and
will throw a warning on use (but still work) #710 [Jamis Buck]</p>
</li><li>
<p>Added a OCI8-based Oracle adapter that has been verified to work with
Oracle 8 and 9 #629 [Graham Jenkins]. Usage notes:</p>

<pre>1.  Key generation uses a sequence &quot;rails_sequence&quot; for all tables. (I couldn't find a simple
    and safe way of passing table-specific sequence information to the adapter.)
2.  Oracle uses DATE or TIMESTAMP datatypes for both dates and times. Consequently I have had to
    resort to some hacks to get data converted to Date or Time in Ruby.
    If the column_name ends in _at (like created_at, updated_at) it's created as a Ruby Time. Else if the
    hours/minutes/seconds are 0, I make it a Ruby Date. Else it's a Ruby Time.
    This is nasty - but if you use Duck Typing you'll probably not care very much.
    In 9i it's tempting to map DATE to Date and TIMESTAMP to Time but I don't think that is
    valid - too many databases use DATE for both.
    Timezones and sub-second precision on timestamps are not supported.
3.  Default values that are functions (such as &quot;SYSDATE&quot;) are not supported. This is a
    restriction of the way active record supports default values.
4.  Referential integrity constraints are not fully supported. Under at least
    some circumstances, active record appears to delete parent and child records out of
    sequence and out of transaction scope. (Or this may just be a problem of test setup.)</pre>

<p>The OCI8 driver can be retrieved from <a
href="http://rubyforge.org/projects/ruby-oci8/">rubyforge.org/projects/ruby-oci8/</a></p>
</li><li>
<p>Added option :schema_order to the PostgreSQL adapter to support the use of
multiple schemas per database #697 [YuriSchimke]</p>
</li><li>
<p>Optimized the SQL used to generate has_and_belongs_to_many queries by
listing the join table first #693 [yerejm]</p>
</li><li>
<p>Fixed that when using validation macros with a custom message, if you
happened to use single quotes in the message string you would get a parsing
error #657 [tonka]</p>
</li><li>
<p>Fixed that Active Record would throw Broken Pipe errors with <a
href="../../../classes/FCGI.html">FCGI</a> when the MySQL connection timed
out instead of reconnecting #428 [Nicholas Seckar]</p>
</li><li>
<p>Added options to specify an SSL connection for MySQL. Define the following
attributes in the connection config (config/database.yml in <a
href="../../../classes/Rails.html">Rails</a>) to use it: sslkey, sslcert,
sslca, sslcapath, sslcipher. To use SSL with no client certs, just set
:sslca = ‘/dev/null’. <a
href="http://dev.mysql.com/doc/mysql/en/secure-connections.html">dev.mysql.com/doc/mysql/en/secure-connections.html</a>
#604 [daniel@nightrunner.com]</p>
</li><li>
<p>Added automatic dropping/creating of test tables for running the unit tests
on all databases #587 [adelle@bullet.net.au]</p>
</li><li>
<p>Fixed that find_by_* would fail when column names had numbers #670
[demetrius]</p>
</li><li>
<p>Fixed the SQL Server adapter on a bunch of issues #667 [DeLynn]</p>

<pre class="ruby"><span class="ruby-value">1</span>. <span class="ruby-constant">Created</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">new</span> <span class="ruby-identifier">columns</span> <span class="ruby-identifier">method</span> <span class="ruby-identifier">that</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">much</span> <span class="ruby-identifier">cleaner</span>. 
<span class="ruby-value">2</span>. <span class="ruby-constant">Corrected</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">problem</span> <span class="ruby-identifier">with</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">select</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">select_all</span> <span class="ruby-identifier">methods</span> 
   <span class="ruby-identifier">that</span> <span class="ruby-identifier">didn</span><span class="ruby-string">'t account for the LIMIT clause being passed into raw SQL statements. 
3. Implemented the string_to_time method in order to create proper instances of the time class. 
4. Added logic to the simplified_type method that allows the database to specify the scale of float data. 
5. Adjusted the quote_column_name to account for the fact that MS SQL is bothered by a forward slash in the data string.
</span></pre>
</li><li>
<p>Fixed that the dynamic finder like find_all_by_something_boolean(false)
didn’t work #649 [lmarlow@yahoo.com]</p>
</li><li>
<p>Added validates_each that validates each specified attribute against a
block #610 [Jeremy Kemper]. Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_each</span> :<span class="ruby-identifier">first_name</span>, :<span class="ruby-identifier">last_name</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span> <span class="ruby-identifier">attr</span>, <span class="ruby-string">'starts with z.'</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">attr</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">zz</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Added :allow_nil as an explicit option for validates_length_of, so unless
that’s set to true having the attribute as nil will also return an error if
a range is specified as :within #610 [Jeremy Kemper]</p>
</li><li>
<p>Added that validates_* now accept blocks to perform validations #618 [Tim
Bates]. Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validate</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">person</span><span class="ruby-operator">|</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-string">&quot;title&quot;</span>, <span class="ruby-string">&quot;will never be valid&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-constant">SHOULD_NEVER_BE_VALID</span> }
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Addded validation for validate all the associated objects before declaring
failure with validates_associated #618 [Tim Bates]</p>
</li><li>
<p>Added keyword-style approach to defining the custom relational bindings
#545 [Jamis Buck]. Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Project</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">primary_key</span> <span class="ruby-string">&quot;sysid&quot;</span>
  <span class="ruby-identifier">table_name</span> <span class="ruby-string">&quot;XYZ_PROJECT&quot;</span>
  <span class="ruby-identifier">inheritance_column</span> { <span class="ruby-identifier">original_inheritance_column</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;_id&quot;</span> }
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Fixed Base#clone for use with PostgreSQL #565 [hanson@surgery.wisc.edu]</p>
</li></ul>

<p><strong>1.6.0</strong> (January 25th, 2005)</p>
<ul><li>
<p>Added that has_many association build and create methods can take arrays of
record data like Base#create and Base#build to build/create multiple
records at once.</p>
</li><li>
<p>Added that Base#delete and Base#destroy both can take an array of ids to
delete/destroy #336</p>
</li><li>
<p>Added the option of supplying an array of attributes to Base#create, so
that multiple records can be created at once.</p>
</li><li>
<p>Added the option of supplying an array of ids and attributes to
Base#update, so that multiple records can be updated at once (inspired by
#526/Duane Johnson). Example</p>

<pre class="ruby"><span class="ruby-identifier">people</span> = { <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-string">&quot;first_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;David&quot;</span> }, <span class="ruby-value">2</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-string">&quot;first_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Jeremy&quot;</span>} }
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">people</span>.<span class="ruby-identifier">keys</span>, <span class="ruby-identifier">people</span>.<span class="ruby-identifier">values</span>)
</pre>
</li><li>
<p>Added ActiveRecord::Base.timestamps_gmt that can be set to true to make the
automated timestamping use GMT instead of local time #520 [Scott Baron]</p>
</li><li>
<p>Added that update_all calls sanitize_sql on its updates argument, so stuff
like MyRecord.update_all([‘time = ?’, Time.now]) works #519 [notahat]</p>
</li><li>
<p>Fixed that the dynamic finders didn’t treat nil as a “IS NULL” but rather
“= NULL” case #515 [Demetrius]</p>
</li><li>
<p>Added bind-named arrays for interpolating a group of ids or strings in
conditions #528 [Jeremy Kemper]</p>
</li><li>
<p>Added that has_and_belongs_to_many associations with additional attributes
also can be created between unsaved objects and only committed to the
database when Base#save is called on the associator #524 [Eric Anderson]</p>
</li><li>
<p>Fixed that records fetched with piggy-back attributes or through rich
has_and_belongs_to_many associations couldn’t be saved due to the extra
attributes not part of the table #522 [Eric Anderson]</p>
</li><li>
<p>Added mass-assignment protection for the inheritance column – regardless of
a custom column is used or not</p>
</li><li>
<p>Fixed that association proxies would fail === tests like
PremiumSubscription === @account.subscription</p>
</li><li>
<p>Fixed that column aliases didn’t work as expected with the new MySql411
driver #507 [Demetrius]</p>
</li><li>
<p>Fixed that find_all would produce invalid sql when called sequentialy #490
[Scott Baron]</p>
</li></ul>

<p><strong>1.5.1</strong> (January 18th, 2005)</p>
<ul><li>
<p>Fixed that the belongs_to and has_one proxy would fail a test like ‘if
project.manager’ – this unfortunately also means that you can’t call
methods like project.manager.build unless there already is a manager on the
project #492 [Tim Bates]</p>
</li><li>
<p>Fixed that the Ruby/MySQL adapter wouldn’t connect if the password was
empty #503 [Pelle]</p>
</li></ul>

<p><strong>1.5.0</strong> (January 17th, 2005)</p>
<ul><li>
<p>Fixed that unit tests for MySQL are now run as the “rails” user instead of
root #455 [Eric Hodel]</p>
</li><li>
<p>Added validates_associated that enables validation of objects in an unsaved
association #398 [Tim Bates]. Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Book</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">pages</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">library</span>

  <span class="ruby-identifier">validates_associated</span> :<span class="ruby-identifier">pages</span>, :<span class="ruby-identifier">library</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Added support for associating unsaved objects #402 [Tim Bates]. Rules that
govern this addition:</p>

<pre>== Unsaved objects and associations

You can manipulate objects and associations before they are saved to the database, but there is some special behaviour you should be
aware of, mostly involving the saving of associated objects.

=== One-to-one associations

* Assigning an object to a has_one association automatically saves that object, and the object being replaced (if there is one), in
  order to update their primary keys - except if the parent object is unsaved (new_record? == true).
* If either of these saves fail (due to one of the objects being invalid) the assignment statement returns false and the assignment
  is cancelled.
* If you wish to assign an object to a has_one association without saving it, use the #association.build method (documented below).
* Assigning an object to a belongs_to association does not save the object, since the foreign key field belongs on the parent. It does
  not save the parent either.

=== Collections

* Adding an object to a collection (has_many or has_and_belongs_to_many) automatically saves that object, except if the parent object
  (the owner of the collection) is not yet stored in the database.
* If saving any of the objects being added to a collection (via #push or similar) fails, then #push returns false.
* You can add an object to a collection without automatically saving it by using the #collection.build method (documented below).
* All unsaved (new_record? == true) members of the collection are automatically saved when the parent is saved.</pre>
</li><li>
<p>Added replace to associations, so you can do
project.manager.replace(new_manager) or
project.milestones.replace(new_milestones) #402 [Tim Bates]</p>
</li><li>
<p>Added build and create methods to has_one and belongs_to associations, so
you can now do project.manager.build(attributes) #402 [Tim Bates]</p>
</li><li>
<p>Added that if a before_* callback returns false, all the later callbacks
and the associated action are cancelled. If an after_* callback returns
false, all the later callbacks are cancelled. Callbacks are generally run
in the order they are defined, with the exception of callbacks defined as
methods on the model, which are called last. #402 [Tim Bates]</p>
</li><li>
<p>Fixed that Base#== wouldn’t work for multiple references to the same
unsaved object #402 [Tim Bates]</p>
</li><li>
<p>Fixed binary support for PostgreSQL #444 [alex@byzantine.no]</p>
</li><li>
<p>Added a differenciation between AssociationCollection#size and -length. Now
AssociationCollection#size returns the size of the  collection by executing
a SELECT COUNT(*) query if the collection hasn’t been loaded and calling
collection.size if it has. If  it’s more likely than not that the
collection does have a size larger than zero and you need to fetch that
collection afterwards,  it’ll take one less SELECT query if you use length.</p>
</li><li>
<p>Added Base#attributes that returns a hash of all the attributes with their
names as keys and clones of their objects as values #433 [atyp.de]</p>
</li><li>
<p>Fixed that foreign keys named the same as the association would cause stack
overflow #437 [Eric Anderson]</p>
</li><li>
<p>Fixed default scope of acts_as_list from “1” to “1 = 1”, so it’ll work in
PostgreSQL (among other places) #427 [Alexey]</p>
</li><li>
<p>Added Base#reload that reloads the attributes of an object from the
database #422 [Andreas Schwarz]</p>
</li><li>
<p>Added SQLite3 compatibility through the sqlite3-ruby adapter by Jamis Buck
#381 [Jeremy Kemper]</p>
</li><li>
<p>Added support for the new protocol spoken by MySQL 4.1.1+ servers for the
Ruby/MySQL adapter that ships with <a
href="../../../classes/Rails.html">Rails</a> #440 [Matt Mower]</p>
</li><li>
<p>Added that Observers can use the observes class method instead of
overwriting self.observed_class().</p>

<pre class="ruby"><span class="ruby-constant">Before</span><span class="ruby-operator">:</span>
  <span class="ruby-keyword">class</span> <span class="ruby-constant">ListSweeper</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
    <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">observed_class</span>() [ <span class="ruby-constant">List</span>, <span class="ruby-constant">Item</span> ]
  <span class="ruby-keyword">end</span>

<span class="ruby-constant">After</span><span class="ruby-operator">:</span>
  <span class="ruby-keyword">class</span> <span class="ruby-constant">ListSweeper</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
    <span class="ruby-identifier">observes</span> <span class="ruby-constant">List</span>, <span class="ruby-constant">Item</span>
  <span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Fixed that conditions in has_many and has_and_belongs_to_many should be
interpolated just like the finder_sql is</p>
</li><li>
<p>Fixed Base#update_attribute to be indifferent to whether a string or symbol
is used to describe the name</p>
</li><li>
<p>Added Base#toggle(attribute) and Base#toggle!(attribute) that makes it
easier to flip a switch or flag.</p>

<pre>Before: topic.update_attribute(:approved, !approved?)
After : topic.toggle!(:approved)</pre>
</li><li>
<p>Added Base#increment!(attribute) and Base#decrement!(attribute) that also
saves the records. Example:</p>

<pre class="ruby"><span class="ruby-identifier">page</span>.<span class="ruby-identifier">views</span> <span class="ruby-comment"># =&gt; 1</span>
<span class="ruby-identifier">page</span>.<span class="ruby-identifier">increment!</span>(:<span class="ruby-identifier">views</span>) <span class="ruby-comment"># executes an UPDATE statement</span>
<span class="ruby-identifier">page</span>.<span class="ruby-identifier">views</span> <span class="ruby-comment"># =&gt; 2</span>

<span class="ruby-identifier">page</span>.<span class="ruby-identifier">increment</span>(:<span class="ruby-identifier">views</span>).<span class="ruby-identifier">increment!</span>(:<span class="ruby-identifier">views</span>)
<span class="ruby-identifier">page</span>.<span class="ruby-identifier">views</span> <span class="ruby-comment"># =&gt; 4</span>
</pre>
</li><li>
<p>Added Base#increment(attribute) and Base#decrement(attribute) that
encapsulates the += 1 and -= 1 patterns.</p>
</li></ul>

<p><strong>1.4.0</strong> (January 4th, 2005)</p>
<ul><li>
<p>Added automated optimistic locking if the field <code>lock_version</code>
is present.  Each update to the record increments the lock_version column
and the locking facilities ensure that records instantiated twice will let
the last one saved raise a StaleObjectError if the first was also updated.
Example:</p>

<pre>p1 = Person.find(1)
p2 = Person.find(1)

p1.first_name = &quot;Michael&quot;
p1.save

p2.first_name = &quot;should fail&quot;
p2.save # Raises a ActiveRecord::StaleObjectError</pre>

<p>You’re then responsible for dealing with the conflict by rescuing the
exception and either rolling back, merging, or otherwise apply the business
logic needed to resolve the conflict.</p>

<p>#384 [Michael Koziarski]</p>
</li><li>
<p>Added dynamic attribute-based finders as a cleaner way of getting objects
by simple queries without turning to SQL.  They work by appending the name
of an attribute to <code>find_by_</code>, so you get finders like
<code>Person.find_by_user_name, Payment.find_by_transaction_id</code>. So
instead of writing <code>Person.find_first([&quot;user_name = ?&quot;,
user_name])</code>, you just do
<code>Person.find_by_user_name(user_name)</code>.</p>

<p>It’s also possible to use multiple attributes in the same find by
separating them with “<em>and</em>”, so you get finders like
<code>Person.find_by_user_name_and_password</code> or even
<code>Payment.find_by_purchaser_and_state_and_country</code>. So instead of
writing <code>Person.find_first([&quot;user_name = ? AND password =
?&quot;, user_name, password])</code>, you just do 
<code>Person.find_by_user_name_and_password(user_name, password)</code>.</p>

<p>While primarily a construct for easier find_firsts, it can also be used as
a construct for find_all by using calls like 
<code>Payment.find_all_by_amount(50)</code> that is turned into
<code>Payment.find_all([&quot;amount = ?&quot;, 50])</code>. This is
something not as equally useful, though, as it’s not possible to specify
the order in which the objects are returned.</p>
</li><li>
<p>Added block-style for callbacks #332 [Jeremy Kemper].</p>

<pre class="ruby"><span class="ruby-constant">Before</span><span class="ruby-operator">:</span>
  <span class="ruby-identifier">before_destroy</span>(<span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">record</span><span class="ruby-operator">|</span> <span class="ruby-constant">Person</span>.<span class="ruby-identifier">destroy_all</span> <span class="ruby-node">&quot;firm_id = #{record.id}&quot;</span> })

<span class="ruby-constant">After</span><span class="ruby-operator">:</span>
  <span class="ruby-identifier">before_destroy</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">record</span><span class="ruby-operator">|</span> <span class="ruby-constant">Person</span>.<span class="ruby-identifier">destroy_all</span> <span class="ruby-node">&quot;firm_id = #{record.id}&quot;</span> }
</pre>
</li><li>
<p>Added :counter_cache option to acts_as_tree that works just like the one
you can define on belongs_to #371 [Josh]</p>
</li><li>
<p>Added Base.default_timezone accessor that determines whether to use
Time.local (using :local) or Time.utc (using :utc) when pulling dates  and
times from the database. This is set to :local by default.</p>
</li><li>
<p>Added the possibility for adapters to overwrite add_limit! to implement a
different limiting scheme than “LIMIT X” used by MySQL, PostgreSQL, and
SQLite.</p>
</li><li>
<p>Added the possibility of having objects with acts_as_list created before
their scope is available or…</p>
</li><li>
<p>Added a db2 adapter that only depends on the Ruby/DB2 bindings (<a
href="http://raa.ruby-lang.org/project/ruby-db2/">raa.ruby-lang.org/project/ruby-db2/</a>)
#386 [Maik Schmidt]</p>
</li><li>
<p>Added the final touches to the Microsoft SQL Server adapter by Joey Gibson
that makes it suitable for actual use #394 [DeLynn Barry]</p>
</li><li>
<p>Added that Base#find takes an optional options hash, including :conditions.
Base#find_on_conditions deprecated in favor of find with :conditions #407
[Jeremy Kemper]</p>
</li><li>
<p>Added HasManyAssociation#count that works like Base#count #413 [intinig]</p>
</li><li>
<p>Fixed handling of binary content in blobs and similar fields for Ruby/MySQL
and SQLite #409 [xal]</p>
</li><li>
<p>Fixed a bug in the Ruby/MySQL that caused binary content to be escaped
badly and come back mangled #405 [Tobias Luetke]</p>
</li><li>
<p>Fixed that the const_missing autoload assumes the requested constant is set
by require_association and calls const_get to retrieve it.  If
require_association did not set the constant then const_get will call
const_missing, resulting in an infinite loop #380 [Jeremy Kemper]</p>
</li><li>
<p>Fixed broken transactions that were actually only running object-level and
not db level transactions [andreas]</p>
</li><li>
<p>Fixed that validates_uniqueness_of used ‘id’ instead of defined primary key
#406</p>
</li><li>
<p>Fixed that the overwritten respond_to? method didn’t take two parameters
like the original #391</p>
</li><li>
<p>Fixed quoting in validates_format_of that would allow some rules to pass
regardless of input #390 [Dmitry V. Sabanin]</p>
</li></ul>

<p><strong>1.3.0</strong> (December 23, 2004)</p>
<ul><li>
<p>Added a require_association hook on const_missing that makes it possible to
use any model class without requiring it first. This makes STI look like:</p>

<pre class="ruby"><span class="ruby-identifier">before</span><span class="ruby-operator">:</span>
  <span class="ruby-identifier">require_association</span> <span class="ruby-string">'person'</span>
  <span class="ruby-keyword">class</span> <span class="ruby-constant">Employee</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Person</span>
  <span class="ruby-keyword">end</span>

<span class="ruby-identifier">after</span><span class="ruby-operator">:</span>
  <span class="ruby-keyword">class</span> <span class="ruby-constant">Employee</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Person</span>
  <span class="ruby-keyword">end</span>
</pre>

<p>This also reduces the usefulness of Controller.model in Action Pack to
currently only being for documentation purposes.</p>
</li><li>
<p>Added that Base.update_all and Base.delete_all return an integer of the
number of affected rows #341</p>
</li><li>
<p>Added scope option to validation_uniqueness #349 [Kent Sibilev]</p>
</li><li>
<p>Added respondence to *_before_type_cast for all attributes to return their
string-state before they were type casted by the column type. This is
helpful for getting “100,000” back on a integer-based validation where the
value would normally be “100”.</p>
</li><li>
<p>Added allow_nil options to validates_inclusion_of so that validation is
only triggered if the attribute is not nil [what-a-day]</p>
</li><li>
<p>Added work-around for PostgreSQL and the problem of getting fixtures to be
created from id 1 on each test case. This only works for auto-incrementing
primary keys called “id” for now #359 [Scott Baron]</p>
</li><li>
<p>Added Base#clear_association_cache to empty all the cached associations
#347 [Tobias Luetke]</p>
</li><li>
<p>Added more informative exceptions in establish_connection #356 [Jeremy
Kemper]</p>
</li><li>
<p>Added Base#update_attributes that’ll accept a hash of attributes and save
the record (returning true if it passed validation, false otherwise).</p>

<pre>Before:
  person.attributes = @params[&quot;person&quot;]
  person.save

Now:
  person.update_attributes(@params[&quot;person&quot;])</pre>
</li><li>
<p>Added Base.destroy and Base.delete to remove records without holding a
reference to them first.</p>
</li><li>
<p>Added that query benchmarking will only happen if its going to be logged
anyway #344</p>
</li><li>
<p>Added higher_item and lower_item as public methods for acts_as_list #342
[Tobias Luetke]</p>
</li><li>
<p>Fixed that <a href="http://:counter_sql">options</a> was overwritten with
interpolated sql rather than original sql #355 [Jeremy Kemper]</p>
</li><li>
<p>Fixed that overriding an attribute’s accessor would be disregarded by
add_on_empty and add_on_boundary_breaking because they simply used  the
attributes[] hash instead of checking for @base.respond_to?(attr.to_s).
[Marten]</p>
</li><li>
<p>Fixed that Base.table_name would expect a parameter when used in
has_and_belongs_to_many joins [Anna Lissa Cruz]</p>
</li><li>
<p>Fixed that nested transactions now work by letting the outer most
transaction have the responsibilty of starting and rolling back the
transaction. If any of the inner transactions swallow the exception raised,
though, the transaction will not be rolled back. So always let the
transaction bubble up even when you’ve dealt with local issues. Closes #231
and #340.</p>
</li><li>
<p>Fixed validates_{confirmation,acceptance}_of to only happen when the
virtual attributes are not nil #348 [dpiddy@gmail.com]</p>
</li><li>
<p>Changed the interface on AbstractAdapter to require that adapters return
the number of affected rows on delete and update operations.</p>
</li><li>
<p>Fixed the automated timestamping feature when running under Rails’
development environment that resets the inheritable attributes on each
request.</p>
</li></ul>

<p><strong>1.2.0</strong></p>
<ul><li>
<p>Added Base.validates_inclusion_of that validates whether the value of the
specified attribute is available in a particular enumerable object.
[what-a-day]</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_inclusion_of</span> :<span class="ruby-identifier">gender</span>, :<span class="ruby-keyword">in</span>=<span class="ruby-operator">&gt;</span><span class="ruby-node">%w( m f )</span>, :<span class="ruby-identifier">message=</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&quot;woah! what are you then!??!!&quot;</span>
  <span class="ruby-identifier">validates_inclusion_of</span> :<span class="ruby-identifier">age</span>, :<span class="ruby-keyword">in</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">99</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Added acts_as_list that can decorates an existing class with methods like
move_higher/lower, move_to_top/bottom. [Tobias Luetke] Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">TodoItem</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">acts_as_list</span> :<span class="ruby-identifier">scope</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">todo_list_id</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">todo_list</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Added acts_as_tree that can decorates an existing class with a many to many
relationship with itself. Perfect for categories in  categories and the
likes. [Tobias Luetke]</p>
</li><li>
<p>Added that Active Records will automatically record creation and/or update
timestamps of database objects if fields of the names 
created_at/created_on or updated_at/updated_on are present. [Tobias Luetke]</p>
</li><li>
<p>Added Base.default_error_messages as a hash of all the error messages used
in the validates_*_of so they can be changed in one place [Tobias Luetke]</p>
</li><li>
<p>Added automatic transaction block around AssociationCollection.&lt;&lt;,
AssociationCollection.delete, and AssociationCollection.destroy_all</p>
</li><li>
<p>Fixed that Base#find will return an array if given an array – regardless of
the number of elements #270 [Marten]</p>
</li><li>
<p>Fixed that has_and_belongs_to_many would generate bad sql when naming
conventions differed from using vanilla “id” everywhere [RedTerror]</p>
</li><li>
<p>Added a better exception for when a type column is used in a table without
the intention of triggering single-table inheritance. Example:</p>

<pre class="ruby"><span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SubclassNotFound</span><span class="ruby-operator">:</span> <span class="ruby-constant">The</span> <span class="ruby-identifier">single</span><span class="ruby-operator">-</span><span class="ruby-identifier">table</span> <span class="ruby-identifier">inheritance</span> <span class="ruby-identifier">mechanism</span> <span class="ruby-identifier">failed</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">locate</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">subclass</span><span class="ruby-operator">:</span> <span class="ruby-string">'bad_class!'</span>.
<span class="ruby-constant">This</span> <span class="ruby-identifier">error</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">raised</span> <span class="ruby-identifier">because</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">column</span> <span class="ruby-string">'type'</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">reserved</span> <span class="ruby-keyword">for</span> <span class="ruby-identifier">storing</span> <span class="ruby-identifier">the</span> <span class="ruby-keyword">class</span> <span class="ruby-keyword">in</span> <span class="ruby-keyword">case</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">inheritance</span>. 
<span class="ruby-constant">Please</span> <span class="ruby-identifier">rename</span> <span class="ruby-identifier">this</span> <span class="ruby-identifier">column</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">you</span> <span class="ruby-identifier">didn</span><span class="ruby-string">'t intend it to be used for storing the inheritance class or 
overwrite Company.inheritance_column to use another column for that information.
</span></pre>
</li><li>
<p>Added that single-table inheritance will only kick in if the
inheritance_column (by default “type”) is present. Otherwise, inheritance
won’t have any magic side effects.</p>
</li><li>
<p>Added the possibility of marking fields as being in error without adding a
message (using nil) to it that’ll get displayed wth full_messages #208
[mjobin]</p>
</li><li>
<p>Fixed Base.errors to be indifferent as to whether strings or symbols are
used. Examples:</p>

<pre class="ruby"><span class="ruby-constant">Before</span><span class="ruby-operator">:</span>
  <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(:<span class="ruby-identifier">name</span>, <span class="ruby-string">&quot;must be shorter&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>
  <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(:<span class="ruby-identifier">name</span>)  <span class="ruby-comment"># =&gt; &quot;must be shorter&quot;</span>
  <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-string">&quot;name&quot;</span>) <span class="ruby-comment"># =&gt; nil</span>

<span class="ruby-constant">After</span><span class="ruby-operator">:</span>
  <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(:<span class="ruby-identifier">name</span>, <span class="ruby-string">&quot;must be shorter&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>
  <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(:<span class="ruby-identifier">name</span>)  <span class="ruby-comment"># =&gt; &quot;must be shorter&quot;</span>
  <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-string">&quot;name&quot;</span>) <span class="ruby-comment"># =&gt; &quot;must be shorter&quot;</span>
</pre>
</li><li>
<p>Added Base.validates_format_of that Validates whether the value of the
specified attribute is of the correct form by matching  it against the
regular expression provided. [Marcel]</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_format_of</span> :<span class="ruby-identifier">email</span>, :<span class="ruby-identifier">with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp">%r^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/</span>, :<span class="ruby-identifier">on</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">create</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Added Base.validates_length_of that delegates to add_on_boundary_breaking
#312 [Tobias Luetke]. Example:</p>

<pre class="ruby"><span class="ruby-constant">Validates</span> <span class="ruby-identifier">that</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">specified</span> <span class="ruby-identifier">attribute</span> <span class="ruby-identifier">matches</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">length</span> <span class="ruby-identifier">restrictions</span> <span class="ruby-identifier">supplied</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">either</span><span class="ruby-operator">:</span>

  <span class="ruby-operator">-</span> <span class="ruby-identifier">configuration</span>[:<span class="ruby-identifier">minimum</span>]
  <span class="ruby-operator">-</span> <span class="ruby-identifier">configuration</span>[:<span class="ruby-identifier">maximum</span>]
  <span class="ruby-operator">-</span> <span class="ruby-identifier">configuration</span>[:<span class="ruby-identifier">is</span>]
  <span class="ruby-operator">-</span> <span class="ruby-identifier">configuration</span>[:<span class="ruby-identifier">within</span>] (<span class="ruby-identifier">aka</span>. <span class="ruby-identifier">configuration</span>[:<span class="ruby-keyword">in</span>])

<span class="ruby-constant">Only</span> <span class="ruby-identifier">one</span> <span class="ruby-identifier">option</span> <span class="ruby-identifier">can</span> <span class="ruby-identifier">be</span> <span class="ruby-identifier">used</span> <span class="ruby-identifier">at</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">time</span>.

  <span class="ruby-identifier">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
    <span class="ruby-identifier">validates_length_of</span> :<span class="ruby-identifier">first_name</span>, :<span class="ruby-identifier">maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">30</span>
    <span class="ruby-identifier">validates_length_of</span> :<span class="ruby-identifier">last_name</span>, :<span class="ruby-identifier">maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">30</span>, :<span class="ruby-identifier">message=</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&quot;less than %d if you don't mind&quot;</span>
    <span class="ruby-identifier">validates_length_of</span> :<span class="ruby-identifier">user_name</span>, :<span class="ruby-identifier">within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">6</span><span class="ruby-operator">..</span><span class="ruby-value">20</span>, :<span class="ruby-identifier">too_long</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;pick a shorter name&quot;</span>, :<span class="ruby-identifier">too_short</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;pick a longer name&quot;</span>
    <span class="ruby-identifier">validates_length_of</span> :<span class="ruby-identifier">fav_bra_size</span>, :<span class="ruby-identifier">minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>, :<span class="ruby-identifier">too_short=</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&quot;please enter at least %d character&quot;</span>
    <span class="ruby-identifier">validates_length_of</span> :<span class="ruby-identifier">smurf_leader</span>, :<span class="ruby-identifier">is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">4</span>, :<span class="ruby-identifier">message=</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&quot;papa is spelled with %d characters... don't play me.&quot;</span>
  <span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Added Base.validate_presence as an alternative to implementing validate and
doing errors.add_on_empty yourself.</p>
</li><li>
<p>Added Base.validates_uniqueness_of that alidates whether the value of the
specified attributes are unique across the system.  Useful for making sure
that only one user can be named “davidhh”.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_uniqueness_of</span> :<span class="ruby-identifier">user_name</span>
<span class="ruby-keyword">end</span>
</pre>

<p>When the record is created, a check is performed to make sure that no
record exist in the database with the given value for the specified
attribute (that maps to a column). When the record is updated, the same
check is made but disregarding the record itself.</p>
</li><li>
<p>Added Base.validates_confirmation_of that encapsulates the pattern of
wanting to validate a password or email address field with a confirmation.
Example:</p>

<pre>  Model:
    class Person &lt; ActiveRecord::Base
      validates_confirmation_of :password
    end

  View:
    &lt;%= password_field &quot;person&quot;, &quot;password&quot; %&gt;
    &lt;%= password_field &quot;person&quot;, &quot;password_confirmation&quot; %&gt;

The person has to already have a password attribute (a column in the people table), but the password_confirmation is virtual.
It exists only as an in-memory variable for validating the password. This check is performed both on create and update.</pre>
</li><li>
<p>Added Base.validates_acceptance_of that encapsulates the pattern of wanting
to validate the acceptance of a terms of service check box (or similar
agreement). Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_acceptance_of</span> :<span class="ruby-identifier">terms_of_service</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The terms_of_service attribute is entirely virtual. No database column is
needed. This check is performed both on create and update.</p>

<p>NOTE: The agreement is considered valid if it’s set to the string “1”. This
makes it easy to relate it to an <a
href="../../../classes/HTML.html">HTML</a> checkbox.</p>
</li><li>
<p>Added validation macros to make the stackable just like the lifecycle
callbacks. Examples:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validate</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">record</span><span class="ruby-operator">|</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-string">&quot;name&quot;</span>, <span class="ruby-string">&quot;too short&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span> }
  <span class="ruby-identifier">validate</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">record</span><span class="ruby-operator">|</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-string">&quot;name&quot;</span>, <span class="ruby-string">&quot;too long&quot;</span>)  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">20</span> }
  <span class="ruby-identifier">validate_on_create</span> :<span class="ruby-identifier">validate_password</span>

  <span class="ruby-identifier">private</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier">validate_password</span>
      <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-string">&quot;password&quot;</span>, <span class="ruby-string">&quot;too short&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">password</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">6</span>
    <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Added the option for sanitizing find_by_sql and the offset parts in regular
finds [Sam Stephenson]. Examples:</p>

<pre>Project.find_all [&quot;category = ?&quot;, category_name], &quot;created ASC&quot;, [&quot;? OFFSET ?&quot;, 15, 20]
Post.find_by_sql [&quot;SELECT * FROM posts WHERE author = ? AND created &gt; ?&quot;, author_id, start_date]</pre>
</li><li>
<p>Fixed value quoting in all generated SQL statements, so that integers are
not surrounded in quotes and that all sanitation are happening through the
database’s own quoting routine. This should hopefully make it lots easier
for new adapters that doesn’t accept ‘1’ for integer columns.</p>
</li><li>
<p>Fixed has_and_belongs_to_many guessing of foreign key so that keys are
generated correctly for models like SomeVerySpecialClient</p>
<dl class="rdoc-list label-list"><dt>Florian Weber
<dd></dd></dl>
</li><li>
<p>Added counter_sql option for has_many associations [Jeremy Kemper].
Documentation:</p>

<pre>&lt;tt&gt;:counter_sql&lt;/tt&gt; - specify a complete SQL statement to fetch the size of the association. If +:finder_sql+ is
specified but +:counter_sql+, +:counter_sql+ will be generated by replacing SELECT ... FROM with SELECT COUNT(*) FROM.</pre>
</li><li>
<p>Fixed that methods wrapped in callbacks still return their original result
#260 [Jeremy Kemper]</p>
</li><li>
<p>Fixed the <a href="../../../classes/Inflector.html">Inflector</a> to handle
the movie/movies pair correctly #261 [Scott Baron]</p>
</li><li>
<p>Added named bind-style variable interpolation #281 [Michael Koziarski].
Example:</p>

<pre class="ruby"><span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>([<span class="ruby-string">&quot;id = :id and first_name = :first_name&quot;</span>, { :<span class="ruby-identifier">id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, :<span class="ruby-identifier">first_name</span> = <span class="ruby-string">&quot;bob' or 1=1&quot;</span> }])
</pre>
</li><li>
<p>Added bind-style variable interpolation for the condition arrays that uses
the adapter’s quote method [Michael Koziarski]</p>

<p>Before:</p>

<pre>find_first([ &quot;user_name = '%s' AND password = '%s'&quot;, user_name, password ])]
find_first([ &quot;firm_id = %s&quot;, firm_id ])] # unsafe!</pre>

<p>After:</p>

<pre>find_first([ &quot;user_name = ? AND password = ?&quot;, user_name, password ])]
find_first([ &quot;firm_id = ?&quot;, firm_id ])]</pre>
</li><li>
<p>Added CSV format for fixtures #272 [what-a-day]. (See the new and expanded
documentation on fixtures for more information)</p>
</li><li>
<p>Fixed fixtures using primary key fields called something else than “id”
[dave]</p>
</li><li>
<p>Added proper handling of time fields that are turned into <a
href="../../../classes/Time.html">Time</a> objects with the dummy date of
2000/1/1 [HariSeldon]</p>
</li><li>
<p>Added reverse order of deleting fixtures, so referential keys can be
maintained #247 [Tim Bates]</p>
</li><li>
<p>Added relative path search for sqlite dbfiles in database.yml (if
RAILS_ROOT is defined) #233 [Jeremy Kemper]</p>
</li><li>
<p>Added option to establish_connection where you’ll be able to leave out the
parameter to have it use the RAILS_ENV environment variable</p>
</li><li>
<p>Fixed problems with primary keys and postgresql sequences (#230) [Tim
Bates]</p>
</li><li>
<p>Added reloading for associations under cached environments like FastCGI and
mod_ruby. This makes it possible to use those environments for development.
This is turned on by default, but can be turned off with
ActiveRecord::Base.reload_dependencies = false in production environments.</p>

<p>NOTE: This will only have an effect if you let the associations manage the
requiring of model classes. All libraries loaded through require will be
“forever” cached. You can, however, use
ActiveRecord::Base.load_or_require(“library”) to get this behavior outside
of the auto-loading associations.</p>
</li><li>
<p>Added ERB capabilities to the fixture files for dynamic fixture generation.
You don’t need to do anything, just include ERB blocks like:</p>

<pre>david:
  id: 1
  name: David

jamis:
  id: 2
  name: Jamis

&lt;% for digit in 3..10 %&gt;
dev_&lt;%= digit %&gt;:
  id: &lt;%= digit %&gt;
  name: fixture_&lt;%= digit %&gt;
&lt;% end %&gt;</pre>
</li><li>
<p>Changed the yaml fixture searcher to look in the root of the fixtures
directory, so when you before could have something like:</p>

<pre>fixtures/developers/fixtures.yaml
fixtures/accounts/fixtures.yaml</pre>

<p>…you now need to do:</p>

<pre>fixtures/developers.yaml
fixtures/accounts.yaml</pre>
</li><li>
<p>Changed the fixture format from:</p>

<pre>name: david
data:
 id: 1
 name: David Heinemeier Hansson
 birthday: 1979-10-15
 profession: Systems development
---
name: steve
data:
 id: 2
 name: Steve Ross Kellock
 birthday: 1974-09-27
 profession: guy with keyboard</pre>

<p>…to:</p>

<pre>david:
 id: 1
 name: David Heinemeier Hansson
 birthday: 1979-10-15
 profession: Systems development

steve:
 id: 2
 name: Steve Ross Kellock
 birthday: 1974-09-27
 profession: guy with keyboard</pre>

<p>The change is NOT backwards compatible. <a
href="../../../classes/Fixtures.html">Fixtures</a> written in the old YAML
style needs to be rewritten!</p>
</li><li>
<p>All associations will now attempt to require the classes that they
associate to. Relieving the need for most explicit ‘require’ statements.</p>
</li></ul>

<p><strong>1.1.0</strong> (34)</p>
<ul><li>
<p>Added automatic fixture setup and instance variable availability. <a
href="../../../classes/Fixtures.html">Fixtures</a> can also be
automatically  instantiated in instance variables relating to their names
using the following style:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">FixturesTest</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Test</span><span class="ruby-operator">::</span><span class="ruby-constant">Unit</span><span class="ruby-operator">::</span><span class="ruby-constant">TestCase</span>
  <span class="ruby-identifier">fixtures</span> :<span class="ruby-identifier">developers</span> <span class="ruby-comment"># you can add more with comma separation</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">test_developers</span>
    <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">3</span>, <span class="ruby-ivar">@developers</span>.<span class="ruby-identifier">size</span> <span class="ruby-comment"># the container for all the fixtures is automatically set</span>
    <span class="ruby-identifier">assert_kind_of</span> <span class="ruby-constant">Developer</span>, <span class="ruby-ivar">@david</span> <span class="ruby-comment"># works like @developers[&quot;david&quot;].find</span>
    <span class="ruby-identifier">assert_equal</span> <span class="ruby-string">&quot;David Heinemeier Hansson&quot;</span>, <span class="ruby-ivar">@david</span>.<span class="ruby-identifier">name</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Added HasAndBelongsToManyAssociation#push_with_attributes(object,
join_attributes) that can create associations in the join table with
additional attributes. This is really useful when you have information
that’s only relevant to the join itself, such as a “added_on” column for an
association between post and category. The added attributes will
automatically be injected into objects retrieved through the association
similar to the piggy-back approach:</p>

<pre class="ruby"><span class="ruby-identifier">post</span>.<span class="ruby-identifier">categories</span>.<span class="ruby-identifier">push_with_attributes</span>(<span class="ruby-identifier">category</span>, :<span class="ruby-identifier">added_on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>)
<span class="ruby-identifier">post</span>.<span class="ruby-identifier">categories</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">added_on</span> <span class="ruby-comment"># =&gt; Date.today</span>
</pre>

<p>NOTE: The categories table doesn’t have a added_on column, it’s the
categories_post join table that does!</p>
</li><li>
<p>Fixed that :exclusively_dependent and :dependent can’t be activated at the
same time on has_many associations [Jeremy Kemper]</p>
</li><li>
<p>Fixed that database passwords couldn’t be all numeric [Jeremy Kemper]</p>
</li><li>
<p>Fixed that calling id would create the instance variable for new_records
preventing them from being saved correctly [Jeremy Kemper]</p>
</li><li>
<p>Added sanitization feature to HasManyAssociation#find_all so it works just
like Base.find_all [Sam Stephenson/bitsweat]</p>
</li><li>
<p>Added that you can pass overlapping ids to find without getting duplicated
records back [Jeremy Kemper]</p>
</li><li>
<p>Added that Base.benchmark returns the result of the block [Jeremy Kemper]</p>
</li><li>
<p>Fixed problem with unit tests on Windows with SQLite [paterno]</p>
</li><li>
<p>Fixed that quotes would break regular non-yaml fixtures [Dmitry
Sabanin/daft]</p>
</li><li>
<p>Fixed fixtures on windows with line endings cause problems under unix / mac
[Tobias Luetke]</p>
</li><li>
<p>Added HasAndBelongsToManyAssociation#find(id) that’ll search inside the
collection and find the object or record with that id</p>
</li><li>
<p>Added :conditions option to has_and_belongs_to_many that works just like
the one on all the other associations</p>
</li><li>
<p>Added AssociationCollection#clear to remove all associations from has_many
and has_and_belongs_to_many associations without destroying the records
[geech]</p>
</li><li>
<p>Added type-checking and remove in 1-instead-of-N sql statements to
AssociationCollection#delete [geech]</p>
</li><li>
<p>Added a return of self to AssociationCollection#&lt;&lt; so appending can
be chained, like project &lt;&lt; Milestone.create &lt;&lt;
Milestone.create [geech]</p>
</li><li>
<p>Added Base#hash and Base#eql? which means that all of the equality using
features of array and other containers now works:</p>

<pre class="ruby">[ <span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>), <span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">2</span>), <span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>) ] &amp; [ <span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>), <span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">4</span>) ] <span class="ruby-comment"># =&gt; [ Person.find(1) ]</span>
</pre>
</li><li>
<p>Added :uniq as an option to has_and_belongs_to_many which will
automatically ensure that AssociateCollection#uniq is called before pulling
records out of the association. This is especially useful for three-way
(and above) has_and_belongs_to_many associations.</p>
</li><li>
<p>Added AssociateCollection#uniq which is especially useful for
has_and_belongs_to_many associations that can include duplicates, which is
common on associations that also use metadata. Usage: post.categories.uniq</p>
</li><li>
<p>Fixed respond_to? to use a subclass specific hash instead of an Active
Record-wide one</p>
</li><li>
<p>Fixed has_and_belongs_to_many to treat associations between classes in
modules properly [Florian Weber]</p>
</li><li>
<p>Added a NoMethod exception to be raised when query and writer methods are
called for attributes that doesn’t exist [geech]</p>
</li><li>
<p>Added a more robust version of <a
href="../../../classes/Fixtures.html">Fixtures</a> that throws meaningful
errors when on formatting issues [geech]</p>
</li><li>
<p>Added Base#transaction as a compliment to Base.transaction for prettier use
in instance methods [geech]</p>
</li><li>
<p>Improved the speed of respond_to? by placing the dynamic methods lookup
table in a hash [geech]</p>
</li><li>
<p>Added that any additional fields added to the join table in a
has_and_belongs_to_many association  will be placed as attributes when
pulling records out through has_and_belongs_to_many associations.  This is
helpful when have information about the association itself that you want
available on retrival.</p>
</li><li>
<p>Added better loading exception catching and RubyGems retries to the
database adapters [alexeyv]</p>
</li><li>
<p>Fixed bug with per-model transactions [daniel]</p>
</li><li>
<p>Fixed Base#transaction so that it returns the result of the last expression
in the transaction block [alexeyv]</p>
</li><li>
<p>Added Fixture#find to find the record corresponding to the fixture id. The
record  class name is guessed by using <a
href="../../../classes/Inflector.html#method-i-classify">Inflector#classify</a>
(also new) on the fixture directory name.</p>

<pre>Before: Document.find(@documents[&quot;first&quot;][&quot;id&quot;])
After : @documents[&quot;first&quot;].find</pre>
</li><li>
<p>Fixed that the table name part of column names (“TABLE.COLUMN”) wasn’t
removed properly [Andreas Schwarz]</p>
</li><li>
<p>Fixed a bug with Base#size when a finder_sql was used that didn’t
capitalize SELECT and FROM [geech]</p>
</li><li>
<p>Fixed quoting problems on SQLite by adding quote_string to the
AbstractAdapter that can be overwritten by the concrete adapters for a call
to the dbm. [Andreas Schwarz]</p>
</li><li>
<p>Removed RubyGems backup strategy for requiring SQLite-adapter – if people
want to use gems, they’re already doing it with AR.</p>
</li></ul>

<p>*1.0.0 (35)*</p>
<ul><li>
<p>Added OO-style associations methods [Florian Weber]. Examples:</p>

<pre class="ruby"><span class="ruby-constant">Project</span><span class="ruby-comment">#milestones_count       =&gt; Project#milestones.size</span>
<span class="ruby-constant">Project</span><span class="ruby-comment">#build_to_milestones    =&gt; Project#milestones.build</span>
<span class="ruby-constant">Project</span><span class="ruby-comment">#create_for_milestones  =&gt; Project#milestones.create</span>
<span class="ruby-constant">Project</span><span class="ruby-comment">#find_in_milestones     =&gt; Project#milestones.find</span>
<span class="ruby-constant">Project</span><span class="ruby-comment">#find_all_in_milestones =&gt; Project#milestones.find_all</span>
</pre>
</li><li>
<p>Added serialize as a new class method to control when text attributes
should be YAMLized or not. This means that automated serialization of
hashes, arrays, and so on WILL NO LONGER HAPPEN (#10). You need to do
something like this:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">User</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">serialize</span> :<span class="ruby-identifier">settings</span>
<span class="ruby-keyword">end</span>
</pre>

<p>This will assume that settings is a text column and will now YAMLize any
object put in that attribute. You can also specify an optional :class_name
option that’ll raise an exception if a serialized object is retrieved as a
descendent of a class not in the hierarchy. Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">User</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">serialize</span> :<span class="ruby-identifier">settings</span>, :<span class="ruby-identifier">class_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Hash&quot;</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;settings&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( one two three )</span>)
<span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">user</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">settings</span> <span class="ruby-comment"># =&gt; raises SerializationTypeMismatch</span>
</pre>
</li><li>
<p>Added the option to connect to a different database for one model at a
time. Just call establish_connection on the class you want to have
connected to another database than Base. This will automatically also
connect decendents of that class to the different database [Renald Buter].</p>
</li><li>
<p>Added transactional protection for Base#save. Validations can now check for
values knowing that it happens in a transaction and callbacks can raise
exceptions knowing that the save will be rolled back. [Suggested by Alexey
Verkhovsky]</p>
</li><li>
<p>Added column name quoting so reserved words, such as “references”, can be
used as column names [Ryan Platte]</p>
</li><li>
<p>Added the possibility to chain the return of what happened inside a logged
block [geech]:</p>

<pre>This now works: 
  log { ... }.map { ... }

Instead of doing:
  result = []
  log { result = ... }
  result.map { ... }</pre>
</li><li>
<p>Added “socket” option for the MySQL adapter, so you can change it to
something else than “/tmp/mysql.sock” [Anna Lissa Cruz]</p>
</li><li>
<p>Added respond_to? answers for all the attribute methods. So if <a
href="../../../classes/Person.html">Person</a> has a name attribute
retrieved from the table schema,  person.respond_to? “name” will return
true.</p>
</li><li>
<p>Added Base.benchmark which can be used to aggregate logging and benchmark,
so you can measure and represent multiple statements in a single block.
Usage (hides all the SQL calls for the individual actions and calculates
total runtime for them all):</p>

<pre class="ruby"><span class="ruby-constant">Project</span>.<span class="ruby-identifier">benchmark</span>(<span class="ruby-string">&quot;Creating project&quot;</span>) <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;stuff&quot;</span>)
  <span class="ruby-identifier">project</span>.<span class="ruby-identifier">create_manager</span>(<span class="ruby-string">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;David&quot;</span>)
  <span class="ruby-identifier">project</span>.<span class="ruby-identifier">milestones</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Milestone</span>.<span class="ruby-identifier">find_all</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Added logging of invalid SQL statements [Suggested by Daniel Von Fange]</p>
</li><li>
<p>Added alias Errors#[] for Errors#on, so you can now say <a
href="http://"name"">person.errors</a> to retrieve the errors for name
[Andreas Schwarz]</p>
</li><li>
<p>Added RubyGems require attempt if sqlite-ruby is not available through
regular methods.</p>
</li><li>
<p>Added compatibility with 2.x series of sqlite-ruby drivers. [Jamis Buck]</p>
</li><li>
<p>Added type safety for association assignments, so a
ActiveRecord::AssociationTypeMismatch will be raised if you attempt to
assign an object that’s not of the associated class. This cures the problem
with nil giving id = 4 and fixnums giving id = 1 on  mistaken association
assignments. [Reported by Andreas Schwarz]</p>
</li><li>
<p>Added the option to keep many fixtures in one single YAML document
[what-a-day]</p>
</li><li>
<p>Added the class method “inheritance_column” that can be overwritten to
return the name of an alternative column than “type” for storing the type
for inheritance hierarchies. [Dave Steinberg]</p>
</li><li>
<p>Added [] and []= as an alternative way to access attributes when the
regular methods have been overwritten [Dave Steinberg]</p>
</li><li>
<p>Added the option to observer more than one class at the time by specifying
observed_class as an array</p>
</li><li>
<p>Added auto-id propagation support for tables with arbitrary primary keys
that have autogenerated sequences associated with them  on PostgreSQL.
[Dave Steinberg]</p>
</li><li>
<p>Changed that integer and floats set to “” through attributes= remain as
NULL. This was especially a problem for scaffolding and postgresql. (#49)</p>
</li><li>
<p>Changed the MySQL Adapter to rely on MySQL for its defaults for socket,
host, and port [Andreas Schwarz]</p>
</li><li>
<p>Changed ActionControllerError to decent from StandardError instead of
Exception. It can now be caught by a generic rescue.</p>
</li><li>
<p>Changed class inheritable attributes to not use eval [Caio Chassot]</p>
</li><li>
<p>Changed Errors#add to now use “invalid” as the default message instead of
true, which means full_messages work with those [Marcel Molina Jr]</p>
</li><li>
<p>Fixed spelling on Base#add_on_boundry_breaking to
Base#add_on_boundary_breaking (old naming still works) [Marcel Molina Jr.]</p>
</li><li>
<p>Fixed that entries in the has_and_belongs_to_many join table didn’t get
removed when an associated object was destroyed.</p>
</li><li>
<p>Fixed unnecessary calls to SET AUTOCOMMIT=0/1 for MySQL adapter [Andreas
Schwarz]</p>
</li><li>
<p>Fixed PostgreSQL defaults are now handled gracefully [Dave Steinberg]</p>
</li><li>
<p>Fixed increment/decrement_counter are now atomic updates [Andreas Schwarz]</p>
</li><li>
<p>Fixed the problems the <a
href="../../../classes/Inflector.html">Inflector</a> had turning Attachment
into attuchments and Cases into Casis [radsaq/Florian Gross]</p>
</li><li>
<p>Fixed that cloned records would point attribute references on the parent
object [Andreas Schwarz]</p>
</li><li>
<p>Fixed SQL for type call on inheritance hierarchies [Caio Chassot]</p>
</li><li>
<p>Fixed bug with typed inheritance [Florian Weber]</p>
</li><li>
<p>Fixed a bug where has_many collection_count wouldn’t use the conditions
specified for that association</p>
</li></ul>

<p><strong>0.9.5</strong></p>
<ul><li>
<p>Expanded the table_name guessing rules immensely [Florian Green].
Documentation:</p>

<pre class="ruby"><span class="ruby-constant">Guesses</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">table</span> <span class="ruby-identifier">name</span> (<span class="ruby-keyword">in</span> <span class="ruby-identifier">forced</span> <span class="ruby-identifier">lower</span><span class="ruby-operator">-</span><span class="ruby-keyword">case</span>) <span class="ruby-identifier">based</span> <span class="ruby-identifier">on</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">the</span> <span class="ruby-keyword">class</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">inheritance</span> <span class="ruby-identifier">hierarchy</span> <span class="ruby-identifier">descending</span>
<span class="ruby-identifier">directly</span> <span class="ruby-identifier">from</span> <span class="ruby-constant">ActiveRecord</span>. <span class="ruby-constant">So</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">hierarchy</span> <span class="ruby-identifier">looks</span> <span class="ruby-identifier">like</span><span class="ruby-operator">:</span> <span class="ruby-constant">Reply</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Message</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span>, <span class="ruby-keyword">then</span> <span class="ruby-constant">Message</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">used</span>
<span class="ruby-identifier">to</span> <span class="ruby-identifier">guess</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">table</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">from</span> <span class="ruby-identifier">even</span> <span class="ruby-keyword">when</span> <span class="ruby-identifier">called</span> <span class="ruby-identifier">on</span> <span class="ruby-constant">Reply</span>. <span class="ruby-constant">The</span> <span class="ruby-identifier">guessing</span> <span class="ruby-identifier">rules</span> <span class="ruby-identifier">are</span> <span class="ruby-identifier">as</span> <span class="ruby-identifier">follows</span><span class="ruby-operator">:</span>
* <span class="ruby-constant">Class</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">ends</span> <span class="ruby-keyword">in</span> <span class="ruby-string">&quot;x&quot;</span>, <span class="ruby-string">&quot;ch&quot;</span> <span class="ruby-keyword">or</span> <span class="ruby-string">&quot;ss&quot;</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;es&quot;</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">appended</span>, <span class="ruby-identifier">so</span> <span class="ruby-identifier">a</span> <span class="ruby-constant">Search</span> <span class="ruby-keyword">class</span> <span class="ruby-identifier">becomes</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">searches</span> <span class="ruby-identifier">table</span>.
* <span class="ruby-constant">Class</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">ends</span> <span class="ruby-keyword">in</span> <span class="ruby-string">&quot;y&quot;</span> <span class="ruby-identifier">preceded</span> <span class="ruby-identifier">by</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">consonant</span> <span class="ruby-keyword">or</span> <span class="ruby-string">&quot;qu&quot;</span><span class="ruby-operator">:</span> <span class="ruby-constant">The</span> <span class="ruby-string">&quot;y&quot;</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">replaced</span> <span class="ruby-identifier">with</span> <span class="ruby-string">&quot;ies&quot;</span>, 
  <span class="ruby-identifier">so</span> <span class="ruby-identifier">a</span> <span class="ruby-constant">Category</span> <span class="ruby-keyword">class</span> <span class="ruby-identifier">becomes</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">categories</span> <span class="ruby-identifier">table</span>. 
* <span class="ruby-constant">Class</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">ends</span> <span class="ruby-keyword">in</span> <span class="ruby-string">&quot;fe&quot;</span><span class="ruby-operator">:</span> <span class="ruby-constant">The</span> <span class="ruby-string">&quot;fe&quot;</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">replaced</span> <span class="ruby-identifier">with</span> <span class="ruby-string">&quot;ves&quot;</span>, <span class="ruby-identifier">so</span> <span class="ruby-identifier">a</span> <span class="ruby-constant">Wife</span> <span class="ruby-keyword">class</span> <span class="ruby-identifier">becomes</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">wives</span> <span class="ruby-identifier">table</span>.
* <span class="ruby-constant">Class</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">ends</span> <span class="ruby-keyword">in</span> <span class="ruby-string">&quot;lf&quot;</span> <span class="ruby-keyword">or</span> <span class="ruby-string">&quot;rf&quot;</span><span class="ruby-operator">:</span> <span class="ruby-constant">The</span> <span class="ruby-string">&quot;f&quot;</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">replaced</span> <span class="ruby-identifier">with</span> <span class="ruby-string">&quot;ves&quot;</span>, <span class="ruby-identifier">so</span> <span class="ruby-identifier">a</span> <span class="ruby-constant">Half</span> <span class="ruby-keyword">class</span> <span class="ruby-identifier">becomes</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">halves</span> <span class="ruby-identifier">table</span>.
* <span class="ruby-constant">Class</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">ends</span> <span class="ruby-keyword">in</span> <span class="ruby-string">&quot;person&quot;</span><span class="ruby-operator">:</span> <span class="ruby-constant">The</span> <span class="ruby-string">&quot;person&quot;</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">replaced</span> <span class="ruby-identifier">with</span> <span class="ruby-string">&quot;people&quot;</span>, <span class="ruby-identifier">so</span> <span class="ruby-identifier">a</span> <span class="ruby-constant">Salesperson</span> <span class="ruby-keyword">class</span> <span class="ruby-identifier">becomes</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">salespeople</span> <span class="ruby-identifier">table</span>.
* <span class="ruby-constant">Class</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">ends</span> <span class="ruby-keyword">in</span> <span class="ruby-string">&quot;man&quot;</span><span class="ruby-operator">:</span> <span class="ruby-constant">The</span> <span class="ruby-string">&quot;man&quot;</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">replaced</span> <span class="ruby-identifier">with</span> <span class="ruby-string">&quot;men&quot;</span>, <span class="ruby-identifier">so</span> <span class="ruby-identifier">a</span> <span class="ruby-constant">Spokesman</span> <span class="ruby-keyword">class</span> <span class="ruby-identifier">becomes</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">spokesmen</span> <span class="ruby-identifier">table</span>.
* <span class="ruby-constant">Class</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">ends</span> <span class="ruby-keyword">in</span> <span class="ruby-string">&quot;sis&quot;</span><span class="ruby-operator">:</span> <span class="ruby-constant">The</span> <span class="ruby-string">&quot;i&quot;</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">replaced</span> <span class="ruby-identifier">with</span> <span class="ruby-identifier">an</span> <span class="ruby-string">&quot;e&quot;</span>, <span class="ruby-identifier">so</span> <span class="ruby-identifier">a</span> <span class="ruby-constant">Basis</span> <span class="ruby-keyword">class</span> <span class="ruby-identifier">becomes</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">bases</span> <span class="ruby-identifier">table</span>.
* <span class="ruby-constant">Class</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">ends</span> <span class="ruby-keyword">in</span> <span class="ruby-string">&quot;tum&quot;</span> <span class="ruby-keyword">or</span> <span class="ruby-string">&quot;ium&quot;</span><span class="ruby-operator">:</span> <span class="ruby-constant">The</span> <span class="ruby-string">&quot;um&quot;</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">replaced</span> <span class="ruby-identifier">with</span> <span class="ruby-identifier">an</span> <span class="ruby-string">&quot;a&quot;</span>, <span class="ruby-identifier">so</span> <span class="ruby-identifier">a</span> <span class="ruby-constant">Datum</span> <span class="ruby-keyword">class</span> <span class="ruby-identifier">becomes</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">data</span> <span class="ruby-identifier">table</span>.
* <span class="ruby-constant">Class</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">ends</span> <span class="ruby-keyword">in</span> <span class="ruby-string">&quot;child&quot;</span><span class="ruby-operator">:</span> <span class="ruby-constant">The</span> <span class="ruby-string">&quot;child&quot;</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">replaced</span> <span class="ruby-identifier">with</span> <span class="ruby-string">&quot;children&quot;</span>, <span class="ruby-identifier">so</span> <span class="ruby-identifier">a</span> <span class="ruby-constant">NodeChild</span> <span class="ruby-keyword">class</span> <span class="ruby-identifier">becomes</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">node_children</span> <span class="ruby-identifier">table</span>.
* <span class="ruby-constant">Class</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">ends</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">an</span> <span class="ruby-string">&quot;s&quot;</span><span class="ruby-operator">:</span> <span class="ruby-constant">No</span> <span class="ruby-identifier">additional</span> <span class="ruby-identifier">characters</span> <span class="ruby-identifier">are</span> <span class="ruby-identifier">added</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">removed</span>.
* <span class="ruby-constant">Class</span> <span class="ruby-identifier">name</span> <span class="ruby-identifier">doesn</span><span class="ruby-string">'t end in &quot;s&quot;: An &quot;s&quot; is appended, so a Comment class becomes a comments table.
* Class name with word compositions: Compositions are underscored, so CreditCard class becomes a credit_cards table.
Additionally, the class-level table_name_prefix is prepended to the table_name and the table_name_suffix is appended.
So if you have &quot;myapp_&quot; as a prefix, the table name guess for an Account class becomes &quot;myapp_accounts&quot;.

You can also overwrite this class method to allow for unguessable links, such as a Mouse class with a link to a
&quot;mice&quot; table. Example:

  class Mouse &lt; ActiveRecord::Base
     def self.table_name() &quot;mice&quot; end
  end
</span></pre>

<p>This conversion is now done through an external class called <a
href="../../../classes/Inflector.html">Inflector</a> residing in
lib/active_record/support/inflector.rb.</p>
</li><li>
<p>Added find_all_in_collection to has_many defined collections. Works like
this:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Firm</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">clients</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span> <span class="ruby-comment"># =&gt; 1</span>
<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">find_all_in_clients</span> <span class="ruby-string">&quot;revenue &gt; 1000&quot;</span> <span class="ruby-comment"># SELECT * FROM clients WHERE firm_id = 1 AND revenue &gt; 1000</span>
</pre>
<dl class="rdoc-list label-list"><dt>Requested by Dave Thomas
<dd></dd></dl>
</li><li>
<p>Fixed finders for inheritance hierarchies deeper than one level [Florian
Weber]</p>
</li><li>
<p>Added add_on_boundry_breaking to errors to accompany add_on_empty as a
default validation method. It’s used like this:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">protected</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier">validation</span>
      <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add_on_boundry_breaking</span> <span class="ruby-string">&quot;password&quot;</span>, <span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">20</span>
    <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>This will add an error to the tune of “is too short (minimum is 3
characters)” or “is too long (minimum is 20 characters)” if the password is
outside the boundry. The messages can be changed by passing a third and
forth parameter as message strings.</p>
</li><li>
<p>Implemented a clone method that works properly with AR. It returns a clone
of the record that  hasn’t been assigned an id yet and is treated as a new
record.</p>
</li><li>
<p>Allow for domain sockets in PostgreSQL by not assuming localhost when no
host is specified [Scott Barron]</p>
</li><li>
<p>Fixed that bignums are saved properly instead of attempted to be YAMLized
[Andreas Schwartz]</p>
</li><li>
<p>Fixed a bug in the GEM where the rdoc options weren’t being passed
according to spec [Chad Fowler]</p>
</li><li>
<p>Fixed a bug with the exclusively_dependent option for has_many</p>
</li></ul>

<p><strong>0.9.4</strong></p>
<ul><li>
<p>Correctly guesses the primary key when the class is inside a module [Dave
Steinberg].</p>
</li><li>
<p>Added [] and []= as alternatives to read_attribute and write_attribute
[Dave Steinberg]</p>
</li><li>
<p>has_and_belongs_to_many now accepts an :order key to determine in which
order the collection is returned [radsaq].</p>
</li><li>
<p>The ids passed to find and find_on_conditions are now automatically
sanitized.</p>
</li><li>
<p>Added escaping of plings in YAML content.</p>
</li><li>
<p>Multi-parameter assigns where all the parameters are empty will now be set
to nil instead of a new instance of their class.</p>
</li><li>
<p>Proper type within an inheritance hierarchy is now ensured already at
object initialization (instead of first at create)</p>
</li></ul>

<p><strong>0.9.3</strong></p>
<ul><li>
<p>Fixed bug with using a different primary key name together with
has_and_belongs_to_many [Investigation by Scott]</p>
</li><li>
<p>Added :exclusively_dependent option to the has_many association macro. The
doc reads:</p>

<pre class="ruby"><span class="ruby-constant">If</span> <span class="ruby-identifier">set</span> <span class="ruby-identifier">to</span> <span class="ruby-keyword">true</span> <span class="ruby-identifier">all</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">associated</span> <span class="ruby-identifier">object</span> <span class="ruby-identifier">are</span> <span class="ruby-identifier">deleted</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">one</span> <span class="ruby-constant">SQL</span> <span class="ruby-identifier">statement</span> <span class="ruby-identifier">without</span> <span class="ruby-identifier">having</span> <span class="ruby-identifier">their</span>
<span class="ruby-identifier">before_destroy</span> <span class="ruby-identifier">callback</span> <span class="ruby-identifier">run</span>. <span class="ruby-constant">This</span> <span class="ruby-identifier">should</span> <span class="ruby-identifier">only</span> <span class="ruby-identifier">be</span> <span class="ruby-identifier">used</span> <span class="ruby-identifier">on</span> <span class="ruby-identifier">associations</span> <span class="ruby-identifier">that</span> <span class="ruby-identifier">depend</span> <span class="ruby-identifier">solely</span> <span class="ruby-identifier">on</span> 
<span class="ruby-identifier">this</span> <span class="ruby-keyword">class</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">don</span><span class="ruby-string">'t need to do any clean-up in before_destroy. The upside is that it'</span><span class="ruby-identifier">s</span> <span class="ruby-identifier">much</span>
<span class="ruby-identifier">faster</span>, <span class="ruby-identifier">especially</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">there</span><span class="ruby-string">'s a counter_cache involved.
</span></pre>
</li><li>
<p>Added :port key to connection options, so the PostgreSQL and MySQL adapters
can connect to a database server running on another port than the default.</p>
</li><li>
<p>Converted the new natural singleton methods that prevented AR objects from
being saved by PStore (and hence be placed in a <a
href="../../../classes/Rails.html">Rails</a> session) to a module. [Florian
Weber]</p>
</li><li>
<p>Fixed the use of floats (was broken since 0.9.0+)</p>
</li><li>
<p>Fixed PostgreSQL adapter so default values are displayed properly when used
in conjunction with  Action Pack scaffolding.</p>
</li><li>
<p>Fixed booleans support for PostgreSQL (use real true/false on boolean
fields instead of 0/1 on tinyints) [radsaq]</p>
</li></ul>

<p><strong>0.9.2</strong></p>
<ul><li>
<p>Added static method for instantly updating a record</p>
</li><li>
<p>Treat decimal and numeric as Ruby floats [Andreas Schwartz]</p>
</li><li>
<p>Treat chars as Ruby strings (fixes problem for Action Pack form helpers
too)</p>
</li><li>
<p>Removed debugging output accidently left in (which would screw web
applications)</p>
</li></ul>

<p><strong>0.9.1</strong></p>
<ul><li>
<p>Added MIT license</p>
</li><li>
<p>Added natural object-style assignment for has_and_belongs_to_many
associations. Consider the following model:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Event</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_one_and_belongs_to_many</span> :<span class="ruby-identifier">sponsors</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">Sponsor</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_one_and_belongs_to_many</span> :<span class="ruby-identifier">sponsors</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Earlier, you’d have to use synthetic methods for creating associations
between two objects of the above class:</p>

<pre>roskilde_festival.add_to_sponsors(carlsberg)
roskilde_festival.remove_from_sponsors(carlsberg)

nike.add_to_events(world_cup)
nike.remove_from_events(world_cup)</pre>

<p>Now you can use regular array-styled methods:</p>

<pre>roskilde_festival.sponsors &lt;&lt; carlsberg
roskilde_festival.sponsors.delete(carlsberg)

nike.events &lt;&lt; world_cup
nike.events.delete(world_cup)</pre>
</li><li>
<p>Added delete method for has_many associations. Using this will nullify an
association between the has_many and the belonging object by setting the
foreign key to null. Consider this model:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Post</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">comments</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">Comment</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">post</span>
<span class="ruby-keyword">end</span>
</pre>

<p>You could do something like:</p>

<pre class="ruby"><span class="ruby-identifier">funny_comment</span>.<span class="ruby-identifier">has_post?</span> <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-identifier">announcement</span>.<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">funny_comment</span>)
<span class="ruby-identifier">funny_comment</span>.<span class="ruby-identifier">has_post?</span> <span class="ruby-comment"># =&gt; false</span>
</pre>
</li></ul>

<p><strong>0.9.0</strong></p>
<ul><li>
<p>Active Record is now thread safe! (So you can use it with Cerise and
WEBrick applications)</p>
<dl class="rdoc-list label-list"><dt>Implementation idea by Michael Neumann, debugging assistance by Jamis Buck
<dd></dd></dl>
</li><li>
<p>Improved performance by roughly 400% on a basic test case of pulling 100
records and querying one attribute.  This brings the tax for using Active
Record instead of “riding on the metal” (using MySQL-ruby C-driver
directly) down to ~50%. Done by doing lazy type conversions and caching
column information on the class-level.</p>
</li><li>
<p>Added callback objects and procs as options for implementing the target for
callback macros.</p>
</li><li>
<p>Added “counter_cache” option to belongs_to that automates the usage of
increment_counter and decrement_counter. Consider:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Post</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">comments</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">Comment</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">post</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Iterating over 100 posts like this:</p>

<pre>&lt;% for post in @posts %&gt;
  &lt;%= post.title %&gt; has &lt;%= post.comments_count %&gt; comments
&lt;% end %&gt;</pre>

<p>Will generate 100 SQL count queries – one for each call to
post.comments_count. If you instead add a “comments_count” int column to
the posts table and rewrite the comments association macro with:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Comment</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">post</span>, :<span class="ruby-identifier">counter_cache</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Those 100 SQL count queries will be reduced to zero. Beware that counter
caching is only appropriate for objects that begin life with the object
it’s specified to belong with and is destroyed like that as well. Typically
objects where you would also specify :dependent =&gt; true. If your objects
switch from one belonging to another (like a post that can be move from one
category to another), you’ll have to manage the counter yourself.</p>
</li><li>
<p>Added natural object-style assignment for has_one and belongs_to
associations. Consider the following model:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Project</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_one</span> :<span class="ruby-identifier">manager</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">Manager</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">project</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Earlier, assignments would work like following regardless of which way the
assignment told the best story:</p>

<pre>active_record.manager_id = david.id</pre>

<p>Now you can do it either from the belonging side:</p>

<pre>david.project = active_record</pre>

<p>…or from the having side:</p>

<pre>active_record.manager = david</pre>

<p>If the assignment happens from the having side, the assigned object is
automatically saved. So in the example above, the  project_id attribute on
david would be set to the id of active_record, then david would be saved.</p>
</li><li>
<p>Added natural object-style assignment for has_many associations [Florian
Weber]. Consider the following model:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Project</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">milestones</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">Milestone</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">project</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Earlier, assignments would work like following regardless of which way the
assignment told the best story:</p>

<pre>deadline.project_id = active_record.id</pre>

<p>Now you can do it either from the belonging side:</p>

<pre>deadline.project = active_record</pre>

<p>…or from the having side:</p>

<pre>active_record.milestones &lt;&lt; deadline</pre>

<p>The milestone is automatically saved with the new foreign key.</p>
</li><li>
<p>API CHANGE: Attributes for text (or blob or similar) columns will now have
unknown classes stored using YAML instead of using to_s. (Known classes
that won’t be yamelized are: <a
href="../../../classes/String.html">String</a>, <a
href="../../../classes/NilClass.html">NilClass</a>, <a
href="../../../classes/TrueClass.html">TrueClass</a>, <a
href="../../../classes/FalseClass.html">FalseClass</a>, Fixnum, Date, and
<a href="../../../classes/Time.html">Time</a>). Likewise, data pulled out
of text-based attributes will be attempted converged using Yaml if they
have the “— ” header. This was primarily done to be enable the storage of
hashes and arrays without wrapping them in aggregations, so now you can do:</p>

<pre class="ruby"><span class="ruby-identifier">user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
<span class="ruby-identifier">user</span>.<span class="ruby-identifier">preferences</span> = { <span class="ruby-string">&quot;background&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;black&quot;</span>, <span class="ruby-string">&quot;display&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">large</span> }
<span class="ruby-identifier">user</span>.<span class="ruby-identifier">save</span>

<span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">preferences</span> <span class="ruby-comment"># =&gt; { &quot;background&quot; =&gt; &quot;black&quot;, &quot;display&quot; =&gt; large }</span>
</pre>

<p>Please note that this method should only be used when you don’t care about
representing the object in proper columns in the database. <a
href="../../../classes/A.html">A</a> money object consisting of an amount
and a currency is still a much better fit for a value object done through
aggregations than this new option.</p>
</li><li>
<p>POSSIBLE CODE BREAKAGE: As a consequence of the lazy type conversions, it’s
a bad idea to reference the @attributes hash directly (it always was, but
now it’s paramount that you don’t). If you do, you won’t get the type
conversion. So to implement new accessors for existing attributes, use
read_attribute(attr_name) and write_attribute(attr_name, value) instead.
Like this:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Song</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-comment"># Uses an integer of seconds to hold the length of the song</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">length=</span>(<span class="ruby-identifier">minutes</span>)
    <span class="ruby-identifier">write_attribute</span>(<span class="ruby-string">&quot;length&quot;</span>, <span class="ruby-identifier">minutes</span> * <span class="ruby-value">60</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">length</span>
    <span class="ruby-identifier">read_attribute</span>(<span class="ruby-string">&quot;length&quot;</span>) <span class="ruby-operator">/</span> <span class="ruby-value">60</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The clever kid will notice that this opens a door to sidestep the automated
type conversion by using @attributes directly. This is not recommended as
read/write_attribute may be granted additional responsibilities in the
future, but if you think you know what you’re doing and aren’t afraid of
future consequences, this is an option.</p>
</li><li>
<p>Applied a few minor bug fixes reported by Daniel Von Fange.</p>
</li></ul>

<p><strong>0.8.4</strong></p>

<p><em>Reflection</em></p>
<ul><li>
<p>Added <a
href="../../../classes/ActiveRecord/Reflection.html">ActiveRecord::Reflection</a>
with a bunch of methods and classes for reflecting in aggregations and
associations.</p>
</li><li>
<p>Added Base.columns and Base.content_columns which returns arrays of column
description (type, default, etc) objects.</p>
</li><li>
<p>Added Base#attribute_names which returns an array of names for the
attributes available on the object.</p>
</li><li>
<p>Added Base#column_for_attribute(name) which returns the column description
object for the named attribute.</p>
</li></ul>

<p><em>Misc</em></p>
<ul><li>
<p>Added multi-parameter assignment:</p>

<pre># Instantiate objects for all attribute classes that needs more than one constructor parameter. This is done
# by calling new on the column type or aggregation type (through composed_of) object with these parameters.
# So having the pairs written_on(1) = &quot;2004&quot;, written_on(2) = &quot;6&quot;, written_on(3) = &quot;24&quot;, will instantiate
# written_on (a date type) with Date.new(&quot;2004&quot;, &quot;6&quot;, &quot;24&quot;). You can also specify a typecast character in the
# parenteses to have the parameters typecasted before they're used in the constructor. Use i for Fixnum, f for Float,
# s for String, and a for Array.</pre>

<p>This is incredibly useful for assigning dates from <a
href="../../../classes/HTML.html">HTML</a> drop-downs of month, year, and
day.</p>
</li><li>
<p>Fixed bug with custom primary key column name and Base.find on multiple
parameters.</p>
</li><li>
<p>Fixed bug with dependent option on has_one associations if there was no
associated object.</p>
</li></ul>

<p><strong>0.8.3</strong></p>

<p><em>Transactions</em></p>
<ul><li>
<p>Added transactional protection for destroy (important for the new
:dependent option) [Suggested by Carl Youngblood]</p>
</li><li>
<p>Fixed so transactions are ignored on MyISAM tables for MySQL (use InnoDB to
get transactions)</p>
</li><li>
<p>Changed transactions so only exceptions will cause a rollback, not returned
false.</p>
</li></ul>

<p><em>Mapping</em></p>
<ul><li>
<p>Added support for non-integer primary keys [Aredridel/earlier work by
Michael Neumann]</p>

<pre>User.find &quot;jdoe&quot;
Product.find &quot;PDKEY-INT-12&quot;</pre>
</li><li>
<p>Added option to specify naming method for primary key column.
ActiveRecord::Base.primary_key_prefix_type can either be set to nil,
:table_name, or :table_name_with_underscore. :table_name will assume that
Product class has a primary key of “productid” and
:table_name_with_underscore will assume “product_id”. The default nil will
just give “id”.</p>
</li><li>
<p>Added an overwriteable primary_key method that’ll instruct AR to the name
of the  id column [Aredridele/earlier work by Guan Yang]</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Project</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">primary_key</span>() <span class="ruby-string">&quot;project_id&quot;</span> <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Fixed that Active Records can safely associate inside and out of modules.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">MyApplication</span><span class="ruby-operator">::</span><span class="ruby-constant">Account</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">clients</span> <span class="ruby-comment"># will look for MyApplication::Client</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">interests</span>, :<span class="ruby-identifier">class_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Business::Interest&quot;</span> <span class="ruby-comment"># will look for Business::Interest</span>
<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Fixed that Active Records can safely live inside modules [Aredridel]</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">MyApplication</span><span class="ruby-operator">::</span><span class="ruby-constant">Account</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
<span class="ruby-keyword">end</span>
</pre>
</li></ul>

<p><em>Misc</em></p>
<ul><li>
<p>Added freeze call to value object assignments to ensure they remain
immutable [Spotted by Gavin Sinclair]</p>
</li><li>
<p>Changed interface for specifying observed class in observers. Was
OBSERVED_CLASS constant, now is  observed_class() class method. This is
more consistant with things like self.table_name(). Works like this:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">AuditObserver</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Observer</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">observed_class</span>() <span class="ruby-constant">Account</span> <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">after_update</span>(<span class="ruby-identifier">account</span>)
    <span class="ruby-constant">AuditTrail</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">account</span>, <span class="ruby-string">&quot;UPDATED&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>
<dl class="rdoc-list label-list"><dt>Suggested by Gavin Sinclair
<dd></dd></dl>
</li><li>
<p>Create new Active Record objects by setting the attributes through a block.
Like this:</p>

<pre class="ruby"><span class="ruby-identifier">person</span> = <span class="ruby-constant">Person</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">p</span>.<span class="ruby-identifier">name</span> = <span class="ruby-string">'Freddy'</span>
  <span class="ruby-identifier">p</span>.<span class="ruby-identifier">age</span>  = <span class="ruby-value">19</span>
<span class="ruby-keyword">end</span>
</pre>
<dl class="rdoc-list label-list"><dt>Suggested by Gavin Sinclair
<dd></dd></dl>
</li></ul>

<p><strong>0.8.2</strong></p>
<ul><li>
<p>Added inheritable callback queues that can ensure that certain callback
methods or inline fragments are run throughout the entire inheritance
hierarchy. Regardless of whether a descendent overwrites the callback
method:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Topic</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">before_destroy</span> :<span class="ruby-identifier">destroy_author</span>, <span class="ruby-string">'puts &quot;I'</span><span class="ruby-identifier">m</span> <span class="ruby-identifier">an</span> <span class="ruby-identifier">inline</span> <span class="ruby-identifier">fragment</span><span class="ruby-string">&quot;'
end
</span></pre>

<p>Learn more in <a
href="../../../classes/ActiveRecord/Callbacks.html">classes/ActiveRecord/Callbacks.html</a></p>
</li><li>
<p>Added :dependent option to has_many and has_one, which will automatically
destroy associated objects when  the holder is destroyed:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Album</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">tracks</span>, :<span class="ruby-identifier">dependent</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span>
</pre>

<p>All the associated tracks are destroyed when the album is.</p>
</li><li>
<p>Added Base.create as a factory that’ll create, save, and return a new
object in one step.</p>
</li><li>
<p>Automatically convert strings in config hashes to symbols for the
_connection methods. This allows you to pass the argument hashes directly
from yaml. (Luke)</p>
</li><li>
<p>Fixed the install.rb to include simple.rb [Spotted by Kevin Bullock]</p>
</li><li>
<p>Modified block syntax to better follow our code standards outlined in  <a
href="http://www.rubyonrails.org/CodingStandards">www.rubyonrails.org/CodingStandards</a></p>
</li></ul>

<p><strong>0.8.1</strong></p>
<ul><li>
<p>Added object-level transactions [Thanks to Austin Ziegler for
Transaction::Simple]</p>
</li><li>
<p>Changed adapter-specific connection methods to use centralized <a
href="../../../classes/ActiveRecord/Base.html#method-c-establish_connection">ActiveRecord::Base.establish_connection</a>,
which is parametized through a config hash with symbol keys instead of a
regular parameter list. This will allow for database connections to be
opened in a more generic fashion. (Luke)</p>

<p>NOTE: This requires all *_connections to be updated! Read more in: <a
href="http://ar.rubyonrails.org/classes/ActiveRecord/Base.html#M000081">ar.rubyonrails.org/classes/ActiveRecord/Base.html#M000081</a></p>
</li><li>
<p>Fixed SQLite adapter so objects fetched from has_and_belongs_to_many have
proper attributes (t.name is now name). [Spotted by Garrett Rooney]</p>
</li><li>
<p>Fixed SQLite adapter so dates are returned as Date objects, not <a
href="../../../classes/Time.html">Time</a> objects [Spotted by Gavin
Sinclair]</p>
</li><li>
<p>Fixed requirement of date class, so date conversions are succesful
regardless of whether you  manually require date or not.</p>
</li></ul>

<p><strong>0.8.0</strong></p>
<ul><li>
<p>Added transactions</p>
</li><li>
<p>Changed Base.find to also accept either a list (1, 5, 6) or an array of ids
([5, 7])  as parameter and then return an array of objects instead of just
an object</p>
</li><li>
<p>Fixed method has_collection? for has_and_belongs_to_many macro to behave as
a  collection, not an association</p>
</li><li>
<p>Fixed SQLite adapter so empty or nil values in columns of datetime, date,
or time type aren’t treated as current time [Spotted by Gavin Sinclair]</p>
</li></ul>

<p><strong>0.7.6</strong></p>
<ul><li>
<p>Fixed the install.rb to create the lib/active_record/support directory
[Spotted by Gavin Sinclair]</p>
</li><li>
<p>Fixed that has_association? would always return true [Spotted by Daniel Von
Fange]</p>
</li></ul>

    </div>
  


  


  
  


  


  

  



  

    

    

    


    


    <!-- Methods -->
              </div>
    </div>
  </body>
</html>