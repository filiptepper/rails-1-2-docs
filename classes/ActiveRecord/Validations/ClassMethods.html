<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>ActiveRecord::Validations::ClassMethods</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/github.css" type="text/css" media="screen" />
<script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Module</span> 
            ActiveRecord::Validations::ClassMethods 
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/rails/activerecord/lib/active_record/validations_rb.html">rails/activerecord/lib/active_record/validations.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>All of the following validations are defined in the class scope of the
model that you’re interested in validating. They offer a more declarative
way of specifying when the model is valid and when it is not. It is
recommended to use these over the low-level calls to validate and <a
href="ClassMethods.html#method-i-validate_on_create">#validate_on_create</a>
when possible.</p>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>C</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-condition_block-3F">condition_block?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-create-21">create!</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>E</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-evaluate_condition">evaluate_condition</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>V</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-validate">validate</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validate_on_create">validate_on_create</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validate_on_update">validate_on_update</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validates_acceptance_of">validates_acceptance_of</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validates_associated">validates_associated</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validates_confirmation_of">validates_confirmation_of</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validates_each">validates_each</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validates_exclusion_of">validates_exclusion_of</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validates_format_of">validates_format_of</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validates_inclusion_of">validates_inclusion_of</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validates_length_of">validates_length_of</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validates_numericality_of">validates_numericality_of</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validates_presence_of">validates_presence_of</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validates_size_of">validates_size_of</a>,
              </li>
            
              
              <li>
                <a href="#method-i-validates_uniqueness_of">validates_uniqueness_of</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    
      <!-- Section constants -->
      <div class="sectiontitle">Constants</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">DEFAULT_VALIDATION_OPTIONS</td>
            <td>=</td>
            <td class="attr-value">{
:on =&gt; :save,
:allow_nil =&gt; false,
:message =&gt; nil
}.freeze</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">ALL_RANGE_OPTIONS</td>
            <td>=</td>
            <td class="attr-value">[ :is, :within, :in, :minimum, :maximum ].freeze</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
      </table>
    


    


    <!-- Methods -->
        
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-condition_block-3F">
            
              <a name="method-i-condition_block-3F"></a><b>condition_block?</b>(condition)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-condition_block-3F_source')" id="l_method-i-condition_block-3F_source">show</a>
                
              </p>
              <div id="method-i-condition_block-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 254</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">condition_block?</span>(<span class="ruby-identifier">condition</span>)
  <span class="ruby-identifier">condition</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-string">&quot;call&quot;</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">condition</span>.<span class="ruby-identifier">arity</span> <span class="ruby-operator">==</span> <span class="ruby-number">1</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">condition</span>.<span class="ruby-identifier">arity</span> <span class="ruby-operator">==</span> <span class="ruby-number">-1</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-create-21">
            
              <a name="method-i-create-21"></a><b>create!</b>(attributes = nil)
            
          </div>
          
          
            <div class="description">
              <p>Creates an object just like <a
href="../Base.html#method-c-create">ActiveRecord::Base.create</a> but calls
save! instead of save so an exception is raised if the record is invalid.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-create-21_source')" id="l_method-i-create-21_source">show</a>
                
              </p>
              <div id="method-i-create-21_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 719</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">create!</span>(<span class="ruby-identifier">attributes</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
    <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span><span class="ruby-operator">|</span> <span class="ruby-identifier">create!</span>(<span class="ruby-identifier">attr</span>) }
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">attributes</span> <span class="ruby-operator">||=</span> {}
    <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">reverse_merge!</span>(<span class="ruby-identifier">scope</span>(<span class="ruby-value">:create</span>)) <span class="ruby-keyword">if</span> <span class="ruby-identifier">scoped?</span>(<span class="ruby-value">:create</span>)

    <span class="ruby-identifier">object</span> = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">attributes</span>)
    <span class="ruby-identifier">object</span>.<span class="ruby-identifier">save!</span>
    <span class="ruby-identifier">object</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-evaluate_condition">
            
              <a name="method-i-evaluate_condition"></a><b>evaluate_condition</b>(condition, record)
            
          </div>
          
          
            <div class="description">
              <p>Determine from the given condition (whether a block, procedure, method or
string) whether or not to validate the record.  See <a
href="ClassMethods.html#method-i-validates_each">validates_each</a>.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-evaluate_condition_source')" id="l_method-i-evaluate_condition_source">show</a>
                
              </p>
              <div id="method-i-evaluate_condition_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 260</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">evaluate_condition</span>(<span class="ruby-identifier">condition</span>, <span class="ruby-identifier">record</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">condition</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span><span class="ruby-operator">:</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">condition</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span><span class="ruby-operator">:</span> <span class="ruby-identifier">eval</span>(<span class="ruby-identifier">condition</span>, <span class="ruby-identifier">binding</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">condition_block?</span>(<span class="ruby-identifier">condition</span>)
        <span class="ruby-identifier">condition</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">record</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">raise</span>(
          <span class="ruby-constant">ActiveRecordError</span>,
          <span class="ruby-string">&quot;Validations need to be either a symbol, string (to be eval'ed), proc/method, or &quot;</span> <span class="ruby-operator">+</span>
          <span class="ruby-string">&quot;class implementing a static validation method&quot;</span>
        )
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validate">
            
              <a name="method-i-validate"></a><b>validate</b>(*methods, &amp;block)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validate_source')" id="l_method-i-validate_source">show</a>
                
              </p>
              <div id="method-i-validate_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 239</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validate</span>(*<span class="ruby-identifier">methods</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">methods</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">block</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">write_inheritable_set</span>(<span class="ruby-value">:validate</span>, <span class="ruby-identifier">methods</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validate_on_create">
            
              <a name="method-i-validate_on_create"></a><b>validate_on_create</b>(*methods, &amp;block)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validate_on_create_source')" id="l_method-i-validate_on_create_source">show</a>
                
              </p>
              <div id="method-i-validate_on_create_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 244</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validate_on_create</span>(*<span class="ruby-identifier">methods</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">methods</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">block</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">write_inheritable_set</span>(<span class="ruby-value">:validate_on_create</span>, <span class="ruby-identifier">methods</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validate_on_update">
            
              <a name="method-i-validate_on_update"></a><b>validate_on_update</b>(*methods, &amp;block)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validate_on_update_source')" id="l_method-i-validate_on_update_source">show</a>
                
              </p>
              <div id="method-i-validate_on_update_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 249</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validate_on_update</span>(*<span class="ruby-identifier">methods</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">methods</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">block</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">write_inheritable_set</span>(<span class="ruby-value">:validate_on_update</span>, <span class="ruby-identifier">methods</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validates_acceptance_of">
            
              <a name="method-i-validates_acceptance_of"></a><b>validates_acceptance_of</b>(*attr_names)
            
          </div>
          
          
            <div class="description">
              <p>Encapsulates the pattern of wanting to validate the acceptance of a terms
of service check box (or similar agreement). Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_acceptance_of</span> :<span class="ruby-identifier">terms_of_service</span>
  <span class="ruby-identifier">validates_acceptance_of</span> :<span class="ruby-identifier">eula</span>, :<span class="ruby-identifier">message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;must be abided&quot;</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The terms_of_service attribute is entirely virtual. No database column is
needed. This check is performed only if terms_of_service is not nil and by
default on save.</p>

<p>Configuration options:</p>
<ul><li>
<p><code>message</code> - <a href="../../A.html">A</a> custom error message
(default is: "must be accepted")</p>
</li><li>
<p><code>on</code> - Specifies when this validation is active (default is
:save, other options :create, :update)</p>
</li><li>
<p><code>accept</code> - Specifies value that is considered accepted.  The
default value is a string "1", which</p>
</li></ul>

<p>makes it easy to relate to an <a href="../../HTML.html">HTML</a> checkbox.</p>
<ul><li>
<p><code>if</code> - Specifies a method, proc or string to call to determine
if the validation should</p>
</li></ul>

<p>occur (e.g. :if =&gt; :allow_validation, or :if =&gt; Proc.new { |user|
user.signup_step &gt; 2 }).  The method, proc or string should return or
evaluate to a true or false value.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validates_acceptance_of_source')" id="l_method-i-validates_acceptance_of_source">show</a>
                
              </p>
              <div id="method-i-validates_acceptance_of_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 359</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validates_acceptance_of</span>(*<span class="ruby-identifier">attr_names</span>)
  <span class="ruby-identifier">configuration</span> = { <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span>[<span class="ruby-value">:accepted</span>], <span class="ruby-value">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:save</span>, <span class="ruby-value">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>, <span class="ruby-value">:accept</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;1&quot;</span> }
  <span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">pop</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)

  <span class="ruby-identifier">attr_accessor</span> *<span class="ruby-identifier">attr_names</span>

  <span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">attr_names</span>,<span class="ruby-identifier">configuration</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:message</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:accept</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validates_associated">
            
              <a name="method-i-validates_associated"></a><b>validates_associated</b>(*attr_names)
            
          </div>
          
          
            <div class="description">
              <p>Validates whether the associated object or objects are all valid
themselves. Works with any kind of association.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Book</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">pages</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">library</span>

  <span class="ruby-identifier">validates_associated</span> :<span class="ruby-identifier">pages</span>, :<span class="ruby-identifier">library</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Warning: If, after the above definition, you then wrote:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Page</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">book</span>

  <span class="ruby-identifier">validates_associated</span> :<span class="ruby-identifier">book</span>
<span class="ruby-keyword">end</span>
</pre>

<p>…this would specify a circular dependency and cause infinite recursion.</p>

<p>NOTE: This validation will not fail if the association hasn’t been
assigned. If you want to ensure that the association is both present and
guaranteed to be valid, you also need to use validates_presence_of.</p>

<p>Configuration options:</p>
<ul><li>
<p><code>on</code> Specifies when this validation is active (default is :save,
other options :create, :update)</p>
</li><li>
<p><code>if</code> - Specifies a method, proc or string to call to determine
if the validation should</p>
</li></ul>

<p>occur (e.g. :if =&gt; :allow_validation, or :if =&gt; Proc.new { |user|
user.signup_step &gt; 2 }).  The method, proc or string should return or
evaluate to a true or false value.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validates_associated_source')" id="l_method-i-validates_associated_source">show</a>
                
              </p>
              <div id="method-i-validates_associated_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 669</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validates_associated</span>(*<span class="ruby-identifier">attr_names</span>)
  <span class="ruby-identifier">configuration</span> = { <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span>[<span class="ruby-value">:invalid</span>], <span class="ruby-value">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:save</span> }
  <span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">pop</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)

  <span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">attr_names</span>, <span class="ruby-identifier">configuration</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:message</span>]) <span class="ruby-keyword">unless</span>
      (<span class="ruby-identifier">value</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">:</span> [<span class="ruby-identifier">value</span>]).<span class="ruby-identifier">all?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validates_confirmation_of">
            
              <a name="method-i-validates_confirmation_of"></a><b>validates_confirmation_of</b>(*attr_names)
            
          </div>
          
          
            <div class="description">
              <p>Encapsulates the pattern of wanting to validate a password or email address
field with a confirmation. Example:</p>

<pre>Model:
  class Person &lt; ActiveRecord::Base
    validates_confirmation_of :user_name, :password
    validates_confirmation_of :email_address, :message =&gt; &quot;should match confirmation&quot;
  end

View:
  &lt;%= password_field &quot;person&quot;, &quot;password&quot; %&gt;
  &lt;%= password_field &quot;person&quot;, &quot;password_confirmation&quot; %&gt;</pre>

<p>The person has to already have a password attribute (a column in the people
table), but the password_confirmation is virtual. It exists only as an
in-memory variable for validating the password. This check is performed
only if password_confirmation is not nil and by default on save.</p>

<p>Configuration options:</p>
<ul><li>
<p><code>message</code> - <a href="../../A.html">A</a> custom error message
(default is: "doesn't match confirmation")</p>
</li><li>
<p><code>on</code> - Specifies when this validation is active (default is
:save, other options :create, :update)</p>
</li><li>
<p><code>if</code> - Specifies a method, proc or string to call to determine
if the validation should</p>
</li></ul>

<p>occur (e.g. :if =&gt; :allow_validation, or :if =&gt; Proc.new { |user|
user.signup_step &gt; 2 }).  The method, proc or string should return or
evaluate to a true or false value.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validates_confirmation_of_source')" id="l_method-i-validates_confirmation_of_source">show</a>
                
              </p>
              <div id="method-i-validates_confirmation_of_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 330</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validates_confirmation_of</span>(*<span class="ruby-identifier">attr_names</span>)
  <span class="ruby-identifier">configuration</span> = { <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span>[<span class="ruby-value">:confirmation</span>], <span class="ruby-value">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:save</span> }
  <span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">pop</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)

  <span class="ruby-identifier">attr_accessor</span> *(<span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;#{n}_confirmation&quot;</span> })

  <span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">attr_names</span>, <span class="ruby-identifier">configuration</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:message</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{attr_name}_confirmation&quot;</span>).<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{attr_name}_confirmation&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validates_each">
            
              <a name="method-i-validates_each"></a><b>validates_each</b>(*attrs)
            
          </div>
          
          
            <div class="description">
              <p>Validates each attribute against a block.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_each</span> :<span class="ruby-identifier">first_name</span>, :<span class="ruby-identifier">last_name</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span> <span class="ruby-identifier">attr</span>, <span class="ruby-string">'starts with z.'</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">zz</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Options:</p>
<ul><li>
<p><code>on</code> - Specifies when this validation is active (default is
:save, other options :create, :update)</p>
</li><li>
<p><code>allow_nil</code> - Skip validation if attribute is nil.</p>
</li><li>
<p><code>if</code> - Specifies a method, proc or string to call to determine
if the validation should</p>
</li></ul>

<p>occur (e.g. :if =&gt; :allow_validation, or :if =&gt; Proc.new { |user|
user.signup_step &gt; 2 }).  The method, proc or string should return or
evaluate to a true or false value.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validates_each_source')" id="l_method-i-validates_each_source">show</a>
                
              </p>
              <div id="method-i-validates_each_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 291</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validates_each</span>(*<span class="ruby-identifier">attrs</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">attrs</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">attrs</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">symbolize_keys</span> <span class="ruby-operator">:</span> {}
  <span class="ruby-identifier">attrs</span>   = <span class="ruby-identifier">attrs</span>.<span class="ruby-identifier">flatten</span>

  <span class="ruby-comment"># Declare the validation.</span>
  <span class="ruby-identifier">send</span>(<span class="ruby-identifier">validation_method</span>(<span class="ruby-identifier">options</span>[<span class="ruby-value">:on</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:save</span>)) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span><span class="ruby-operator">|</span>
    <span class="ruby-comment"># Don't validate when there is an :if condition and that condition is false</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:if</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">evaluate_condition</span>(<span class="ruby-identifier">options</span>[<span class="ruby-value">:if</span>], <span class="ruby-identifier">record</span>)
      <span class="ruby-identifier">attrs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">value</span> = <span class="ruby-identifier">record</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">attr</span>)
        <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:allow_nil</span>]
        <span class="ruby-keyword">yield</span> <span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr</span>, <span class="ruby-identifier">value</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validates_exclusion_of">
            
              <a name="method-i-validates_exclusion_of"></a><b>validates_exclusion_of</b>(*attr_names)
            
          </div>
          
          
            <div class="description">
              <p>Validates that the value of the specified attribute is not in a particular
enumerable object.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_exclusion_of</span> :<span class="ruby-identifier">username</span>, :<span class="ruby-keyword">in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( admin superuser )</span>, :<span class="ruby-identifier">message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;You don't belong here&quot;</span>
  <span class="ruby-identifier">validates_exclusion_of</span> :<span class="ruby-identifier">age</span>, :<span class="ruby-keyword">in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">30</span><span class="ruby-operator">..</span><span class="ruby-value">60</span>, :<span class="ruby-identifier">message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;This site is only for under 30 and over 60&quot;</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Configuration options:</p>
<ul><li>
<p><code>in</code> - An enumerable object of items that the value shouldn't be
part of</p>
</li><li>
<p><code>message</code> - Specifies a customer error message (default is: "is
reserved")</p>
</li><li>
<p><code>allow_nil</code> - If set to true, skips this validation if the
attribute is null (default is: false)</p>
</li><li>
<p><code>if</code> - Specifies a method, proc or string to call to determine
if the validation should</p>
</li></ul>

<p>occur (e.g. :if =&gt; :allow_validation, or :if =&gt; Proc.new { |user|
user.signup_step &gt; 2 }).  The method, proc or string should return or
evaluate to a true or false value.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validates_exclusion_of_source')" id="l_method-i-validates_exclusion_of_source">show</a>
                
              </p>
              <div id="method-i-validates_exclusion_of_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 629</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validates_exclusion_of</span>(*<span class="ruby-identifier">attr_names</span>)
  <span class="ruby-identifier">configuration</span> = { <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span>[<span class="ruby-value">:exclusion</span>], <span class="ruby-value">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:save</span> }
  <span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">pop</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)

  <span class="ruby-identifier">enum</span> = <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:in</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:within</span>]

  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;An object with the method include? is required must be supplied as the :in option of the configuration hash&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">enum</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-string">&quot;include?&quot;</span>)

  <span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">attr_names</span>, <span class="ruby-identifier">configuration</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:message</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">enum</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validates_format_of">
            
              <a name="method-i-validates_format_of"></a><b>validates_format_of</b>(*attr_names)
            
          </div>
          
          
            <div class="description">
              <p>Validates whether the value of the specified attribute is of the correct
form by matching it against the regular expression provided.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_format_of</span> :<span class="ruby-identifier">email</span>, :<span class="ruby-identifier">with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp">%r\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\Z/</span>, :<span class="ruby-identifier">on</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">create</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Note: use A and Z to match the start and end of the string, ^ and $ match
the start/end of a line.</p>

<p><a href="../../A.html">A</a> regular expression must be provided or else an
exception will be raised.</p>

<p>Configuration options:</p>
<ul><li>
<p><code>message</code> - <a href="../../A.html">A</a> custom error message
(default is: "is invalid")</p>
</li><li>
<p><code>with</code> - The regular expression used to validate the format with
(note: must be supplied!)</p>
</li><li>
<p><code>on</code> Specifies when this validation is active (default is :save,
other options :create, :update)</p>
</li><li>
<p><code>if</code> - Specifies a method, proc or string to call to determine
if the validation should</p>
</li></ul>

<p>occur (e.g. :if =&gt; :allow_validation, or :if =&gt; Proc.new { |user|
user.signup_step &gt; 2 }).  The method, proc or string should return or
evaluate to a true or false value.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validates_format_of_source')" id="l_method-i-validates_format_of_source">show</a>
                
              </p>
              <div id="method-i-validates_format_of_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 577</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validates_format_of</span>(*<span class="ruby-identifier">attr_names</span>)
  <span class="ruby-identifier">configuration</span> = { <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span>[<span class="ruby-value">:invalid</span>], <span class="ruby-value">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:save</span>, <span class="ruby-value">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span> }
  <span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">pop</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)

  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;A regular expression must be supplied as the :with option of the configuration hash&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:with</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Regexp</span>)

  <span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">attr_names</span>, <span class="ruby-identifier">configuration</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:message</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:with</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validates_inclusion_of">
            
              <a name="method-i-validates_inclusion_of"></a><b>validates_inclusion_of</b>(*attr_names)
            
          </div>
          
          
            <div class="description">
              <p>Validates whether the value of the specified attribute is available in a
particular enumerable object.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_inclusion_of</span> :<span class="ruby-identifier">gender</span>, :<span class="ruby-keyword">in</span>=<span class="ruby-operator">&gt;</span><span class="ruby-node">%w( m f )</span>, :<span class="ruby-identifier">message=</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&quot;woah! what are you then!??!!&quot;</span>
  <span class="ruby-identifier">validates_inclusion_of</span> :<span class="ruby-identifier">age</span>, :<span class="ruby-keyword">in</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">99</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Configuration options:</p>
<ul><li>
<p><code>in</code> - An enumerable object of available items</p>
</li><li>
<p><code>message</code> - Specifies a customer error message (default is: "is
not included in the list")</p>
</li><li>
<p><code>allow_nil</code> - If set to true, skips this validation if the
attribute is null (default is: false)</p>
</li><li>
<p><code>if</code> - Specifies a method, proc or string to call to determine
if the validation should</p>
</li></ul>

<p>occur (e.g. :if =&gt; :allow_validation, or :if =&gt; Proc.new { |user|
user.signup_step &gt; 2 }).  The method, proc or string should return or
evaluate to a true or false value.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validates_inclusion_of_source')" id="l_method-i-validates_inclusion_of_source">show</a>
                
              </p>
              <div id="method-i-validates_inclusion_of_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 602</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validates_inclusion_of</span>(*<span class="ruby-identifier">attr_names</span>)
  <span class="ruby-identifier">configuration</span> = { <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span>[<span class="ruby-value">:inclusion</span>], <span class="ruby-value">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:save</span> }
  <span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">pop</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)

  <span class="ruby-identifier">enum</span> = <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:in</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:within</span>]

  <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;An object with the method include? is required must be supplied as the :in option of the configuration hash&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">enum</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-string">&quot;include?&quot;</span>)

  <span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">attr_names</span>, <span class="ruby-identifier">configuration</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:message</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">enum</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validates_length_of">
            
              <a name="method-i-validates_length_of"></a><b>validates_length_of</b>(*attrs)
            
          </div>
          
          
            <div class="description">
              <p>Validates that the specified attribute matches the length restrictions
supplied. Only one option can be used at a time:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_length_of</span> :<span class="ruby-identifier">first_name</span>, :<span class="ruby-identifier">maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">30</span>
  <span class="ruby-identifier">validates_length_of</span> :<span class="ruby-identifier">last_name</span>, :<span class="ruby-identifier">maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">30</span>, :<span class="ruby-identifier">message=</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&quot;less than %d if you don't mind&quot;</span>
  <span class="ruby-identifier">validates_length_of</span> :<span class="ruby-identifier">fax</span>, :<span class="ruby-keyword">in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">7</span><span class="ruby-operator">..</span><span class="ruby-value">32</span>, :<span class="ruby-identifier">allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">validates_length_of</span> :<span class="ruby-identifier">user_name</span>, :<span class="ruby-identifier">within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">6</span><span class="ruby-operator">..</span><span class="ruby-value">20</span>, :<span class="ruby-identifier">too_long</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;pick a shorter name&quot;</span>, :<span class="ruby-identifier">too_short</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;pick a longer name&quot;</span>
  <span class="ruby-identifier">validates_length_of</span> :<span class="ruby-identifier">fav_bra_size</span>, :<span class="ruby-identifier">minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>, :<span class="ruby-identifier">too_short=</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&quot;please enter at least %d character&quot;</span>
  <span class="ruby-identifier">validates_length_of</span> :<span class="ruby-identifier">smurf_leader</span>, :<span class="ruby-identifier">is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">4</span>, :<span class="ruby-identifier">message=</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&quot;papa is spelled with %d characters... don't play me.&quot;</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Configuration options:</p>
<ul><li>
<p><code>minimum</code> - The minimum size of the attribute</p>
</li><li>
<p><code>maximum</code> - The maximum size of the attribute</p>
</li><li>
<p><code>is</code> - The exact size of the attribute</p>
</li><li>
<p><code>within</code> - <a href="../../A.html">A</a> range specifying the
minimum and maximum size of the attribute</p>
</li><li>
<p><code>in</code> - <a href="../../A.html">A</a> synonym(or alias) for
:within</p>
</li><li>
<p><code>allow_nil</code> - Attribute may be nil; skip validation.</p>
</li><li>
<p><code>too_long</code> - The error message if the attribute goes over the
maximum (default is: "is too long (maximum is %d characters)")</p>
</li><li>
<p><code>too_short</code> - The error message if the attribute goes under the
minimum (default is: "is too short (min is %d characters)")</p>
</li><li>
<p><code>wrong_length</code> - The error message if using the :is method and
the attribute is the wrong size (default is: "is the wrong length (should
be %d characters)")</p>
</li><li>
<p><code>message</code> - The error message to use for a :minimum, :maximum,
or :is violation.  An alias of the appropriate
too_long/too_short/wrong_length message</p>
</li><li>
<p><code>on</code> - Specifies when this validation is active (default is
:save, other options :create, :update)</p>
</li><li>
<p><code>if</code> - Specifies a method, proc or string to call to determine
if the validation should</p>
</li></ul>

<p>occur (e.g. :if =&gt; :allow_validation, or :if =&gt; Proc.new { |user|
user.signup_step &gt; 2 }).  The method, proc or string should return or
evaluate to a true or false value.</p>
            </div>
          
          
          
            <div class="aka">
              Also aliased as: <a href="ClassMethods.html#method-i-validates_size_of">validates_size_of</a>
            </div>
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validates_length_of_source')" id="l_method-i-validates_length_of_source">show</a>
                
              </p>
              <div id="method-i-validates_length_of_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 442</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validates_length_of</span>(*<span class="ruby-identifier">attrs</span>)
  <span class="ruby-comment"># Merge given options with defaults.</span>
  <span class="ruby-identifier">options</span> = {
    <span class="ruby-value">:too_long</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span>[<span class="ruby-value">:too_long</span>],
    <span class="ruby-value">:too_short</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span>[<span class="ruby-value">:too_short</span>],
    <span class="ruby-value">:wrong_length</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span>[<span class="ruby-value">:wrong_length</span>]
  }.<span class="ruby-identifier">merge</span>(<span class="ruby-constant">DEFAULT_VALIDATION_OPTIONS</span>)
  <span class="ruby-identifier">options</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">attrs</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">symbolize_keys</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">attrs</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)

  <span class="ruby-comment"># Ensure that one and only one range option is specified.</span>
  <span class="ruby-identifier">range_options</span> = <span class="ruby-constant">ALL_RANGE_OPTIONS</span> &amp; <span class="ruby-identifier">options</span>.<span class="ruby-identifier">keys</span>
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">range_options</span>.<span class="ruby-identifier">size</span>
    <span class="ruby-keyword">when</span> <span class="ruby-number">0</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">'Range unspecified.  Specify the :within, :maximum, :minimum, or :is option.'</span>
    <span class="ruby-keyword">when</span> <span class="ruby-number">1</span>
      <span class="ruby-comment"># Valid number of options; do nothing.</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">'Too many range options specified.  Choose only one.'</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Get range option and value.</span>
  <span class="ruby-identifier">option</span> = <span class="ruby-identifier">range_options</span>.<span class="ruby-identifier">first</span>
  <span class="ruby-identifier">option_value</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">range_options</span>.<span class="ruby-identifier">first</span>]

  <span class="ruby-keyword">case</span> <span class="ruby-identifier">option</span>
    <span class="ruby-keyword">when</span> <span class="ruby-value">:within</span>, <span class="ruby-value">:in</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;:#{option} must be a Range&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">option_value</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Range</span>)

      <span class="ruby-identifier">too_short</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:too_short</span>] <span class="ruby-operator">%</span> <span class="ruby-identifier">option_value</span>.<span class="ruby-identifier">begin</span>
      <span class="ruby-identifier">too_long</span>  = <span class="ruby-identifier">options</span>[<span class="ruby-value">:too_long</span>]  <span class="ruby-operator">%</span> <span class="ruby-identifier">option_value</span>.<span class="ruby-identifier">end</span>

      <span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">attrs</span>, <span class="ruby-identifier">options</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">%r/</span>).<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">option_value</span>.<span class="ruby-identifier">begin</span>
          <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-identifier">too_short</span>)
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">%r/</span>).<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">option_value</span>.<span class="ruby-identifier">end</span>
          <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-identifier">too_long</span>)
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">when</span> <span class="ruby-value">:is</span>, <span class="ruby-value">:minimum</span>, <span class="ruby-value">:maximum</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;:#{option} must be a nonnegative Integer&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">option_value</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>) <span class="ruby-keyword">and</span> <span class="ruby-identifier">option_value</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-number">0</span>

      <span class="ruby-comment"># Declare different validations per option.</span>
      <span class="ruby-identifier">validity_checks</span> = { <span class="ruby-value">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;==&quot;</span>, <span class="ruby-value">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;&gt;=&quot;</span>, <span class="ruby-value">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;&lt;=&quot;</span> }
      <span class="ruby-identifier">message_options</span> = { <span class="ruby-value">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:wrong_length</span>, <span class="ruby-value">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:too_short</span>, <span class="ruby-value">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:too_long</span> }

      <span class="ruby-identifier">message</span> = (<span class="ruby-identifier">options</span>[<span class="ruby-value">:message</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">message_options</span>[<span class="ruby-identifier">option</span>]]) <span class="ruby-operator">%</span> <span class="ruby-identifier">option_value</span>

      <span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">attrs</span>, <span class="ruby-identifier">options</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">String</span>)
          <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-identifier">message</span>) <span class="ruby-keyword">unless</span> <span class="ruby-operator">!</span><span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">%r/</span>).<span class="ruby-identifier">size</span>.<span class="ruby-identifier">method</span>(<span class="ruby-identifier">validity_checks</span>[<span class="ruby-identifier">option</span>])[<span class="ruby-identifier">option_value</span>]
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-identifier">message</span>) <span class="ruby-keyword">unless</span> <span class="ruby-operator">!</span><span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">size</span>.<span class="ruby-identifier">method</span>(<span class="ruby-identifier">validity_checks</span>[<span class="ruby-identifier">option</span>])[<span class="ruby-identifier">option_value</span>]
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validates_numericality_of">
            
              <a name="method-i-validates_numericality_of"></a><b>validates_numericality_of</b>(*attr_names)
            
          </div>
          
          
            <div class="description">
              <p>Validates whether the value of the specified attribute is numeric by trying
to convert it to a float with <a href="../../Kernel.html">Kernel</a>.Float
(if <code>integer</code> is false) or applying it to the regular expression
<code>/\A[+\-]?\d+\Z/</code> (if <code>integer</code> is set to true).</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_numericality_of</span> :<span class="ruby-identifier">value</span>, :<span class="ruby-identifier">on</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">create</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Configuration options:</p>
<ul><li>
<p><code>message</code> - <a href="../../A.html">A</a> custom error message
(default is: "is not a number")</p>
</li><li>
<p><code>on</code> Specifies when this validation is active (default is :save,
other options :create, :update)</p>
</li><li>
<p><code>only_integer</code> Specifies whether the value has to be an integer,
e.g. an integral value (default is false)</p>
</li><li>
<p><code>allow_nil</code> Skip validation if attribute is nil (default is
false). Notice that for fixnum and float columns empty strings are
converted to nil</p>
</li><li>
<p><code>if</code> - Specifies a method, proc or string to call to determine
if the validation should</p>
</li></ul>

<p>occur (e.g. :if =&gt; :allow_validation, or :if =&gt; Proc.new { |user|
user.signup_step &gt; 2 }).  The method, proc or string should return or
evaluate to a true or false value.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validates_numericality_of_source')" id="l_method-i-validates_numericality_of_source">show</a>
                
              </p>
              <div id="method-i-validates_numericality_of_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 695</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validates_numericality_of</span>(*<span class="ruby-identifier">attr_names</span>)
  <span class="ruby-identifier">configuration</span> = { <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span>[<span class="ruby-value">:not_a_number</span>], <span class="ruby-value">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:save</span>,
                     <span class="ruby-value">:only_integer</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>, <span class="ruby-value">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span> }
  <span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">pop</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:only_integer</span>]
    <span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">attr_names</span>,<span class="ruby-identifier">configuration</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr_name</span>,<span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:message</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{attr_name}_before_type_cast&quot;</span>).<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">%r\A[+-]?\d+\Z/</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">attr_names</span>,<span class="ruby-identifier">configuration</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr_name</span>,<span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
     <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:allow_nil</span>] <span class="ruby-keyword">and</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{attr_name}_before_type_cast&quot;</span>).<span class="ruby-identifier">nil?</span>
      <span class="ruby-keyword">begin</span>
        <span class="ruby-constant">Kernel</span>.<span class="ruby-constant">Float</span>(<span class="ruby-identifier">record</span>.<span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{attr_name}_before_type_cast&quot;</span>).<span class="ruby-identifier">to_s</span>)
      <span class="ruby-keyword">rescue</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-constant">TypeError</span>
        <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:message</span>])
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validates_presence_of">
            
              <a name="method-i-validates_presence_of"></a><b>validates_presence_of</b>(*attr_names)
            
          </div>
          
          
            <div class="description">
              <p>Validates that the specified attributes are not blank (as defined by <a
href="../../Object.html#method-i-blank-3F">Object#blank?</a>). Happens by
default on save. Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_presence_of</span> :<span class="ruby-identifier">first_name</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The first_name attribute must be in the object and it cannot be blank.</p>

<p>If you want to validate the presence of a boolean field (where the real
values are true and false), you will want to use <a
href="ClassMethods.html#method-i-validates_inclusion_of">#validates_inclusion_of</a>
:field_name, :in =&gt; [true, false] This is due to the way <a
href="../../Object.html#method-i-blank-3F">Object#blank?</a> handles
boolean values. false.blank? # =&gt; true</p>

<p>Configuration options:</p>
<ul><li>
<p><code>message</code> - <a href="../../A.html">A</a> custom error message
(default is: "can't be blank")</p>
</li><li>
<p><code>on</code> - Specifies when this validation is active (default is
:save, other options :create, :update)</p>
</li><li>
<p><code>if</code> - Specifies a method, proc or string to call to determine
if the validation should</p>
</li></ul>

<p>occur (e.g. :if =&gt; :allow_validation, or :if =&gt; Proc.new { |user|
user.signup_step &gt; 2 }).  The method, proc or string should return or
evaluate to a true or false value.</p>

<h3 id="method-i-validates_presence_of-label-Warning">Warning</h3>

<p>Validate the presence of the foreign key, not the instance variable itself.
Do this:</p>

<pre>validate_presence_of :invoice_id</pre>

<p>Not this:</p>

<pre>validate_presence_of :invoice</pre>

<p>If you validate the presence of the associated object, you will get
failures on saves when both the parent object and the child object are new.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validates_presence_of_source')" id="l_method-i-validates_presence_of_source">show</a>
                
              </p>
              <div id="method-i-validates_presence_of_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 400</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validates_presence_of</span>(*<span class="ruby-identifier">attr_names</span>)
  <span class="ruby-identifier">configuration</span> = { <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span>[<span class="ruby-value">:blank</span>], <span class="ruby-value">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:save</span> }
  <span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">pop</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)

  <span class="ruby-comment"># can't use validates_each here, because it cannot cope with nonexistent attributes,</span>
  <span class="ruby-comment"># while errors.add_on_empty can</span>
  <span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attr_name</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">send</span>(<span class="ruby-identifier">validation_method</span>(<span class="ruby-identifier">configuration</span>[<span class="ruby-value">:on</span>])) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:if</span>] <span class="ruby-keyword">and</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">evaluate_condition</span>(<span class="ruby-identifier">configuration</span>[<span class="ruby-value">:if</span>], <span class="ruby-identifier">record</span>)
        <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add_on_blank</span>(<span class="ruby-identifier">attr_name</span>,<span class="ruby-identifier">configuration</span>[<span class="ruby-value">:message</span>])
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validates_size_of">
            
              <a name="method-i-validates_size_of"></a><b>validates_size_of</b>(*attrs)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-validates_uniqueness_of">
            
              <a name="method-i-validates_uniqueness_of"></a><b>validates_uniqueness_of</b>(*attr_names)
            
          </div>
          
          
            <div class="description">
              <p>Validates whether the value of the specified attributes are unique across
the system. Useful for making sure that only one user can be named
“davidhh”.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_uniqueness_of</span> :<span class="ruby-identifier">user_name</span>, :<span class="ruby-identifier">scope</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">account_id</span>
<span class="ruby-keyword">end</span>
</pre>

<p>It can also validate whether the value of the specified attributes are
unique based on multiple scope parameters.  For example, making sure that a
teacher can only be on the schedule once per semester for a particular
class.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">TeacherSchedule</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates_uniqueness_of</span> :<span class="ruby-identifier">teacher_id</span>, :<span class="ruby-identifier">scope</span> =<span class="ruby-operator">&gt;</span> [:<span class="ruby-identifier">semester_id</span>, :<span class="ruby-identifier">class_id</span>] 
<span class="ruby-keyword">end</span>
</pre>

<p>When the record is created, a check is performed to make sure that no
record exists in the database with the given value for the specified
attribute (that maps to a column). When the record is updated, the same
check is made but disregarding the record itself.</p>

<p>Configuration options:</p>
<ul><li>
<p><code>message</code> - Specifies a custom error message (default is: "has
already been taken")</p>
</li><li>
<p><code>scope</code> - <a href="../../One.html">One</a> or more columns by
which to limit the scope of the uniquness constraint.</p>
</li><li>
<p><code>case_sensitive</code> - Looks for an exact match.  Ignored by
non-text columns (true by default).</p>
</li><li>
<p><code>allow_nil</code> - If set to true, skips this validation if the
attribute is null (default is: false)</p>
</li><li>
<p><code>if</code> - Specifies a method, proc or string to call to determine
if the validation should</p>
</li></ul>

<p>occur (e.g. :if =&gt; :allow_validation, or :if =&gt; Proc.new { |user|
user.signup_step &gt; 2 }).  The method, proc or string should return or
evaluate to a true or false value.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-validates_uniqueness_of_source')" id="l_method-i-validates_uniqueness_of_source">show</a>
                
              </p>
              <div id="method-i-validates_uniqueness_of_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/lib/active_record/validations.rb, line 528</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">validates_uniqueness_of</span>(*<span class="ruby-identifier">attr_names</span>)
  <span class="ruby-identifier">configuration</span> = { <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span>[<span class="ruby-value">:taken</span>], <span class="ruby-value">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span> }
  <span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">pop</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)

  <span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">attr_names</span>,<span class="ruby-identifier">configuration</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">configuration</span>[<span class="ruby-value">:case_sensitive</span>] <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">columns_hash</span>[<span class="ruby-identifier">attr_name</span>.<span class="ruby-identifier">to_s</span>].<span class="ruby-identifier">text?</span>)
      <span class="ruby-identifier">condition_sql</span> = <span class="ruby-node">&quot;#{record.class.table_name}.#{attr_name} #{attribute_condition(value)}&quot;</span>
      <span class="ruby-identifier">condition_params</span> = [<span class="ruby-identifier">value</span>]
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">condition_sql</span> = <span class="ruby-node">&quot;LOWER(#{record.class.table_name}.#{attr_name}) #{attribute_condition(value)}&quot;</span>
      <span class="ruby-identifier">condition_params</span> = [<span class="ruby-identifier">value</span>.<span class="ruby-identifier">downcase</span>]
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">scope</span> = <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:scope</span>]
      <span class="ruby-constant">Array</span>(<span class="ruby-identifier">scope</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">scope_item</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">scope_value</span> = <span class="ruby-identifier">record</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">scope_item</span>)
        <span class="ruby-identifier">condition_sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; AND #{record.class.table_name}.#{scope_item} #{attribute_condition(scope_value)}&quot;</span>
        <span class="ruby-identifier">condition_params</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">scope_value</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">new_record?</span>
      <span class="ruby-identifier">condition_sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; AND #{record.class.table_name}.#{record.class.primary_key} &lt;&gt; ?&quot;</span>
      <span class="ruby-identifier">condition_params</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:id</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:first</span>, <span class="ruby-value">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">condition_sql</span>, *<span class="ruby-identifier">condition_params</span>])
      <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attr_name</span>, <span class="ruby-identifier">configuration</span>[<span class="ruby-value">:message</span>])
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>
    </div>
  </body>
</html>    